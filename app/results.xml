<assemblies timestamp="07/11/2023 13:05:38">
  <assembly name="D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\bin\Debug\net6.0\CHILI.GraFx.Platform.API.Integration.Tests.dll" run-date="2023-07-11" run-time="13:05:38" total="634" passed="0" failed="634" skipped="0" time="830.926" errors="0">
    <errors />
    <collection total="98" passed="0" failed="98" skipped="0" name="Test collection for CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment" time="204.096">
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentContractTests+ApiV1EnvironmentGetEndpoint+WhenReturnsStatusCodeUnauthorized.ProblemDetailsContentIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment" method="EnvironmentContractTests+ApiV1EnvironmentGetEndpoint+WhenReturnsStatusCodeUnauthorized.ProblemDetailsContentIsReturned" time="0.1396930" result="Fail">
        <failure>
          <message>System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentContractTests+ApiV1EnvironmentGetEndpoint+WhenReturnsStatusCodeForbidden.ProblemDetailsContentIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment" method="EnvironmentContractTests+ApiV1EnvironmentGetEndpoint+WhenReturnsStatusCodeForbidden.ProblemDetailsContentIsReturned" time="0.1384045" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentContractTests.ApiV1EnvironmentGetEndpoint.WhenReturnsStatusCodeForbidden.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Environment\Environment.Contract.Tests.cs:line 99
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentContractTests.ApiV1EnvironmentGetEndpoint.WhenReturnsStatusCodeForbidden.ProblemDetailsContentIsReturned() in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Environment\Environment.Contract.Tests.cs:line 74
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentContractTests+ApiV1EnvironmentGetEndpoint+WhenReturnsStatusCodeNotFound.ProblemDetailsContentIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment" method="EnvironmentContractTests+ApiV1EnvironmentGetEndpoint+WhenReturnsStatusCodeNotFound.ProblemDetailsContentIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNzAzOTQxNjA3LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMHxTQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.2283134" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected HttpStatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected HttpStatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.HttpResponseMessageAssertions`1.HaveStatusCode(HttpStatusCode expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentContractTests.ApiV1EnvironmentGetEndpoint.WhenReturnsStatusCodeNotFound.ProblemDetailsContentIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Environment\Environment.Contract.Tests.cs:line 141
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When request is invalid. Returns 401Unauthorized" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment" method="EnvironmentContractTests+ApiV1EnvironmentRendersGetEndpoint+WhenReturnsStatusCodeUnauthorized.ProblemDetailsContentIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJkZWI3NTEyYy01ZTQ3LTRiNWQtYjA0Yi00ZWExODRmOWM2YzQiLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MjA4LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbXSwiaHR0cHM6Ly9jaGlsaS1wdWJsaXNoLmNvbS9zdWJzY3JpcHRpb25zIjpbXSwiaHR0cHM6Ly9jaGlsaS1wdWJsaXNoLmNvbS9jdXN0b21lcl9ndWlkIjoiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIiwic3ViIjoiMSIsImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vZW52aXJvbm1lbnRJZCI6IiIsInNjb3BlIjoiIn0.)" time="0.2035559" result="Fail">
        <failure>
          <message>System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When request is invalid. Returns 401Unauthorized" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment" method="EnvironmentContractTests+ApiV1EnvironmentRendersGetEndpoint+WhenReturnsStatusCodeUnauthorized.ProblemDetailsContentIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjY1NzUyODA4LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbXSwiaHR0cHM6Ly9jaGlsaS1wdWJsaXNoLmNvbS9zdWJzY3JpcHRpb25zIjpbXSwiaHR0cHM6Ly9jaGlsaS1wdWJsaXNoLmNvbS9jdXN0b21lcl9ndWlkIjoiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIiwic3ViIjoiMSIsImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vZW52aXJvbm1lbnRJZCI6IiIsInNjb3BlIjoiIn0.)" time="0.1980579" result="Fail">
        <failure>
          <message>System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When request is invalid. Returns 401Unauthorized" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment" method="EnvironmentContractTests+ApiV1EnvironmentRendersGetEndpoint+WhenReturnsStatusCodeUnauthorized.ProblemDetailsContentIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJiZDM4MTZkNC02OTljLTRkNTctOTU2OC1iZDcxMGRkMmQyYzEiLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MjA4LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbXSwiaHR0cHM6Ly9jaGlsaS1wdWJsaXNoLmNvbS9zdWJzY3JpcHRpb25zIjpbXSwiaHR0cHM6Ly9jaGlsaS1wdWJsaXNoLmNvbS9jdXN0b21lcl9ndWlkIjoiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIiwic3ViIjoiMSIsImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vZW52aXJvbm1lbnRJZCI6IiIsInNjb3BlIjoiIn0.)" time="0.2237237" result="Fail">
        <failure>
          <message>System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When user doesn't have permissions. Returns 403Forbid" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment" method="EnvironmentContractTests+ApiV1EnvironmentRendersGetEndpoint+WhenReturnsStatusCodeForbidden.ProblemDetailsContentIsReturned" time="0.1430713" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentContractTests.ApiV1EnvironmentRendersGetEndpoint.WhenReturnsStatusCodeForbidden.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Environment\Environment.Contract.Tests.cs:line 269
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentContractTests.ApiV1EnvironmentRendersGetEndpoint.WhenReturnsStatusCodeForbidden.ProblemDetailsContentIsReturned() in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Environment\Environment.Contract.Tests.cs:line 244
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When the entity isn't found. Returns 404NotFound" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment" method="EnvironmentContractTests+ApiV1EnvironmentRendersGetEndpoint+WhenReturnsStatusCodeNotFound.ProblemDetailsContentIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNzIzMDM2MDA4LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIkZBIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vc3Vic2NyaXB0aW9ucyI6W10sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.2236268" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected HttpStatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected HttpStatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.HttpResponseMessageAssertions`1.HaveStatusCode(HttpStatusCode expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentContractTests.ApiV1EnvironmentRendersGetEndpoint.WhenReturnsStatusCodeNotFound.ProblemDetailsContentIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Environment\Environment.Contract.Tests.cs:line 294
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When request is invalid. Returns 400BadRequest" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment" method="EnvironmentContractTests+ApiV1EnvironmentRendersGetEndpoint+WhenReturnsStatusCodeBadRequest.ProblemDetailsContentIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNzAwNjU4NDA5LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIkZBIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vc3Vic2NyaXB0aW9ucyI6W10sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.2279794" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected HttpStatusCode to be HttpStatusCode.BadRequest {value: 400}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected HttpStatusCode to be HttpStatusCode.BadRequest {value: 400}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.HttpResponseMessageAssertions`1.HaveStatusCode(HttpStatusCode expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentContractTests.ApiV1EnvironmentRendersGetEndpoint.WhenReturnsStatusCodeBadRequest.ProblemDetailsContentIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Environment\Environment.Contract.Tests.cs:line 323
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When request is invalid. Returns 401Unauthorized" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment" method="EnvironmentContractTests+ApiV1EnvironmentRendersGetByGuidEndpoint+WhenReturnsStatusCodeUnauthorized.ProblemDetailsContentIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiIzYzI2MGJiMS1iNGU2LTRjYTAtOTk4ZC0xZDgxODU4N2M0NzQiLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MjA5LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbXSwiaHR0cHM6Ly9jaGlsaS1wdWJsaXNoLmNvbS9zdWJzY3JpcHRpb25zIjpbXSwiaHR0cHM6Ly9jaGlsaS1wdWJsaXNoLmNvbS9jdXN0b21lcl9ndWlkIjoiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIiwic3ViIjoiMSIsImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vZW52aXJvbm1lbnRJZCI6IiIsInNjb3BlIjoiIn0.)" time="0.2031795" result="Fail">
        <failure>
          <message>System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When user doesn't have permissions. Returns 403Forbid" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment" method="EnvironmentContractTests+ApiV1EnvironmentRendersGetByGuidEndpoint+WhenReturnsStatusCodeForbidden.ProblemDetailsContentIsReturned" time="0.1451403" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentContractTests.ApiV1EnvironmentRendersGetByGuidEndpoint.WhenReturnsStatusCodeForbidden.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Environment\Environment.Contract.Tests.cs:line 432
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentContractTests.ApiV1EnvironmentRendersGetByGuidEndpoint.WhenReturnsStatusCodeForbidden.ProblemDetailsContentIsReturned() in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Environment\Environment.Contract.Tests.cs:line 414
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When the entity isn't found. Returns 404NotFound" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment" method="EnvironmentContractTests+ApiV1EnvironmentRendersGetByGuidEndpoint+WhenReturnsStatusCodeNotFound.ProblemDetailsContentIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNzEyNDk1MjA5LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIkZBIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vc3Vic2NyaXB0aW9ucyI6W10sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.2089057" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected HttpStatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected HttpStatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.HttpResponseMessageAssertions`1.HaveStatusCode(HttpStatusCode expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentContractTests.ApiV1EnvironmentRendersGetByGuidEndpoint.WhenReturnsStatusCodeNotFound.ProblemDetailsContentIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Environment\Environment.Contract.Tests.cs:line 457
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When request is invalid. Returns 400BadRequest" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment" method="EnvironmentContractTests+ApiV1EnvironmentRendersGetByGuidEndpoint+WhenReturnsStatusCodeBadRequest.ProblemDetailsContentIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjk1MzAxNjA5LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIkZBIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vc3Vic2NyaXB0aW9ucyI6W10sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.2077806" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentContractTests.ApiV1EnvironmentRendersGetByGuidEndpoint.WhenReturnsStatusCodeBadRequest.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Environment\Environment.Contract.Tests.cs:line 496
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentContractTests.ApiV1EnvironmentRendersGetByGuidEndpoint.WhenReturnsStatusCodeBadRequest.ProblemDetailsContentIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Environment\Environment.Contract.Tests.cs:line 473
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When request is invalid. Returns 400BadRequest" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment" method="EnvironmentContractTests+ApiV1EnvironmentSubscriptionEnvironmentsGetEndpoint+WhenReturnsStatusCodeBadRequest.ProblemDetailsContentIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNzEyMTQ5NjEwLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIkZBIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vc3Vic2NyaXB0aW9ucyI6W10sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.2198901" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected HttpStatusCode to be HttpStatusCode.BadRequest {value: 400}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected HttpStatusCode to be HttpStatusCode.BadRequest {value: 400}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.HttpResponseMessageAssertions`1.HaveStatusCode(HttpStatusCode expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentContractTests.ApiV1EnvironmentSubscriptionEnvironmentsGetEndpoint.WhenReturnsStatusCodeBadRequest.ProblemDetailsContentIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Environment\Environment.Contract.Tests.cs:line 534
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When request is invalid. Returns 401Unauthorized/403Forbid/404NotFound/400BadRequest" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment" method="EnvironmentContractTests+ApiV1EnvironmentSubscriptionEnvironmentsGetEndpoint+WhenReturnsStatusCodeUnauthorized.ProblemDetailsContentIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJlNjc3M2Q3OS1jZDJjLTQ1ZGYtYTFhOC1iNjE5NDk5MGY5MWYiLCJhenAiOiIiLCJleHAiOjE2ODkxNjcyMTAsImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vcm9sZXMiOltdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOltdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2N1c3RvbWVyX2d1aWQiOiIwMDAwMDAwMC0wMDAwLTAwMDAtMDAwMC0wMDAwMDAwMDAwMDAiLCJzdWIiOiIxIiwiaHR0cHM6Ly9jaGlsaS1wdWJsaXNoLmNvbS9lbnZpcm9ubWVudElkIjoiIiwic2NvcGUiOiIifQ.)" time="0.2414261" result="Fail">
        <failure>
          <message>System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When request is invalid. Returns 401Unauthorized/403Forbid/404NotFound/400BadRequest" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment" method="EnvironmentContractTests+ApiV1EnvironmentSubscriptionEnvironmentsGetEndpoint+WhenReturnsStatusCodeUnauthorized.ProblemDetailsContentIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjYwMjIzMjEwLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbXSwiaHR0cHM6Ly9jaGlsaS1wdWJsaXNoLmNvbS9zdWJzY3JpcHRpb25zIjpbXSwiaHR0cHM6Ly9jaGlsaS1wdWJsaXNoLmNvbS9jdXN0b21lcl9ndWlkIjoiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIiwic3ViIjoiMSIsImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vZW52aXJvbm1lbnRJZCI6IiIsInNjb3BlIjoiIn0.)" time="0.2298347" result="Fail">
        <failure>
          <message>System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When request is invalid. Returns 401Unauthorized/403Forbid/404NotFound/400BadRequest" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment" method="EnvironmentContractTests+ApiV1EnvironmentSubscriptionEnvironmentsGetEndpoint+WhenReturnsStatusCodeUnauthorized.ProblemDetailsContentIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiI2MzVmYWJmYi0zZmMyLTQzZmYtOTMwNi0yNmI4ZDUzNzUzMzQiLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MjEwLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbXSwiaHR0cHM6Ly9jaGlsaS1wdWJsaXNoLmNvbS9zdWJzY3JpcHRpb25zIjpbXSwiaHR0cHM6Ly9jaGlsaS1wdWJsaXNoLmNvbS9jdXN0b21lcl9ndWlkIjoiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIiwic3ViIjoiMSIsImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vZW52aXJvbm1lbnRJZCI6IiIsInNjb3BlIjoiIn0.)" time="0.2347582" result="Fail">
        <failure>
          <message>System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When the entity isn't found. Returns 404NotFound" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment" method="EnvironmentContractTests+ApiV1EnvironmentSubscriptionEnvironmentsGetEndpoint+WhenReturnsStatusCodeNotFound.ProblemDetailsContentIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNzAyMjEzNjEwLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIkZBIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vc3Vic2NyaXB0aW9ucyI6W10sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.1950197" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected HttpStatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected HttpStatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.HttpResponseMessageAssertions`1.HaveStatusCode(HttpStatusCode expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentContractTests.ApiV1EnvironmentSubscriptionEnvironmentsGetEndpoint.WhenReturnsStatusCodeNotFound.ProblemDetailsContentIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Environment\Environment.Contract.Tests.cs:line 613
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When request is invalid. Returns 401Unauthorized" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment" method="EnvironmentContractTests+ApiV1EnvironmentGetWithGuidEndpoint+WhenReturnsStatusCodeUnauthorized.ProblemDetailsContentIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJhZDM0NmIwOS03ZmRlLTRmNDAtYWMzOC04NDRmZmQwYzI0NGUiLCJhenAiOiIiLCJleHAiOjE2ODkxNjcyMTEsImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vcm9sZXMiOltdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOltdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2N1c3RvbWVyX2d1aWQiOiIwMDAwMDAwMC0wMDAwLTAwMDAtMDAwMC0wMDAwMDAwMDAwMDAiLCJzdWIiOiIxIiwiaHR0cHM6Ly9jaGlsaS1wdWJsaXNoLmNvbS9lbnZpcm9ubWVudElkIjoiIiwic2NvcGUiOiIifQ.)" time="0.1801120" result="Fail">
        <failure>
          <message>System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When request is invalid. Returns 401Unauthorized" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment" method="EnvironmentContractTests+ApiV1EnvironmentGetWithGuidEndpoint+WhenReturnsStatusCodeUnauthorized.ProblemDetailsContentIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjUxOTI4ODExLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbXSwiaHR0cHM6Ly9jaGlsaS1wdWJsaXNoLmNvbS9zdWJzY3JpcHRpb25zIjpbXSwiaHR0cHM6Ly9jaGlsaS1wdWJsaXNoLmNvbS9jdXN0b21lcl9ndWlkIjoiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIiwic3ViIjoiMSIsImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vZW52aXJvbm1lbnRJZCI6IiIsInNjb3BlIjoiIn0.)" time="0.1979192" result="Fail">
        <failure>
          <message>System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When request is invalid. Returns 401Unauthorized" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment" method="EnvironmentContractTests+ApiV1EnvironmentGetWithGuidEndpoint+WhenReturnsStatusCodeUnauthorized.ProblemDetailsContentIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiI5Y2RjYmQyMi1jMjMwLTRmM2YtODJiZC1iMjM1YzAwZDg5NzYiLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MjExLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbXSwiaHR0cHM6Ly9jaGlsaS1wdWJsaXNoLmNvbS9zdWJzY3JpcHRpb25zIjpbXSwiaHR0cHM6Ly9jaGlsaS1wdWJsaXNoLmNvbS9jdXN0b21lcl9ndWlkIjoiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIiwic3ViIjoiMSIsImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vZW52aXJvbm1lbnRJZCI6IiIsInNjb3BlIjoiIn0.)" time="0.2347016" result="Fail">
        <failure>
          <message>System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When the entity isn't found. Returns 404NotFound" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment" method="EnvironmentContractTests+ApiV1EnvironmentGetWithGuidEndpoint+WhenReturnsStatusCodeNotFound.ProblemDetailsContentIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNzE3Njc5MjExLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIkZBIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vc3Vic2NyaXB0aW9ucyI6W10sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.2180009" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected HttpStatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected HttpStatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.HttpResponseMessageAssertions`1.HaveStatusCode(HttpStatusCode expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentContractTests.ApiV1EnvironmentGetWithGuidEndpoint.WhenReturnsStatusCodeNotFound.ProblemDetailsContentIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Environment\Environment.Contract.Tests.cs:line 700
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When user doesn't have permissions. Returns 403Forbid" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment" method="EnvironmentContractTests+ApiV1EnvironmentGetWithGuidEndpoint+WhenReturnsStatusCodeForbidden.ProblemDetailsContentIsReturned" time="0.1438699" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentContractTests.ApiV1EnvironmentGetWithGuidEndpoint.WhenReturnsStatusCodeForbidden.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Environment\Environment.Contract.Tests.cs:line 740
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentContractTests.ApiV1EnvironmentGetWithGuidEndpoint.WhenReturnsStatusCodeForbidden.ProblemDetailsContentIsReturned() in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Environment\Environment.Contract.Tests.cs:line 715
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When token doesn't have required role. Returns 403Forbid." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment" method="EnvironmentIntegrationTests+WhenFetchingASingleEnvironmentUsingTheGuidOverload+WhenTokenDoesNotHavePermissions.TheForbidStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MjEyLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMXxTVSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAxIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.1457334" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentIntegrationTests.WhenFetchingASingleEnvironmentUsingTheGuidOverload.WhenTokenDoesNotHavePermissions.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Environment\Environment.Integration.Tests.cs:line 812
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentIntegrationTests.WhenFetchingASingleEnvironmentUsingTheGuidOverload.WhenTokenDoesNotHavePermissions.TheForbidStatusCodeIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Environment\Environment.Integration.Tests.cs:line 796
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When token doesn't have required role. Returns 403Forbid." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment" method="EnvironmentIntegrationTests+WhenFetchingASingleEnvironmentUsingTheGuidOverload+WhenTokenDoesNotHavePermissions.TheForbidStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MjEyLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMHxTQSIsIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMXxTVSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIiwiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAxIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.1390654" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentIntegrationTests.WhenFetchingASingleEnvironmentUsingTheGuidOverload.WhenTokenDoesNotHavePermissions.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Environment\Environment.Integration.Tests.cs:line 812
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentIntegrationTests.WhenFetchingASingleEnvironmentUsingTheGuidOverload.WhenTokenDoesNotHavePermissions.TheForbidStatusCodeIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Environment\Environment.Integration.Tests.cs:line 796
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When token doesn't have required role. Returns 403Forbid." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment" method="EnvironmentIntegrationTests+WhenFetchingASingleEnvironmentWithRenders+WhenTokenDoesNotHavePermissions.TheForbidStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MjEyLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbImE5ZmMxOGVlLTIzODQtNDE0OS04ZTUzLTQxZjIyMjcyNDlhZXxTVSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiYzRkNWNiN2UtODMxNi00NmZlLTliN2UtODg0YzllMGMzOWFkIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.1686176" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentIntegrationTests.WhenFetchingASingleEnvironmentWithRenders.WhenTokenDoesNotHavePermissions.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Environment\Environment.Integration.Tests.cs:line 1981
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentIntegrationTests.WhenFetchingASingleEnvironmentWithRenders.WhenTokenDoesNotHavePermissions.TheForbidStatusCodeIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Environment\Environment.Integration.Tests.cs:line 1965
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When token doesn't have required role. Returns 403Forbid." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment" method="EnvironmentIntegrationTests+WhenFetchingASingleEnvironmentWithRenders+WhenTokenDoesNotHavePermissions.TheForbidStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MjEyLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbImYwNjg3NWMxLTU5MGUtNGRhMy1hMjMyLWEwMjU2N2ZhNjM3OHxTQSIsImE5ZmMxOGVlLTIzODQtNDE0OS04ZTUzLTQxZjIyMjcyNDlhZXxDQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiZjA2ODc1YzEtNTkwZS00ZGEzLWEyMzItYTAyNTY3ZmE2Mzc4IiwiYzRkNWNiN2UtODMxNi00NmZlLTliN2UtODg0YzllMGMzOWFkIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.1381832" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentIntegrationTests.WhenFetchingASingleEnvironmentWithRenders.WhenTokenDoesNotHavePermissions.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Environment\Environment.Integration.Tests.cs:line 1981
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentIntegrationTests.WhenFetchingASingleEnvironmentWithRenders.WhenTokenDoesNotHavePermissions.TheForbidStatusCodeIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Environment\Environment.Integration.Tests.cs:line 1965
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When token doesn't have required role. Returns 403Forbid." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment" method="EnvironmentIntegrationTests+WhenFetchingASingleEnvironmentWithRendersByGuid+WhenTokenDoesNotHavePermissions.TheForbidStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MjEyLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbImQxNmYwZTQ5LWUwODktNGVhNS04YjI4LTYwZWE3ZDhhMjQ2N3xTVSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMjljMDU5YzktNmY1Mi00YTY2LWFjNzMtMmY1MGRjMGUyMTJkIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.1399349" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentIntegrationTests.WhenFetchingASingleEnvironmentWithRendersByGuid.WhenTokenDoesNotHavePermissions.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Environment\Environment.Integration.Tests.cs:line 2106
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentIntegrationTests.WhenFetchingASingleEnvironmentWithRendersByGuid.WhenTokenDoesNotHavePermissions.TheForbidStatusCodeIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Environment\Environment.Integration.Tests.cs:line 2090
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When token doesn't have required role. Returns 403Forbid." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment" method="EnvironmentIntegrationTests+WhenFetchingASingleEnvironmentWithRendersByGuid+WhenTokenDoesNotHavePermissions.TheForbidStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MjEyLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMHxURCIsImQxNmYwZTQ5LWUwODktNGVhNS04YjI4LTYwZWE3ZDhhMjQ2N3xTVSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIiwiMjljMDU5YzktNmY1Mi00YTY2LWFjNzMtMmY1MGRjMGUyMTJkIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.1390655" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentIntegrationTests.WhenFetchingASingleEnvironmentWithRendersByGuid.WhenTokenDoesNotHavePermissions.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Environment\Environment.Integration.Tests.cs:line 2106
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentIntegrationTests.WhenFetchingASingleEnvironmentWithRendersByGuid.WhenTokenDoesNotHavePermissions.TheForbidStatusCodeIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Environment\Environment.Integration.Tests.cs:line 2090
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When token doesn't have required role. Returns 403Forbid." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment" method="EnvironmentIntegrationTests+WhenFetchingASingleEnvironmentWithRendersByGuid+WhenTokenDoesNotHavePermissions.TheForbidStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MjEyLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbImQxNmYwZTQ5LWUwODktNGVhNS04YjI4LTYwZWE3ZDhhMjQ2N3xDQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMjljMDU5YzktNmY1Mi00YTY2LWFjNzMtMmY1MGRjMGUyMTJkIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.1402868" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentIntegrationTests.WhenFetchingASingleEnvironmentWithRendersByGuid.WhenTokenDoesNotHavePermissions.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Environment\Environment.Integration.Tests.cs:line 2106
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentIntegrationTests.WhenFetchingASingleEnvironmentWithRendersByGuid.WhenTokenDoesNotHavePermissions.TheForbidStatusCodeIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Environment\Environment.Integration.Tests.cs:line 2090
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When token doesn't have required role. Returns 403Forbid." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment" method="EnvironmentIntegrationTests+WhenFetchingSubscriptionEnvironments+WhenTokenDoesNotHavePermissions.TheForbidStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MjEzLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMHxTVSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.2047837" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected result.StatusCode to be HttpStatusCode.Forbidden {value: 403}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected result.StatusCode to be HttpStatusCode.Forbidden {value: 403}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.EnumAssertions`2.Be(TEnum expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentIntegrationTests.WhenFetchingSubscriptionEnvironments.WhenTokenDoesNotHavePermissions.TheForbidStatusCodeIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Environment\Environment.Integration.Tests.cs:line 2487
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When token doesn't have required role. Returns 403Forbid." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment" method="EnvironmentIntegrationTests+WhenFetchingSubscriptionEnvironments+WhenTokenDoesNotHavePermissions.TheForbidStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MjEzLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMHxURCJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.2199451" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected result.StatusCode to be HttpStatusCode.Forbidden {value: 403}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected result.StatusCode to be HttpStatusCode.Forbidden {value: 403}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.EnumAssertions`2.Be(TEnum expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentIntegrationTests.WhenFetchingSubscriptionEnvironments.WhenTokenDoesNotHavePermissions.TheForbidStatusCodeIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Environment\Environment.Integration.Tests.cs:line 2487
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentIntegrationTests+WhenFetchingASingleEnvironmentUsingTheIdOverload+WhenTheEnvironmentIsNotFound+WhenNoTokenIsProvided.AnHttpUnauthorizedStatusCodeIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment" method="EnvironmentIntegrationTests+WhenFetchingASingleEnvironmentUsingTheIdOverload+WhenTheEnvironmentIsNotFound+WhenNoTokenIsProvided.AnHttpUnauthorizedStatusCodeIsReturned" time="0.2295792" result="Fail">
        <failure>
          <message>System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentIntegrationTests+WhenFetchingASingleEnvironmentUsingTheIdOverload+WhenTheEnvironmentIsFound+WhenNoTokenIsProvided.AnHttpUnauthorizedStatusCodeIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment" method="EnvironmentIntegrationTests+WhenFetchingASingleEnvironmentUsingTheIdOverload+WhenTheEnvironmentIsFound+WhenNoTokenIsProvided.AnHttpUnauthorizedStatusCodeIsReturned" time="0.2189970" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentIntegrationTests.WhenFetchingASingleEnvironmentUsingTheIdOverload.WhenTheEnvironmentIsFound.WhenNoTokenIsProvided.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Environment\Environment.Integration.Tests.cs:line 318
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentIntegrationTests.WhenFetchingASingleEnvironmentUsingTheIdOverload.WhenTheEnvironmentIsFound.WhenNoTokenIsProvided.AnHttpUnauthorizedStatusCodeIsReturned() in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Environment\Environment.Integration.Tests.cs:line 304
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When environment is not found by SA, FA, EA, EU, CA. Returns 404NotFound." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment" method="EnvironmentIntegrationTests+WhenFetchingASingleEnvironmentUsingTheGuidOverload+WhenTheTokenHasPermissions+WhenTheEnvironmentIsNotFound.TheNotFoundStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MzYwLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIkZBIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vc3Vic2NyaXB0aW9ucyI6W10sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.2388183" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected result.StatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected result.StatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.EnumAssertions`2.Be(TEnum expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentIntegrationTests.WhenFetchingASingleEnvironmentUsingTheGuidOverload.WhenTheTokenHasPermissions.WhenTheEnvironmentIsNotFound.TheNotFoundStatusCodeIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Environment\Environment.Integration.Tests.cs:line 869
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When environment is not found by SA, FA, EA, EU, CA. Returns 404NotFound." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment" method="EnvironmentIntegrationTests+WhenFetchingASingleEnvironmentUsingTheGuidOverload+WhenTheTokenHasPermissions+WhenTheEnvironmentIsNotFound.TheNotFoundStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MzYwLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMHxTQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.2485852" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected result.StatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected result.StatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.EnumAssertions`2.Be(TEnum expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentIntegrationTests.WhenFetchingASingleEnvironmentUsingTheGuidOverload.WhenTheTokenHasPermissions.WhenTheEnvironmentIsNotFound.TheNotFoundStatusCodeIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Environment\Environment.Integration.Tests.cs:line 869
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When environment is not found by SA, FA, EA, EU, CA. Returns 404NotFound." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment" method="EnvironmentIntegrationTests+WhenFetchingASingleEnvironmentUsingTheGuidOverload+WhenTheTokenHasPermissions+WhenTheEnvironmentIsNotFound.TheNotFoundStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MzYwLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMXxFQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAxIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.2419200" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected result.StatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected result.StatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.EnumAssertions`2.Be(TEnum expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentIntegrationTests.WhenFetchingASingleEnvironmentUsingTheGuidOverload.WhenTheTokenHasPermissions.WhenTheEnvironmentIsNotFound.TheNotFoundStatusCodeIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Environment\Environment.Integration.Tests.cs:line 869
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When environment is not found by SA, FA, EA, EU, CA. Returns 404NotFound." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment" method="EnvironmentIntegrationTests+WhenFetchingASingleEnvironmentUsingTheGuidOverload+WhenTheTokenHasPermissions+WhenTheEnvironmentIsNotFound.TheNotFoundStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MzYwLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMXxFVSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAxIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.2366385" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected result.StatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected result.StatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.EnumAssertions`2.Be(TEnum expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentIntegrationTests.WhenFetchingASingleEnvironmentUsingTheGuidOverload.WhenTheTokenHasPermissions.WhenTheEnvironmentIsNotFound.TheNotFoundStatusCodeIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Environment\Environment.Integration.Tests.cs:line 869
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When environment is not found by SA, FA, EA, EU, CA. Returns 404NotFound." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment" method="EnvironmentIntegrationTests+WhenFetchingASingleEnvironmentUsingTheGuidOverload+WhenTheTokenHasPermissions+WhenTheEnvironmentIsNotFound.TheNotFoundStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MzYwLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMXxDQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAxIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.9292163" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected result.StatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected result.StatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.EnumAssertions`2.Be(TEnum expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentIntegrationTests.WhenFetchingASingleEnvironmentUsingTheGuidOverload.WhenTheTokenHasPermissions.WhenTheEnvironmentIsNotFound.TheNotFoundStatusCodeIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Environment\Environment.Integration.Tests.cs:line 869
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When a user has EA, EU, SA, FA or CA. Returns 200OK with subscription." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment" method="EnvironmentIntegrationTests+WhenFetchingASingleEnvironmentUsingTheGuidOverload+WhenTheTokenHasPermissions+WhenTheEnvironmentIsFound.TheEnvironmentIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MzYyLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIkZBIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vc3Vic2NyaXB0aW9ucyI6W10sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.1943339" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentIntegrationTests.WhenFetchingASingleEnvironmentUsingTheGuidOverload.WhenTheTokenHasPermissions.WhenTheEnvironmentIsFound.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Environment\Environment.Integration.Tests.cs:line 953
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentIntegrationTests.WhenFetchingASingleEnvironmentUsingTheGuidOverload.WhenTheTokenHasPermissions.WhenTheEnvironmentIsFound.TheEnvironmentIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Environment\Environment.Integration.Tests.cs:line 914
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When a user has EA, EU, SA, FA or CA. Returns 200OK with subscription." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment" method="EnvironmentIntegrationTests+WhenFetchingASingleEnvironmentUsingTheGuidOverload+WhenTheTokenHasPermissions+WhenTheEnvironmentIsFound.TheEnvironmentIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MzYyLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMXxTQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAxIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.2091142" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentIntegrationTests.WhenFetchingASingleEnvironmentUsingTheGuidOverload.WhenTheTokenHasPermissions.WhenTheEnvironmentIsFound.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Environment\Environment.Integration.Tests.cs:line 953
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentIntegrationTests.WhenFetchingASingleEnvironmentUsingTheGuidOverload.WhenTheTokenHasPermissions.WhenTheEnvironmentIsFound.TheEnvironmentIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Environment\Environment.Integration.Tests.cs:line 914
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When a user has EA, EU, SA, FA or CA. Returns 200OK with subscription." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment" method="EnvironmentIntegrationTests+WhenFetchingASingleEnvironmentUsingTheGuidOverload+WhenTheTokenHasPermissions+WhenTheEnvironmentIsFound.TheEnvironmentIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MzYyLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMXxFQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAxIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.2122750" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentIntegrationTests.WhenFetchingASingleEnvironmentUsingTheGuidOverload.WhenTheTokenHasPermissions.WhenTheEnvironmentIsFound.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Environment\Environment.Integration.Tests.cs:line 953
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentIntegrationTests.WhenFetchingASingleEnvironmentUsingTheGuidOverload.WhenTheTokenHasPermissions.WhenTheEnvironmentIsFound.TheEnvironmentIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Environment\Environment.Integration.Tests.cs:line 914
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When a user has EA, EU, SA, FA or CA. Returns 200OK with subscription." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment" method="EnvironmentIntegrationTests+WhenFetchingASingleEnvironmentUsingTheGuidOverload+WhenTheTokenHasPermissions+WhenTheEnvironmentIsFound.TheEnvironmentIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MzYyLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMXxFVSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAxIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.2196711" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentIntegrationTests.WhenFetchingASingleEnvironmentUsingTheGuidOverload.WhenTheTokenHasPermissions.WhenTheEnvironmentIsFound.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Environment\Environment.Integration.Tests.cs:line 953
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentIntegrationTests.WhenFetchingASingleEnvironmentUsingTheGuidOverload.WhenTheTokenHasPermissions.WhenTheEnvironmentIsFound.TheEnvironmentIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Environment\Environment.Integration.Tests.cs:line 914
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When a user has EA, EU, SA, FA or CA. Returns 200OK with subscription." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment" method="EnvironmentIntegrationTests+WhenFetchingASingleEnvironmentUsingTheGuidOverload+WhenTheTokenHasPermissions+WhenTheEnvironmentIsFound.TheEnvironmentIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MzYyLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMXxDQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAxIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.2527208" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentIntegrationTests.WhenFetchingASingleEnvironmentUsingTheGuidOverload.WhenTheTokenHasPermissions.WhenTheEnvironmentIsFound.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Environment\Environment.Integration.Tests.cs:line 953
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentIntegrationTests.WhenFetchingASingleEnvironmentUsingTheGuidOverload.WhenTheTokenHasPermissions.WhenTheEnvironmentIsFound.TheEnvironmentIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Environment\Environment.Integration.Tests.cs:line 914
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When one of params is not valid. Returns 400BadRequest." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment" method="EnvironmentIntegrationTests+WhenFetchingASingleEnvironmentWithRenders+WhenTheTokenHasPermissions+WhenRequestIsNotValid.TheBadRequestStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MzYzLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIkZBIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vc3Vic2NyaXB0aW9ucyI6W10sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., grouping: &quot;X&quot;, startDate: null, endDate: null)" time="0.3588494" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected result.StatusCode to be HttpStatusCode.BadRequest {value: 400}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected result.StatusCode to be HttpStatusCode.BadRequest {value: 400}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.EnumAssertions`2.Be(TEnum expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentIntegrationTests.WhenFetchingASingleEnvironmentWithRenders.WhenTheTokenHasPermissions.WhenRequestIsNotValid.TheBadRequestStatusCodeIsReturned(Jwt jwt, String grouping, String startDate, String endDate) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Environment\Environment.Integration.Tests.cs:line 1936
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When one of params is not valid. Returns 400BadRequest." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment" method="EnvironmentIntegrationTests+WhenFetchingASingleEnvironmentWithRenders+WhenTheTokenHasPermissions+WhenRequestIsNotValid.TheBadRequestStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MzYzLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMHxTQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., grouping: &quot;year&quot;, startDate: null, endDate: &quot;2022-01-01&quot;)" time="0.4099698" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected result.StatusCode to be HttpStatusCode.BadRequest {value: 400}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected result.StatusCode to be HttpStatusCode.BadRequest {value: 400}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.EnumAssertions`2.Be(TEnum expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentIntegrationTests.WhenFetchingASingleEnvironmentWithRenders.WhenTheTokenHasPermissions.WhenRequestIsNotValid.TheBadRequestStatusCodeIsReturned(Jwt jwt, String grouping, String startDate, String endDate) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Environment\Environment.Integration.Tests.cs:line 1936
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When one of params is not valid. Returns 400BadRequest." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment" method="EnvironmentIntegrationTests+WhenFetchingASingleEnvironmentWithRenders+WhenTheTokenHasPermissions+WhenRequestIsNotValid.TheBadRequestStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MzYzLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMHxFQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., grouping: &quot;month&quot;, startDate: &quot;2022-01-30&quot;, endDate: &quot;2022-01-01&quot;)" time="0.3262843" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected result.StatusCode to be HttpStatusCode.BadRequest {value: 400}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected result.StatusCode to be HttpStatusCode.BadRequest {value: 400}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.EnumAssertions`2.Be(TEnum expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentIntegrationTests.WhenFetchingASingleEnvironmentWithRenders.WhenTheTokenHasPermissions.WhenRequestIsNotValid.TheBadRequestStatusCodeIsReturned(Jwt jwt, String grouping, String startDate, String endDate) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Environment\Environment.Integration.Tests.cs:line 1936
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When one of params is not valid. Returns 400BadRequest." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment" method="EnvironmentIntegrationTests+WhenFetchingASingleEnvironmentWithRenders+WhenTheTokenHasPermissions+WhenRequestIsNotValid.TheBadRequestStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MzYzLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMHxFVSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., grouping: &quot;month&quot;, startDate: null, endDate: &quot;2022-01-01&quot;)" time="0.3163087" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected result.StatusCode to be HttpStatusCode.BadRequest {value: 400}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected result.StatusCode to be HttpStatusCode.BadRequest {value: 400}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.EnumAssertions`2.Be(TEnum expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentIntegrationTests.WhenFetchingASingleEnvironmentWithRenders.WhenTheTokenHasPermissions.WhenRequestIsNotValid.TheBadRequestStatusCodeIsReturned(Jwt jwt, String grouping, String startDate, String endDate) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Environment\Environment.Integration.Tests.cs:line 1936
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When one of params is not valid. Returns 400BadRequest." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment" method="EnvironmentIntegrationTests+WhenFetchingASingleEnvironmentWithRendersByGuid+WhenTheTokenHasPermissions+WhenRequestIsNotValid.TheBadRequestStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MzY0LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIkZBIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vc3Vic2NyaXB0aW9ucyI6W10sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., grouping: &quot;X&quot;, startDate: null, endDate: null)" time="0.3254230" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected result.StatusCode to be HttpStatusCode.BadRequest {value: 400}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected result.StatusCode to be HttpStatusCode.BadRequest {value: 400}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.EnumAssertions`2.Be(TEnum expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentIntegrationTests.WhenFetchingASingleEnvironmentWithRendersByGuid.WhenTheTokenHasPermissions.WhenRequestIsNotValid.TheBadRequestStatusCodeIsReturned(Jwt jwt, String grouping, String startDate, String endDate) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Environment\Environment.Integration.Tests.cs:line 2077
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When one of params is not valid. Returns 400BadRequest." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment" method="EnvironmentIntegrationTests+WhenFetchingASingleEnvironmentWithRendersByGuid+WhenTheTokenHasPermissions+WhenRequestIsNotValid.TheBadRequestStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MzY0LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMHxTQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., grouping: &quot;year&quot;, startDate: null, endDate: &quot;2022-01-01&quot;)" time="0.3053290" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected result.StatusCode to be HttpStatusCode.BadRequest {value: 400}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected result.StatusCode to be HttpStatusCode.BadRequest {value: 400}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.EnumAssertions`2.Be(TEnum expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentIntegrationTests.WhenFetchingASingleEnvironmentWithRendersByGuid.WhenTheTokenHasPermissions.WhenRequestIsNotValid.TheBadRequestStatusCodeIsReturned(Jwt jwt, String grouping, String startDate, String endDate) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Environment\Environment.Integration.Tests.cs:line 2077
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When one of params is not valid. Returns 400BadRequest." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment" method="EnvironmentIntegrationTests+WhenFetchingASingleEnvironmentWithRendersByGuid+WhenTheTokenHasPermissions+WhenRequestIsNotValid.TheBadRequestStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MzY0LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbImQxNmYwZTQ5LWUwODktNGVhNS04YjI4LTYwZWE3ZDhhMjQ2N3xFQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMjljMDU5YzktNmY1Mi00YTY2LWFjNzMtMmY1MGRjMGUyMTJkIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., grouping: &quot;month&quot;, startDate: &quot;2022-01-30&quot;, endDate: &quot;2022-01-01&quot;)" time="0.2831049" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected result.StatusCode to be HttpStatusCode.BadRequest {value: 400}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected result.StatusCode to be HttpStatusCode.BadRequest {value: 400}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.EnumAssertions`2.Be(TEnum expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentIntegrationTests.WhenFetchingASingleEnvironmentWithRendersByGuid.WhenTheTokenHasPermissions.WhenRequestIsNotValid.TheBadRequestStatusCodeIsReturned(Jwt jwt, String grouping, String startDate, String endDate) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Environment\Environment.Integration.Tests.cs:line 2077
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When one of params is not valid. Returns 400BadRequest." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment" method="EnvironmentIntegrationTests+WhenFetchingASingleEnvironmentWithRendersByGuid+WhenTheTokenHasPermissions+WhenRequestIsNotValid.TheBadRequestStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MzY0LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbImQxNmYwZTQ5LWUwODktNGVhNS04YjI4LTYwZWE3ZDhhMjQ2N3xFVSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMjljMDU5YzktNmY1Mi00YTY2LWFjNzMtMmY1MGRjMGUyMTJkIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., grouping: &quot;month&quot;, startDate: null, endDate: &quot;2022-01-01&quot;)" time="0.2333603" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected result.StatusCode to be HttpStatusCode.BadRequest {value: 400}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected result.StatusCode to be HttpStatusCode.BadRequest {value: 400}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.EnumAssertions`2.Be(TEnum expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentIntegrationTests.WhenFetchingASingleEnvironmentWithRendersByGuid.WhenTheTokenHasPermissions.WhenRequestIsNotValid.TheBadRequestStatusCodeIsReturned(Jwt jwt, String grouping, String startDate, String endDate) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Environment\Environment.Integration.Tests.cs:line 2077
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When subscription has incorrect format. Returns 400BadRequest." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment" method="EnvironmentIntegrationTests+WhenFetchingSubscriptionEnvironments+WhenTokenHasPermissions+WhenRequestIsNotValid.AnHttpBadRequestStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MzY1LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMHxTQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., id: &quot;xc31686f-8712-483f-92de-67c4212f6904&quot;)" time="0.2814448" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected result.StatusCode to be HttpStatusCode.BadRequest {value: 400}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected result.StatusCode to be HttpStatusCode.BadRequest {value: 400}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.EnumAssertions`2.Be(TEnum expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentIntegrationTests.WhenFetchingSubscriptionEnvironments.WhenTokenHasPermissions.WhenRequestIsNotValid.AnHttpBadRequestStatusCodeIsReturned(Jwt jwt, String id) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Environment\Environment.Integration.Tests.cs:line 2449
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When subscription has incorrect format. Returns 400BadRequest." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment" method="EnvironmentIntegrationTests+WhenFetchingSubscriptionEnvironments+WhenTokenHasPermissions+WhenRequestIsNotValid.AnHttpBadRequestStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MzY1LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMHxFQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., id: &quot;niceguid&quot;)" time="0.2918653" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected result.StatusCode to be HttpStatusCode.BadRequest {value: 400}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected result.StatusCode to be HttpStatusCode.BadRequest {value: 400}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.EnumAssertions`2.Be(TEnum expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentIntegrationTests.WhenFetchingSubscriptionEnvironments.WhenTokenHasPermissions.WhenRequestIsNotValid.AnHttpBadRequestStatusCodeIsReturned(Jwt jwt, String id) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Environment\Environment.Integration.Tests.cs:line 2449
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When subscription has incorrect format. Returns 400BadRequest." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment" method="EnvironmentIntegrationTests+WhenFetchingSubscriptionEnvironments+WhenTokenHasPermissions+WhenRequestIsNotValid.AnHttpBadRequestStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MzY1LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMHxDQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., id: &quot; &quot;)" time="0.2953939" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected result.StatusCode to be HttpStatusCode.BadRequest {value: 400}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected result.StatusCode to be HttpStatusCode.BadRequest {value: 400}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.EnumAssertions`2.Be(TEnum expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentIntegrationTests.WhenFetchingSubscriptionEnvironments.WhenTokenHasPermissions.WhenRequestIsNotValid.AnHttpBadRequestStatusCodeIsReturned(Jwt jwt, String id) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Environment\Environment.Integration.Tests.cs:line 2449
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentIntegrationTests+WhenFetchingASingleEnvironmentUsingTheIdOverload+WhenTheEnvironmentIsNotFound+WhenTheTokenIsInvalid+WhenTheTokenIsExpired.AnHttpUnauthorizedStatusCodeIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment" method="EnvironmentIntegrationTests+WhenFetchingASingleEnvironmentUsingTheIdOverload+WhenTheEnvironmentIsNotFound+WhenTheTokenIsInvalid+WhenTheTokenIsExpired.AnHttpUnauthorizedStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjYyMzgzMzg5LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbXSwiaHR0cHM6Ly9jaGlsaS1wdWJsaXNoLmNvbS9zdWJzY3JpcHRpb25zIjpbXSwiaHR0cHM6Ly9jaGlsaS1wdWJsaXNoLmNvbS9jdXN0b21lcl9ndWlkIjoiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIiwic3ViIjoiMSIsImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vZW52aXJvbm1lbnRJZCI6IiIsInNjb3BlIjoiIn0.)" time="1.3059350" result="Fail">
        <failure>
          <message>System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentIntegrationTests+WhenFetchingASingleEnvironmentUsingTheIdOverload+WhenTheEnvironmentIsNotFound+WhenTheTokenIsInvalid+WhenTheTokenHasAnUnsupportedIssuer.AnHttpUnauthorizedStatusCodeIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment" method="EnvironmentIntegrationTests+WhenFetchingASingleEnvironmentUsingTheIdOverload+WhenTheEnvironmentIsNotFound+WhenTheTokenIsInvalid+WhenTheTokenHasAnUnsupportedIssuer.AnHttpUnauthorizedStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJiZTI1Y2UzZC0zN2RjLTQ4NTAtOGVkMS1mMTc4MzYzNTU1OWEiLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MzkxLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbXSwiaHR0cHM6Ly9jaGlsaS1wdWJsaXNoLmNvbS9zdWJzY3JpcHRpb25zIjpbXSwiaHR0cHM6Ly9jaGlsaS1wdWJsaXNoLmNvbS9jdXN0b21lcl9ndWlkIjoiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIiwic3ViIjoiMSIsImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vZW52aXJvbm1lbnRJZCI6IiIsInNjb3BlIjoiIn0.)" time="0.3455125" result="Fail">
        <failure>
          <message>System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentIntegrationTests+WhenFetchingASingleEnvironmentUsingTheIdOverload+WhenTheEnvironmentIsNotFound+WhenTheTokenIsInvalid+WhenTheTokenHasAnUnsupportedAudience.AnHttpUnauthorizedStatusCodeIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment" method="EnvironmentIntegrationTests+WhenFetchingASingleEnvironmentUsingTheIdOverload+WhenTheEnvironmentIsNotFound+WhenTheTokenIsInvalid+WhenTheTokenHasAnUnsupportedAudience.AnHttpUnauthorizedStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiI3ZDUyZmVkZC1kN2JjLTRkYWYtYTBjMi1hNmQ2Y2VmNWI5NzUiLCJhenAiOiIiLCJleHAiOjE2ODkxNjczOTEsImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vcm9sZXMiOltdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOltdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2N1c3RvbWVyX2d1aWQiOiIwMDAwMDAwMC0wMDAwLTAwMDAtMDAwMC0wMDAwMDAwMDAwMDAiLCJzdWIiOiIxIiwiaHR0cHM6Ly9jaGlsaS1wdWJsaXNoLmNvbS9lbnZpcm9ubWVudElkIjoiIiwic2NvcGUiOiIifQ.)" time="0.3273865" result="Fail">
        <failure>
          <message>System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentIntegrationTests+WhenFetchingASingleEnvironmentUsingTheIdOverload+WhenTheEnvironmentIsNotFound+WhenTheTokenHasNoPermissions+WhenTheTokenIsLinkedToTheSupportUserRole.AnHttpForbiddenStatusCodeIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment" method="EnvironmentIntegrationTests+WhenFetchingASingleEnvironmentUsingTheIdOverload+WhenTheEnvironmentIsNotFound+WhenTheTokenHasNoPermissions+WhenTheTokenIsLinkedToTheSupportUserRole.AnHttpForbiddenStatusCodeIsReturned" time="0.2554853" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentIntegrationTests.WhenFetchingASingleEnvironmentUsingTheIdOverload.WhenTheEnvironmentIsNotFound.WhenTheTokenHasNoPermissions.WhenTheTokenIsLinkedToTheSupportUserRole.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Environment\Environment.Integration.Tests.cs:line 193
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentIntegrationTests.WhenFetchingASingleEnvironmentUsingTheIdOverload.WhenTheEnvironmentIsNotFound.WhenTheTokenHasNoPermissions.WhenTheTokenIsLinkedToTheSupportUserRole.AnHttpForbiddenStatusCodeIsReturned() in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Environment\Environment.Integration.Tests.cs:line 175
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentIntegrationTests+WhenFetchingASingleEnvironmentUsingTheIdOverload+WhenTheEnvironmentIsNotFound+WhenTheTokenHasPermissions+WhenTheTokenIsLinkedToTheFullAccessRole.AnHttpNotFoundStatusCodeIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment" method="EnvironmentIntegrationTests+WhenFetchingASingleEnvironmentUsingTheIdOverload+WhenTheEnvironmentIsNotFound+WhenTheTokenHasPermissions+WhenTheTokenIsLinkedToTheFullAccessRole.AnHttpNotFoundStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjk4OTMwNTkyLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIkZBIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vc3Vic2NyaXB0aW9ucyI6W10sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.3602102" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected result.StatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected result.StatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.EnumAssertions`2.Be(TEnum expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentIntegrationTests.WhenFetchingASingleEnvironmentUsingTheIdOverload.WhenTheEnvironmentIsNotFound.WhenTheTokenHasPermissions.WhenTheTokenIsLinkedToTheFullAccessRole.AnHttpNotFoundStatusCodeIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Environment\Environment.Integration.Tests.cs:line 218
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentIntegrationTests+WhenFetchingASingleEnvironmentUsingTheIdOverload+WhenTheEnvironmentIsNotFound+WhenTheTokenHasPermissions+WhenTheTokenIsLinkedToTheSubscriptionAdministratorRole.AnHttpNotFoundStatusCodeIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment" method="EnvironmentIntegrationTests+WhenFetchingASingleEnvironmentUsingTheIdOverload+WhenTheEnvironmentIsNotFound+WhenTheTokenHasPermissions+WhenTheTokenIsLinkedToTheSubscriptionAdministratorRole.AnHttpNotFoundStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjk3Mzc1MzkyLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMHxTQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.4067947" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected result.StatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected result.StatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.EnumAssertions`2.Be(TEnum expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentIntegrationTests.WhenFetchingASingleEnvironmentUsingTheIdOverload.WhenTheEnvironmentIsNotFound.WhenTheTokenHasPermissions.WhenTheTokenIsLinkedToTheSubscriptionAdministratorRole.AnHttpNotFoundStatusCodeIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Environment\Environment.Integration.Tests.cs:line 240
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentIntegrationTests+WhenFetchingASingleEnvironmentUsingTheIdOverload+WhenTheEnvironmentIsNotFound+WhenTheTokenHasPermissions+WhenTheTokenIsLinkedToTheEnvironmentAdministratorRole.AnHttpNotFoundStatusCodeIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment" method="EnvironmentIntegrationTests+WhenFetchingASingleEnvironmentUsingTheIdOverload+WhenTheEnvironmentIsNotFound+WhenTheTokenHasPermissions+WhenTheTokenIsLinkedToTheEnvironmentAdministratorRole.AnHttpNotFoundStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNzI5MjU2OTkyLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjI2ZDMyNWY0LWI5MGItNDFjMC1iNWI2LTYyYWQ1ZmRlZjc3OXxFQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiNTBlMjNlNjktNmE4MC00ZmE3LThmZTYtN2M5MTZkZDgxMmNiIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.4780645" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected result.StatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected result.StatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.EnumAssertions`2.Be(TEnum expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentIntegrationTests.WhenFetchingASingleEnvironmentUsingTheIdOverload.WhenTheEnvironmentIsNotFound.WhenTheTokenHasPermissions.WhenTheTokenIsLinkedToTheEnvironmentAdministratorRole.AnHttpNotFoundStatusCodeIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Environment\Environment.Integration.Tests.cs:line 262
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentIntegrationTests+WhenFetchingASingleEnvironmentUsingTheIdOverload+WhenTheEnvironmentIsNotFound+WhenTheTokenHasPermissions+WhenTheTokenIsLinkedToTheEnvironmentUserRole.AnHttpNotFoundStatusCodeIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment" method="EnvironmentIntegrationTests+WhenFetchingASingleEnvironmentUsingTheIdOverload+WhenTheEnvironmentIsNotFound+WhenTheTokenHasPermissions+WhenTheTokenIsLinkedToTheEnvironmentUserRole.AnHttpNotFoundStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjk1NjQ3MzkzLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbImQxMWFkODhiLTBkZTMtNGIyNy1iYmQ1LWQ3ZDE4NGQ0ZDU1ZHxFVSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiYzliYTc3MDYtOTVkMi00ODc2LThiMWQtYmRjMjFjODhmNDEzIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.4016599" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected result.StatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected result.StatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.EnumAssertions`2.Be(TEnum expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentIntegrationTests.WhenFetchingASingleEnvironmentUsingTheIdOverload.WhenTheEnvironmentIsNotFound.WhenTheTokenHasPermissions.WhenTheTokenIsLinkedToTheEnvironmentUserRole.AnHttpNotFoundStatusCodeIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Environment\Environment.Integration.Tests.cs:line 284
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentIntegrationTests+WhenFetchingASingleEnvironmentUsingTheIdOverload+WhenTheEnvironmentIsFound+WhenTheTokenIsInvalid+WhenTheTokenIsExpired.AnHttpUnauthorizedStatusCodeIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment" method="EnvironmentIntegrationTests+WhenFetchingASingleEnvironmentUsingTheIdOverload+WhenTheEnvironmentIsFound+WhenTheTokenIsInvalid+WhenTheTokenIsExpired.AnHttpUnauthorizedStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjc5ODM2MTkzLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbXSwiaHR0cHM6Ly9jaGlsaS1wdWJsaXNoLmNvbS9zdWJzY3JpcHRpb25zIjpbXSwiaHR0cHM6Ly9jaGlsaS1wdWJsaXNoLmNvbS9jdXN0b21lcl9ndWlkIjoiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIiwic3ViIjoiMSIsImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vZW52aXJvbm1lbnRJZCI6IiIsInNjb3BlIjoiIn0.)" time="0.3954897" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentIntegrationTests.WhenFetchingASingleEnvironmentUsingTheIdOverload.WhenTheEnvironmentIsFound.WhenTheTokenIsInvalid.WhenTheTokenIsExpired.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Environment\Environment.Integration.Tests.cs:line 348
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentIntegrationTests.WhenFetchingASingleEnvironmentUsingTheIdOverload.WhenTheEnvironmentIsFound.WhenTheTokenIsInvalid.WhenTheTokenIsExpired.AnHttpUnauthorizedStatusCodeIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Environment\Environment.Integration.Tests.cs:line 332
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentIntegrationTests+WhenFetchingASingleEnvironmentUsingTheIdOverload+WhenTheEnvironmentIsFound+WhenTheTokenIsInvalid+WhenTheTokenHasAnUnsupportedIssuer.AnHttpUnauthorizedStatusCodeIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment" method="EnvironmentIntegrationTests+WhenFetchingASingleEnvironmentUsingTheIdOverload+WhenTheEnvironmentIsFound+WhenTheTokenIsInvalid+WhenTheTokenHasAnUnsupportedIssuer.AnHttpUnauthorizedStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJjNDc4MzIzNy01MjNkLTRmZDItYTNhNy1jMmUzZGU2ZWJhMmQiLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3Mzk0LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbXSwiaHR0cHM6Ly9jaGlsaS1wdWJsaXNoLmNvbS9zdWJzY3JpcHRpb25zIjpbXSwiaHR0cHM6Ly9jaGlsaS1wdWJsaXNoLmNvbS9jdXN0b21lcl9ndWlkIjoiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIiwic3ViIjoiMSIsImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vZW52aXJvbm1lbnRJZCI6IiIsInNjb3BlIjoiIn0.)" time="0.3195383" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentIntegrationTests.WhenFetchingASingleEnvironmentUsingTheIdOverload.WhenTheEnvironmentIsFound.WhenTheTokenIsInvalid.WhenTheTokenHasAnUnsupportedIssuer.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Environment\Environment.Integration.Tests.cs:line 376
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentIntegrationTests.WhenFetchingASingleEnvironmentUsingTheIdOverload.WhenTheEnvironmentIsFound.WhenTheTokenIsInvalid.WhenTheTokenHasAnUnsupportedIssuer.AnHttpUnauthorizedStatusCodeIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Environment\Environment.Integration.Tests.cs:line 360
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentIntegrationTests+WhenFetchingASingleEnvironmentUsingTheIdOverload+WhenTheEnvironmentIsFound+WhenTheTokenIsInvalid+WhenTheTokenHasAnUnsupportedAudience.AnHttpUnauthorizedStatusCodeIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment" method="EnvironmentIntegrationTests+WhenFetchingASingleEnvironmentUsingTheIdOverload+WhenTheEnvironmentIsFound+WhenTheTokenIsInvalid+WhenTheTokenHasAnUnsupportedAudience.AnHttpUnauthorizedStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJhN2U0OTRkZi1iNDc1LTQ3ZWQtOGNmYy03NjJkM2NjZWFiN2EiLCJhenAiOiIiLCJleHAiOjE2ODkxNjczOTQsImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vcm9sZXMiOltdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOltdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2N1c3RvbWVyX2d1aWQiOiIwMDAwMDAwMC0wMDAwLTAwMDAtMDAwMC0wMDAwMDAwMDAwMDAiLCJzdWIiOiIxIiwiaHR0cHM6Ly9jaGlsaS1wdWJsaXNoLmNvbS9lbnZpcm9ubWVudElkIjoiIiwic2NvcGUiOiIifQ.)" time="0.2645880" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentIntegrationTests.WhenFetchingASingleEnvironmentUsingTheIdOverload.WhenTheEnvironmentIsFound.WhenTheTokenIsInvalid.WhenTheTokenHasAnUnsupportedAudience.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Environment\Environment.Integration.Tests.cs:line 404
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentIntegrationTests.WhenFetchingASingleEnvironmentUsingTheIdOverload.WhenTheEnvironmentIsFound.WhenTheTokenIsInvalid.WhenTheTokenHasAnUnsupportedAudience.AnHttpUnauthorizedStatusCodeIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Environment\Environment.Integration.Tests.cs:line 388
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentIntegrationTests+WhenFetchingASingleEnvironmentUsingTheIdOverload+WhenTheEnvironmentIsFound+WhenTheTokenHasNoPermissions+WhenTheTokenIsLinkedToTheSupportUserRole.AnHttpForbiddenStatusCodeIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment" method="EnvironmentIntegrationTests+WhenFetchingASingleEnvironmentUsingTheIdOverload+WhenTheEnvironmentIsFound+WhenTheTokenHasNoPermissions+WhenTheTokenIsLinkedToTheSupportUserRole.AnHttpForbiddenStatusCodeIsReturned" time="0.2887220" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentIntegrationTests.WhenFetchingASingleEnvironmentUsingTheIdOverload.WhenTheEnvironmentIsFound.WhenTheTokenHasNoPermissions.WhenTheTokenIsLinkedToTheSupportUserRole.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Environment\Environment.Integration.Tests.cs:line 436
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentIntegrationTests.WhenFetchingASingleEnvironmentUsingTheIdOverload.WhenTheEnvironmentIsFound.WhenTheTokenHasNoPermissions.WhenTheTokenIsLinkedToTheSupportUserRole.AnHttpForbiddenStatusCodeIsReturned() in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Environment\Environment.Integration.Tests.cs:line 418
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentIntegrationTests+WhenFetchingASingleEnvironmentUsingTheIdOverload+WhenTheEnvironmentIsFound+WhenTheTokenHasPermissions+WhenTheTokenIsLinkedToTheFullAccessRole.AnHttpOkStatusCodeIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment" method="EnvironmentIntegrationTests+WhenFetchingASingleEnvironmentUsingTheIdOverload+WhenTheEnvironmentIsFound+WhenTheTokenHasPermissions+WhenTheTokenIsLinkedToTheFullAccessRole.AnHttpOkStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNzA2ODc5Mzk1LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIkZBIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vc3Vic2NyaXB0aW9ucyI6W10sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.2625990" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentIntegrationTests.WhenFetchingASingleEnvironmentUsingTheIdOverload.WhenTheEnvironmentIsFound.WhenTheTokenHasPermissions.WhenTheTokenIsLinkedToTheFullAccessRole.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Environment\Environment.Integration.Tests.cs:line 508
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentIntegrationTests.WhenFetchingASingleEnvironmentUsingTheIdOverload.WhenTheEnvironmentIsFound.WhenTheTokenHasPermissions.WhenTheTokenIsLinkedToTheFullAccessRole.AnHttpOkStatusCodeIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Environment\Environment.Integration.Tests.cs:line 451
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentIntegrationTests+WhenFetchingASingleEnvironmentUsingTheIdOverload+WhenTheEnvironmentIsFound+WhenTheTokenHasPermissions+WhenTheTokenIsLinkedToTheFullAccessRole.TheEnvironmentIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment" method="EnvironmentIntegrationTests+WhenFetchingASingleEnvironmentUsingTheIdOverload+WhenTheEnvironmentIsFound+WhenTheTokenHasPermissions+WhenTheTokenIsLinkedToTheFullAccessRole.TheEnvironmentIsReturned" time="0.2589293" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentIntegrationTests.WhenFetchingASingleEnvironmentUsingTheIdOverload.WhenTheEnvironmentIsFound.WhenTheTokenHasPermissions.WhenTheTokenIsLinkedToTheFullAccessRole.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Environment\Environment.Integration.Tests.cs:line 508
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentIntegrationTests.WhenFetchingASingleEnvironmentUsingTheIdOverload.WhenTheEnvironmentIsFound.WhenTheTokenHasPermissions.WhenTheTokenIsLinkedToTheFullAccessRole.TheEnvironmentIsReturned() in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Environment\Environment.Integration.Tests.cs:line 472
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentIntegrationTests+WhenFetchingASingleEnvironmentUsingTheIdOverload+WhenTheEnvironmentIsFound+WhenTheTokenHasPermissions+WhenTheTokenIsLinkedToTheSubscriptionAdministratorRole.AnHttpOkStatusCodeIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment" method="EnvironmentIntegrationTests+WhenFetchingASingleEnvironmentUsingTheIdOverload+WhenTheEnvironmentIsFound+WhenTheTokenHasPermissions+WhenTheTokenIsLinkedToTheSubscriptionAdministratorRole.AnHttpOkStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNzI2NTc4NTk1LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMHxTQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.2468465" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentIntegrationTests.WhenFetchingASingleEnvironmentUsingTheIdOverload.WhenTheEnvironmentIsFound.WhenTheTokenHasPermissions.WhenTheTokenIsLinkedToTheSubscriptionAdministratorRole.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Environment\Environment.Integration.Tests.cs:line 577
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentIntegrationTests.WhenFetchingASingleEnvironmentUsingTheIdOverload.WhenTheEnvironmentIsFound.WhenTheTokenHasPermissions.WhenTheTokenIsLinkedToTheSubscriptionAdministratorRole.AnHttpOkStatusCodeIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Environment\Environment.Integration.Tests.cs:line 520
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentIntegrationTests+WhenFetchingASingleEnvironmentUsingTheIdOverload+WhenTheEnvironmentIsFound+WhenTheTokenHasPermissions+WhenTheTokenIsLinkedToTheSubscriptionAdministratorRole.TheEnvironmentIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment" method="EnvironmentIntegrationTests+WhenFetchingASingleEnvironmentUsingTheIdOverload+WhenTheEnvironmentIsFound+WhenTheTokenHasPermissions+WhenTheTokenIsLinkedToTheSubscriptionAdministratorRole.TheEnvironmentIsReturned" time="0.2459186" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentIntegrationTests.WhenFetchingASingleEnvironmentUsingTheIdOverload.WhenTheEnvironmentIsFound.WhenTheTokenHasPermissions.WhenTheTokenIsLinkedToTheSubscriptionAdministratorRole.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Environment\Environment.Integration.Tests.cs:line 577
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentIntegrationTests.WhenFetchingASingleEnvironmentUsingTheIdOverload.WhenTheEnvironmentIsFound.WhenTheTokenHasPermissions.WhenTheTokenIsLinkedToTheSubscriptionAdministratorRole.TheEnvironmentIsReturned() in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Environment\Environment.Integration.Tests.cs:line 541
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentIntegrationTests+WhenFetchingASingleEnvironmentUsingTheIdOverload+WhenTheEnvironmentIsFound+WhenTheTokenHasPermissions+WhenTheTokenIsLinkedToTheEnvironmentAdministratorRole.AnHttpOkStatusCodeIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment" method="EnvironmentIntegrationTests+WhenFetchingASingleEnvironmentUsingTheIdOverload+WhenTheEnvironmentIsFound+WhenTheTokenHasPermissions+WhenTheTokenIsLinkedToTheEnvironmentAdministratorRole.AnHttpOkStatusCodeIsReturned" time="0.2147768" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentIntegrationTests.WhenFetchingASingleEnvironmentUsingTheIdOverload.WhenTheEnvironmentIsFound.WhenTheTokenHasPermissions.WhenTheTokenIsLinkedToTheEnvironmentAdministratorRole.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Environment\Environment.Integration.Tests.cs:line 646
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentIntegrationTests.WhenFetchingASingleEnvironmentUsingTheIdOverload.WhenTheEnvironmentIsFound.WhenTheTokenHasPermissions.WhenTheTokenIsLinkedToTheEnvironmentAdministratorRole.AnHttpOkStatusCodeIsReturned() in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Environment\Environment.Integration.Tests.cs:line 588
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentIntegrationTests+WhenFetchingASingleEnvironmentUsingTheIdOverload+WhenTheEnvironmentIsFound+WhenTheTokenHasPermissions+WhenTheTokenIsLinkedToTheEnvironmentAdministratorRole.TheEnvironmentIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment" method="EnvironmentIntegrationTests+WhenFetchingASingleEnvironmentUsingTheIdOverload+WhenTheEnvironmentIsFound+WhenTheTokenHasPermissions+WhenTheTokenIsLinkedToTheEnvironmentAdministratorRole.TheEnvironmentIsReturned" time="0.2848249" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentIntegrationTests.WhenFetchingASingleEnvironmentUsingTheIdOverload.WhenTheEnvironmentIsFound.WhenTheTokenHasPermissions.WhenTheTokenIsLinkedToTheEnvironmentAdministratorRole.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Environment\Environment.Integration.Tests.cs:line 646
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentIntegrationTests.WhenFetchingASingleEnvironmentUsingTheIdOverload.WhenTheEnvironmentIsFound.WhenTheTokenHasPermissions.WhenTheTokenIsLinkedToTheEnvironmentAdministratorRole.TheEnvironmentIsReturned() in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Environment\Environment.Integration.Tests.cs:line 608
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentIntegrationTests+WhenFetchingASingleEnvironmentUsingTheIdOverload+WhenTheEnvironmentIsFound+WhenTheTokenHasPermissions+WhenTheTokenIsLinkedToTheEnvironmentUserRole.TheEnvironmentIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment" method="EnvironmentIntegrationTests+WhenFetchingASingleEnvironmentUsingTheIdOverload+WhenTheEnvironmentIsFound+WhenTheTokenHasPermissions+WhenTheTokenIsLinkedToTheEnvironmentUserRole.TheEnvironmentIsReturned" time="0.2595942" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentIntegrationTests.WhenFetchingASingleEnvironmentUsingTheIdOverload.WhenTheEnvironmentIsFound.WhenTheTokenHasPermissions.WhenTheTokenIsLinkedToTheEnvironmentUserRole.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Environment\Environment.Integration.Tests.cs:line 715
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentIntegrationTests.WhenFetchingASingleEnvironmentUsingTheIdOverload.WhenTheEnvironmentIsFound.WhenTheTokenHasPermissions.WhenTheTokenIsLinkedToTheEnvironmentUserRole.TheEnvironmentIsReturned() in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Environment\Environment.Integration.Tests.cs:line 677
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentIntegrationTests+WhenFetchingASingleEnvironmentUsingTheIdOverload+WhenTheEnvironmentIsFound+WhenTheTokenHasPermissions+WhenTheTokenIsLinkedToTheEnvironmentUserRole.AnHttpOkStatusCodeIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment" method="EnvironmentIntegrationTests+WhenFetchingASingleEnvironmentUsingTheIdOverload+WhenTheEnvironmentIsFound+WhenTheTokenHasPermissions+WhenTheTokenIsLinkedToTheEnvironmentUserRole.AnHttpOkStatusCodeIsReturned" time="0.2914443" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentIntegrationTests.WhenFetchingASingleEnvironmentUsingTheIdOverload.WhenTheEnvironmentIsFound.WhenTheTokenHasPermissions.WhenTheTokenIsLinkedToTheEnvironmentUserRole.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Environment\Environment.Integration.Tests.cs:line 715
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentIntegrationTests.WhenFetchingASingleEnvironmentUsingTheIdOverload.WhenTheEnvironmentIsFound.WhenTheTokenHasPermissions.WhenTheTokenIsLinkedToTheEnvironmentUserRole.AnHttpOkStatusCodeIsReturned() in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Environment\Environment.Integration.Tests.cs:line 657
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When fetching renders of an environment by SA, FA, EU, EA, CA. Returns 200OK." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment" method="EnvironmentIntegrationTests+WhenFetchingASingleEnvironmentWithRenders+WhenTheTokenHasPermissions+WhenRequestIsValid+WhenEnvironmentIsFound.TheSubscriptionRendersAreReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3Mzk3LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbImM0ZDVjYjdlLTgzMTYtNDZmZS05YjdlLTg4NGM5ZTBjMzlhZHxTQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiYzRkNWNiN2UtODMxNi00NmZlLTliN2UtODg0YzllMGMzOWFkIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., grouping: &quot;year&quot;, startDate: null, endDate: null, expectedContent: &quot;[{\&quot;date\&quot;:\&quot;2020-12-01T00:00:00\&quot;,\&quot;totalRenders\&quot;...)" time="0.3282330" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentIntegrationTests.WhenFetchingASingleEnvironmentWithRenders.WhenTheTokenHasPermissions.WhenRequestIsValid.WhenEnvironmentIsFound.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Environment\Environment.Integration.Tests.cs:line 1831
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentIntegrationTests.WhenFetchingASingleEnvironmentWithRenders.WhenTheTokenHasPermissions.WhenRequestIsValid.WhenEnvironmentIsFound.TheSubscriptionRendersAreReturned(Jwt jwt, String grouping, String startDate, String endDate, String expectedContent) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Environment\Environment.Integration.Tests.cs:line 1809
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When fetching renders of an environment by SA, FA, EU, EA, CA. Returns 200OK." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment" method="EnvironmentIntegrationTests+WhenFetchingASingleEnvironmentWithRenders+WhenTheTokenHasPermissions+WhenRequestIsValid+WhenEnvironmentIsFound.TheSubscriptionRendersAreReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3Mzk3LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIkZBIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vc3Vic2NyaXB0aW9ucyI6W10sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., grouping: &quot;year&quot;, startDate: &quot;2021-06-13&quot;, endDate: &quot;2022-01-13&quot;, expectedContent: &quot;[{\&quot;date\&quot;:\&quot;2021-06-01T00:00:00\&quot;,\&quot;totalRenders\&quot;...)" time="0.2604936" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentIntegrationTests.WhenFetchingASingleEnvironmentWithRenders.WhenTheTokenHasPermissions.WhenRequestIsValid.WhenEnvironmentIsFound.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Environment\Environment.Integration.Tests.cs:line 1831
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentIntegrationTests.WhenFetchingASingleEnvironmentWithRenders.WhenTheTokenHasPermissions.WhenRequestIsValid.WhenEnvironmentIsFound.TheSubscriptionRendersAreReturned(Jwt jwt, String grouping, String startDate, String endDate, String expectedContent) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Environment\Environment.Integration.Tests.cs:line 1809
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When fetching renders of an environment by SA, FA, EU, EA, CA. Returns 200OK." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment" method="EnvironmentIntegrationTests+WhenFetchingASingleEnvironmentWithRenders+WhenTheTokenHasPermissions+WhenRequestIsValid+WhenEnvironmentIsFound.TheSubscriptionRendersAreReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3Mzk3LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbImE5ZmMxOGVlLTIzODQtNDE0OS04ZTUzLTQxZjIyMjcyNDlhZXxFVSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiYzRkNWNiN2UtODMxNi00NmZlLTliN2UtODg0YzllMGMzOWFkIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., grouping: &quot;month&quot;, startDate: &quot;2021-11-05&quot;, endDate: &quot;2021-11-15&quot;, expectedContent: &quot;[{\&quot;date\&quot;:\&quot;2021-11-05T00:00:00\&quot;,\&quot;totalRenders\&quot;...)" time="0.2419727" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentIntegrationTests.WhenFetchingASingleEnvironmentWithRenders.WhenTheTokenHasPermissions.WhenRequestIsValid.WhenEnvironmentIsFound.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Environment\Environment.Integration.Tests.cs:line 1831
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentIntegrationTests.WhenFetchingASingleEnvironmentWithRenders.WhenTheTokenHasPermissions.WhenRequestIsValid.WhenEnvironmentIsFound.TheSubscriptionRendersAreReturned(Jwt jwt, String grouping, String startDate, String endDate, String expectedContent) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Environment\Environment.Integration.Tests.cs:line 1809
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When fetching renders of an environment by SA, FA, EU, EA, CA. Returns 200OK." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment" method="EnvironmentIntegrationTests+WhenFetchingASingleEnvironmentWithRenders+WhenTheTokenHasPermissions+WhenRequestIsValid+WhenEnvironmentIsFound.TheSubscriptionRendersAreReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3Mzk3LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbImE5ZmMxOGVlLTIzODQtNDE0OS04ZTUzLTQxZjIyMjcyNDlhZXxFQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiYzRkNWNiN2UtODMxNi00NmZlLTliN2UtODg0YzllMGMzOWFkIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., grouping: &quot;month&quot;, startDate: null, endDate: null, expectedContent: &quot;[{\&quot;date\&quot;:\&quot;2021-11-03T00:00:00\&quot;,\&quot;totalRenders\&quot;...)" time="0.3317131" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentIntegrationTests.WhenFetchingASingleEnvironmentWithRenders.WhenTheTokenHasPermissions.WhenRequestIsValid.WhenEnvironmentIsFound.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Environment\Environment.Integration.Tests.cs:line 1831
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentIntegrationTests.WhenFetchingASingleEnvironmentWithRenders.WhenTheTokenHasPermissions.WhenRequestIsValid.WhenEnvironmentIsFound.TheSubscriptionRendersAreReturned(Jwt jwt, String grouping, String startDate, String endDate, String expectedContent) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Environment\Environment.Integration.Tests.cs:line 1809
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When subscription isn't found. Returns 404NotFound." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment" method="EnvironmentIntegrationTests+WhenFetchingASingleEnvironmentWithRenders+WhenTheTokenHasPermissions+WhenRequestIsValid+WhenEnvironmentIsNotFound.TheNotFoundStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3Mzk4LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIkZBIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vc3Vic2NyaXB0aW9ucyI6W10sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., grouping: &quot;month&quot;, startDate: &quot;2020-01-30&quot;, endDate: &quot;2022-01-01&quot;)" time="0.4363860" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected result.StatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected result.StatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.EnumAssertions`2.Be(TEnum expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentIntegrationTests.WhenFetchingASingleEnvironmentWithRenders.WhenTheTokenHasPermissions.WhenRequestIsValid.WhenEnvironmentIsNotFound.TheNotFoundStatusCodeIsReturned(Jwt jwt, String grouping, String startDate, String endDate) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Environment\Environment.Integration.Tests.cs:line 1874
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When subscription isn't found. Returns 404NotFound." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment" method="EnvironmentIntegrationTests+WhenFetchingASingleEnvironmentWithRenders+WhenTheTokenHasPermissions+WhenRequestIsValid+WhenEnvironmentIsNotFound.TheNotFoundStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3Mzk4LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMHxTQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., grouping: &quot;year&quot;, startDate: &quot;2020-01-30&quot;, endDate: &quot;2022-01-01&quot;)" time="0.4011237" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected result.StatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected result.StatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.EnumAssertions`2.Be(TEnum expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentIntegrationTests.WhenFetchingASingleEnvironmentWithRenders.WhenTheTokenHasPermissions.WhenRequestIsValid.WhenEnvironmentIsNotFound.TheNotFoundStatusCodeIsReturned(Jwt jwt, String grouping, String startDate, String endDate) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Environment\Environment.Integration.Tests.cs:line 1874
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When fetching renders of an environment by SA, FA, EU, EA, CA. Returns 200OK." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment" method="EnvironmentIntegrationTests+WhenFetchingASingleEnvironmentWithRendersByGuid+WhenTheTokenHasPermissions+WhenRequestIsValid+WhenEnvironmentIsFound.TheSubscriptionRendersAreReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3Mzk5LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjI5YzA1OWM5LTZmNTItNGE2Ni1hYzczLTJmNTBkYzBlMjEyZHxTQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMjljMDU5YzktNmY1Mi00YTY2LWFjNzMtMmY1MGRjMGUyMTJkIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., grouping: &quot;year&quot;, startDate: null, endDate: null, expectedContent: &quot;[{\&quot;date\&quot;:\&quot;2020-12-01T00:00:00\&quot;,\&quot;totalRenders\&quot;...)" time="0.3042086" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentIntegrationTests.WhenFetchingASingleEnvironmentWithRendersByGuid.WhenTheTokenHasPermissions.WhenRequestIsValid.WhenEnvironmentIsFound.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Environment\Environment.Integration.Tests.cs:line 2032
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentIntegrationTests.WhenFetchingASingleEnvironmentWithRendersByGuid.WhenTheTokenHasPermissions.WhenRequestIsValid.WhenEnvironmentIsFound.TheSubscriptionRendersAreReturned(Jwt jwt, String grouping, String startDate, String endDate, String expectedContent) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Environment\Environment.Integration.Tests.cs:line 2010
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When fetching renders of an environment by SA, FA, EU, EA, CA. Returns 200OK." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment" method="EnvironmentIntegrationTests+WhenFetchingASingleEnvironmentWithRendersByGuid+WhenTheTokenHasPermissions+WhenRequestIsValid+WhenEnvironmentIsFound.TheSubscriptionRendersAreReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3Mzk5LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIkZBIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vc3Vic2NyaXB0aW9ucyI6W10sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., grouping: &quot;year&quot;, startDate: &quot;2021-06-13&quot;, endDate: &quot;2022-01-13&quot;, expectedContent: &quot;[{\&quot;date\&quot;:\&quot;2021-06-01T00:00:00\&quot;,\&quot;totalRenders\&quot;...)" time="0.2570550" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentIntegrationTests.WhenFetchingASingleEnvironmentWithRendersByGuid.WhenTheTokenHasPermissions.WhenRequestIsValid.WhenEnvironmentIsFound.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Environment\Environment.Integration.Tests.cs:line 2032
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentIntegrationTests.WhenFetchingASingleEnvironmentWithRendersByGuid.WhenTheTokenHasPermissions.WhenRequestIsValid.WhenEnvironmentIsFound.TheSubscriptionRendersAreReturned(Jwt jwt, String grouping, String startDate, String endDate, String expectedContent) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Environment\Environment.Integration.Tests.cs:line 2010
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When fetching renders of an environment by SA, FA, EU, EA, CA. Returns 200OK." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment" method="EnvironmentIntegrationTests+WhenFetchingASingleEnvironmentWithRendersByGuid+WhenTheTokenHasPermissions+WhenRequestIsValid+WhenEnvironmentIsFound.TheSubscriptionRendersAreReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3Mzk5LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbImQxNmYwZTQ5LWUwODktNGVhNS04YjI4LTYwZWE3ZDhhMjQ2N3xFVSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMjljMDU5YzktNmY1Mi00YTY2LWFjNzMtMmY1MGRjMGUyMTJkIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., grouping: &quot;month&quot;, startDate: &quot;2021-11-05&quot;, endDate: &quot;2021-11-15&quot;, expectedContent: &quot;[{\&quot;date\&quot;:\&quot;2021-11-05T00:00:00\&quot;,\&quot;totalRenders\&quot;...)" time="0.2062126" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentIntegrationTests.WhenFetchingASingleEnvironmentWithRendersByGuid.WhenTheTokenHasPermissions.WhenRequestIsValid.WhenEnvironmentIsFound.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Environment\Environment.Integration.Tests.cs:line 2032
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentIntegrationTests.WhenFetchingASingleEnvironmentWithRendersByGuid.WhenTheTokenHasPermissions.WhenRequestIsValid.WhenEnvironmentIsFound.TheSubscriptionRendersAreReturned(Jwt jwt, String grouping, String startDate, String endDate, String expectedContent) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Environment\Environment.Integration.Tests.cs:line 2010
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When fetching renders of an environment by SA, FA, EU, EA, CA. Returns 200OK." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment" method="EnvironmentIntegrationTests+WhenFetchingASingleEnvironmentWithRendersByGuid+WhenTheTokenHasPermissions+WhenRequestIsValid+WhenEnvironmentIsFound.TheSubscriptionRendersAreReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3Mzk5LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbImQxNmYwZTQ5LWUwODktNGVhNS04YjI4LTYwZWE3ZDhhMjQ2N3xFQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMjljMDU5YzktNmY1Mi00YTY2LWFjNzMtMmY1MGRjMGUyMTJkIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., grouping: &quot;month&quot;, startDate: null, endDate: null, expectedContent: &quot;[{\&quot;date\&quot;:\&quot;2021-11-03T00:00:00\&quot;,\&quot;totalRenders\&quot;...)" time="0.3008022" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentIntegrationTests.WhenFetchingASingleEnvironmentWithRendersByGuid.WhenTheTokenHasPermissions.WhenRequestIsValid.WhenEnvironmentIsFound.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Environment\Environment.Integration.Tests.cs:line 2032
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentIntegrationTests.WhenFetchingASingleEnvironmentWithRendersByGuid.WhenTheTokenHasPermissions.WhenRequestIsValid.WhenEnvironmentIsFound.TheSubscriptionRendersAreReturned(Jwt jwt, String grouping, String startDate, String endDate, String expectedContent) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Environment\Environment.Integration.Tests.cs:line 2010
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When subscription isn't found. Returns 404NotFound." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment" method="EnvironmentIntegrationTests+WhenFetchingASingleEnvironmentWithRendersByGuid+WhenTheTokenHasPermissions+WhenRequestIsValid+WhenEnvironmentIsNotFound.TheNotFoundStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3NDAwLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIkZBIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vc3Vic2NyaXB0aW9ucyI6W10sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., grouping: &quot;month&quot;, startDate: &quot;2020-01-30&quot;, endDate: &quot;2022-01-01&quot;)" time="0.3265915" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected result.StatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected result.StatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.EnumAssertions`2.Be(TEnum expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentIntegrationTests.WhenFetchingASingleEnvironmentWithRendersByGuid.WhenTheTokenHasPermissions.WhenRequestIsValid.WhenEnvironmentIsNotFound.TheNotFoundStatusCodeIsReturned(Jwt jwt, String grouping, String startDate, String endDate) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Environment\Environment.Integration.Tests.cs:line 2054
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When subscription isn't found. Returns 404NotFound." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment" method="EnvironmentIntegrationTests+WhenFetchingASingleEnvironmentWithRendersByGuid+WhenTheTokenHasPermissions+WhenRequestIsValid+WhenEnvironmentIsNotFound.TheNotFoundStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3NDAwLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMHxTQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., grouping: &quot;year&quot;, startDate: &quot;2020-01-30&quot;, endDate: &quot;2022-01-01&quot;)" time="2.6755825" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected result.StatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected result.StatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.EnumAssertions`2.Be(TEnum expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentIntegrationTests.WhenFetchingASingleEnvironmentWithRendersByGuid.WhenTheTokenHasPermissions.WhenRequestIsValid.WhenEnvironmentIsNotFound.TheNotFoundStatusCodeIsReturned(Jwt jwt, String grouping, String startDate, String endDate) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Environment\Environment.Integration.Tests.cs:line 2054
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When subscription isn't accessible for EA, EU, CA, SA. Returns 403Forbid." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment" method="EnvironmentIntegrationTests+WhenFetchingSubscriptionEnvironments+WhenTokenHasPermissions+WhenRequestIsValid+WhenSubscriptionIsNotFound.AnHttpNotFoundStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3NDAzLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjU2MWYzNDlkLTM3ODQtNDZiOS04OTYwLTM1ZWYzMjA2MWUzZnxTQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiNTYxZjM0OWQtMzc4NC00NmI5LTg5NjAtMzVlZjMyMDYxZTNmIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.4040554" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected result.StatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected result.StatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.EnumAssertions`2.Be(TEnum expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentIntegrationTests.WhenFetchingSubscriptionEnvironments.WhenTokenHasPermissions.WhenRequestIsValid.WhenSubscriptionIsNotFound.AnHttpNotFoundStatusCodeIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Environment\Environment.Integration.Tests.cs:line 2402
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When subscription isn't accessible for EA, EU, CA, SA. Returns 403Forbid." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment" method="EnvironmentIntegrationTests+WhenFetchingSubscriptionEnvironments+WhenTokenHasPermissions+WhenRequestIsValid+WhenSubscriptionIsNotFound.AnHttpNotFoundStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3NDAzLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbImE1ZDMzYTg2LTNjYmUtNDI5Yi05NTQ0LTAzMjlmOTUxYmJjZHxFVSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiNTYxZjM0OWQtMzc4NC00NmI5LTg5NjAtMzVlZjMyMDYxZTNmIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="2.4672560" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected result.StatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected result.StatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.EnumAssertions`2.Be(TEnum expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentIntegrationTests.WhenFetchingSubscriptionEnvironments.WhenTokenHasPermissions.WhenRequestIsValid.WhenSubscriptionIsNotFound.AnHttpNotFoundStatusCodeIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Environment\Environment.Integration.Tests.cs:line 2402
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When subscription is accessible for EA, EU, CA, FA, SA. Returns 200OK and accessible environments" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment" method="EnvironmentIntegrationTests+WhenFetchingSubscriptionEnvironments+WhenTokenHasPermissions+WhenRequestIsValid+WhenSubscriptionIsFound+WhenSubscriptionIsAccessible.TheEnvironmentsAreReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3Nzg4LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIkZBIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vc3Vic2NyaXB0aW9ucyI6W10sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., expectedContent: &quot;[{\&quot;id\&quot;:1,\&quot;guid\&quot;:\&quot;a5d33a86-3cbe-429b-9544-0329&quot;...)" time="1.7137919" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentIntegrationTests.WhenFetchingSubscriptionEnvironments.WhenTokenHasPermissions.WhenRequestIsValid.WhenSubscriptionIsFound.WhenSubscriptionIsAccessible.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Environment\Environment.Integration.Tests.cs:line 2315
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentIntegrationTests.WhenFetchingSubscriptionEnvironments.WhenTokenHasPermissions.WhenRequestIsValid.WhenSubscriptionIsFound.WhenSubscriptionIsAccessible.TheEnvironmentsAreReturned(Jwt jwt, String expectedContent) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Environment\Environment.Integration.Tests.cs:line 2293
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When subscription is accessible for EA, EU, CA, FA, SA. Returns 200OK and accessible environments" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment" method="EnvironmentIntegrationTests+WhenFetchingSubscriptionEnvironments+WhenTokenHasPermissions+WhenRequestIsValid+WhenSubscriptionIsFound+WhenSubscriptionIsAccessible.TheEnvironmentsAreReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3Nzg4LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjU2MWYzNDlkLTM3ODQtNDZiOS04OTYwLTM1ZWYzMjA2MWUzZnxTQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiNTYxZjM0OWQtMzc4NC00NmI5LTg5NjAtMzVlZjMyMDYxZTNmIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., expectedContent: &quot;[{\&quot;id\&quot;:1,\&quot;guid\&quot;:\&quot;a5d33a86-3cbe-429b-9544-0329&quot;...)" time="3.0768423" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentIntegrationTests.WhenFetchingSubscriptionEnvironments.WhenTokenHasPermissions.WhenRequestIsValid.WhenSubscriptionIsFound.WhenSubscriptionIsAccessible.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Environment\Environment.Integration.Tests.cs:line 2315
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentIntegrationTests.WhenFetchingSubscriptionEnvironments.WhenTokenHasPermissions.WhenRequestIsValid.WhenSubscriptionIsFound.WhenSubscriptionIsAccessible.TheEnvironmentsAreReturned(Jwt jwt, String expectedContent) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Environment\Environment.Integration.Tests.cs:line 2293
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When subscription is accessible for EA, EU, CA, FA, SA. Returns 200OK and accessible environments" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment" method="EnvironmentIntegrationTests+WhenFetchingSubscriptionEnvironments+WhenTokenHasPermissions+WhenRequestIsValid+WhenSubscriptionIsFound+WhenSubscriptionIsAccessible.TheEnvironmentsAreReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3Nzg4LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbImE1ZDMzYTg2LTNjYmUtNDI5Yi05NTQ0LTAzMjlmOTUxYmJjZHxFQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiNTYxZjM0OWQtMzc4NC00NmI5LTg5NjAtMzVlZjMyMDYxZTNmIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., expectedContent: &quot;[{\&quot;id\&quot;:1,\&quot;guid\&quot;:\&quot;a5d33a86-3cbe-429b-9544-0329&quot;...)" time="4.9346714" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentIntegrationTests.WhenFetchingSubscriptionEnvironments.WhenTokenHasPermissions.WhenRequestIsValid.WhenSubscriptionIsFound.WhenSubscriptionIsAccessible.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Environment\Environment.Integration.Tests.cs:line 2315
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentIntegrationTests.WhenFetchingSubscriptionEnvironments.WhenTokenHasPermissions.WhenRequestIsValid.WhenSubscriptionIsFound.WhenSubscriptionIsAccessible.TheEnvironmentsAreReturned(Jwt jwt, String expectedContent) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Environment\Environment.Integration.Tests.cs:line 2293
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When subscription is accessible for EA, EU, CA, FA, SA. Returns 200OK and accessible environments" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment" method="EnvironmentIntegrationTests+WhenFetchingSubscriptionEnvironments+WhenTokenHasPermissions+WhenRequestIsValid+WhenSubscriptionIsFound+WhenSubscriptionIsAccessible.TheEnvironmentsAreReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3Nzg4LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbImE1ZDMzYTg2LTNjYmUtNDI5Yi05NTQ0LTAzMjlmOTUxYmJjZHxFVSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiNTYxZjM0OWQtMzc4NC00NmI5LTg5NjAtMzVlZjMyMDYxZTNmIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., expectedContent: &quot;[{\&quot;id\&quot;:1,\&quot;guid\&quot;:\&quot;a5d33a86-3cbe-429b-9544-0329&quot;...)" time="2.2270171" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentIntegrationTests.WhenFetchingSubscriptionEnvironments.WhenTokenHasPermissions.WhenRequestIsValid.WhenSubscriptionIsFound.WhenSubscriptionIsAccessible.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Environment\Environment.Integration.Tests.cs:line 2315
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentIntegrationTests.WhenFetchingSubscriptionEnvironments.WhenTokenHasPermissions.WhenRequestIsValid.WhenSubscriptionIsFound.WhenSubscriptionIsAccessible.TheEnvironmentsAreReturned(Jwt jwt, String expectedContent) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Environment\Environment.Integration.Tests.cs:line 2293
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When subscription is accessible for EA, EU, CA, FA, SA. Returns 200OK and accessible environments" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment" method="EnvironmentIntegrationTests+WhenFetchingSubscriptionEnvironments+WhenTokenHasPermissions+WhenRequestIsValid+WhenSubscriptionIsFound+WhenSubscriptionIsAccessible.TheEnvironmentsAreReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3Nzg4LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjUxNmE3NzQxLWY5MWQtNDdkZi05M2MzLTM1NmM3NWY1ZTE1ZHxDQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiNTYxZjM0OWQtMzc4NC00NmI5LTg5NjAtMzVlZjMyMDYxZTNmIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., expectedContent: &quot;[{\&quot;id\&quot;:2,\&quot;guid\&quot;:\&quot;516a7741-f91d-47df-93c3-356c&quot;...)" time="2.2069093" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentIntegrationTests.WhenFetchingSubscriptionEnvironments.WhenTokenHasPermissions.WhenRequestIsValid.WhenSubscriptionIsFound.WhenSubscriptionIsAccessible.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Environment\Environment.Integration.Tests.cs:line 2315
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentIntegrationTests.WhenFetchingSubscriptionEnvironments.WhenTokenHasPermissions.WhenRequestIsValid.WhenSubscriptionIsFound.WhenSubscriptionIsAccessible.TheEnvironmentsAreReturned(Jwt jwt, String expectedContent) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Environment\Environment.Integration.Tests.cs:line 2293
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When subscription isn't accessible for EA, EU, CA, SA. Returns 403Forbid." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment" method="EnvironmentIntegrationTests+WhenFetchingSubscriptionEnvironments+WhenTokenHasPermissions+WhenRequestIsValid+WhenSubscriptionIsFound+WhenSubscriptionIsNotAccessible.AnHttpForbidStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3ODAyLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMHxTQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="20.0351557" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected result.StatusCode to be HttpStatusCode.Forbidden {value: 403}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected result.StatusCode to be HttpStatusCode.Forbidden {value: 403}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.EnumAssertions`2.Be(TEnum expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentIntegrationTests.WhenFetchingSubscriptionEnvironments.WhenTokenHasPermissions.WhenRequestIsValid.WhenSubscriptionIsFound.WhenSubscriptionIsNotAccessible.AnHttpForbidStatusCodeIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Environment\Environment.Integration.Tests.cs:line 2364
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When subscription isn't accessible for EA, EU, CA, SA. Returns 403Forbid." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment" method="EnvironmentIntegrationTests+WhenFetchingSubscriptionEnvironments+WhenTokenHasPermissions+WhenRequestIsValid+WhenSubscriptionIsFound+WhenSubscriptionIsNotAccessible.AnHttpForbidStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3ODAyLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMHxFQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="119.1475864" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected result.StatusCode to be HttpStatusCode.Forbidden {value: 403}, but found HttpStatusCode.InternalServerError {value: 500}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected result.StatusCode to be HttpStatusCode.Forbidden {value: 403}, but found HttpStatusCode.InternalServerError {value: 500}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.EnumAssertions`2.Be(TEnum expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentIntegrationTests.WhenFetchingSubscriptionEnvironments.WhenTokenHasPermissions.WhenRequestIsValid.WhenSubscriptionIsFound.WhenSubscriptionIsNotAccessible.AnHttpForbidStatusCodeIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Environment\Environment.Integration.Tests.cs:line 2364
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When subscription isn't accessible for EA, EU, CA, SA. Returns 403Forbid." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment" method="EnvironmentIntegrationTests+WhenFetchingSubscriptionEnvironments+WhenTokenHasPermissions+WhenRequestIsValid+WhenSubscriptionIsFound+WhenSubscriptionIsNotAccessible.AnHttpForbidStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3ODAyLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMHxDQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="12.3464448" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected result.StatusCode to be HttpStatusCode.Forbidden {value: 403}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected result.StatusCode to be HttpStatusCode.Forbidden {value: 403}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.EnumAssertions`2.Be(TEnum expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentIntegrationTests.WhenFetchingSubscriptionEnvironments.WhenTokenHasPermissions.WhenRequestIsValid.WhenSubscriptionIsFound.WhenSubscriptionIsNotAccessible.AnHttpForbidStatusCodeIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Environment\Environment.Integration.Tests.cs:line 2364
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When subscription isn't accessible for EA, EU, CA, SA. Returns 403Forbid." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment" method="EnvironmentIntegrationTests+WhenFetchingSubscriptionEnvironments+WhenTokenHasPermissions+WhenRequestIsValid+WhenSubscriptionIsFound+WhenSubscriptionIsNotAccessible.AnHttpForbidStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3ODAyLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMHxFVSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="9.3699227" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected result.StatusCode to be HttpStatusCode.Forbidden {value: 403}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected result.StatusCode to be HttpStatusCode.Forbidden {value: 403}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.EnumAssertions`2.Be(TEnum expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Environment.EnvironmentIntegrationTests.WhenFetchingSubscriptionEnvironments.WhenTokenHasPermissions.WhenRequestIsValid.WhenSubscriptionIsFound.WhenSubscriptionIsNotAccessible.AnHttpForbidStatusCodeIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Environment\Environment.Integration.Tests.cs:line 2364
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
    </collection>
    <collection total="96" passed="0" failed="96" skipped="0" name="Test collection for CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration" time="35.169">
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationContractTests+ApiV1IntegrationGetEndpoint+WhenReturnsStatusCodeUnauthorized.ProblemDetailsContentIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration" method="IntegrationContractTests+ApiV1IntegrationGetEndpoint+WhenReturnsStatusCodeUnauthorized.ProblemDetailsContentIsReturned" time="0.1357337" result="Fail">
        <failure>
          <message>System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationContractTests+ApiV1IntegrationGetEndpoint+WhenReturnsStatusCodeForbidden.ProblemDetailsContentIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration" method="IntegrationContractTests+ApiV1IntegrationGetEndpoint+WhenReturnsStatusCodeForbidden.ProblemDetailsContentIsReturned" time="0.1358646" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationContractTests.ApiV1IntegrationGetEndpoint.WhenReturnsStatusCodeForbidden.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Integration\Integration.Contract.Tests.cs:line 108
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationContractTests.ApiV1IntegrationGetEndpoint.WhenReturnsStatusCodeForbidden.ProblemDetailsContentIsReturned() in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Integration\Integration.Contract.Tests.cs:line 83
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationContractTests+ApiV1IntegrationGetEndpoint+WhenReturnsStatusCodeNotFound.ProblemDetailsContentIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration" method="IntegrationContractTests+ApiV1IntegrationGetEndpoint+WhenReturnsStatusCodeNotFound.ProblemDetailsContentIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNzE3Njc5MTk1LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMHxTQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.2094867" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected HttpStatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected HttpStatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.HttpResponseMessageAssertions`1.HaveStatusCode(HttpStatusCode expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationContractTests.ApiV1IntegrationGetEndpoint.WhenReturnsStatusCodeNotFound.ProblemDetailsContentIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Integration\Integration.Contract.Tests.cs:line 156
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationContractTests+ApiV1IntegrationRotateClientSecretPostEndpoint+WhenReturnsStatusCodeUnauthorized.ProblemDetailsContentIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration" method="IntegrationContractTests+ApiV1IntegrationRotateClientSecretPostEndpoint+WhenReturnsStatusCodeUnauthorized.ProblemDetailsContentIsReturned" time="0.1646857" result="Fail">
        <failure>
          <message>System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationContractTests+ApiV1IntegrationRotateClientSecretPostEndpoint+WhenReturnsStatusCodeForbidden.ProblemDetailsContentIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration" method="IntegrationContractTests+ApiV1IntegrationRotateClientSecretPostEndpoint+WhenReturnsStatusCodeForbidden.ProblemDetailsContentIsReturned" time="0.1479521" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationContractTests.ApiV1IntegrationRotateClientSecretPostEndpoint.WhenReturnsStatusCodeForbidden.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Integration\Integration.Contract.Tests.cs:line 234
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationContractTests.ApiV1IntegrationRotateClientSecretPostEndpoint.WhenReturnsStatusCodeForbidden.ProblemDetailsContentIsReturned() in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Integration\Integration.Contract.Tests.cs:line 209
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationContractTests+ApiV1IntegrationRotateClientSecretPostEndpoint+WhenReturnsStatusCodeNotFound.ProblemDetailsContentIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration" method="IntegrationContractTests+ApiV1IntegrationRotateClientSecretPostEndpoint+WhenReturnsStatusCodeNotFound.ProblemDetailsContentIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNzE0Mzk1OTk2LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMHxTQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.2470642" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected HttpStatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected HttpStatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.HttpResponseMessageAssertions`1.HaveStatusCode(HttpStatusCode expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationContractTests.ApiV1IntegrationRotateClientSecretPostEndpoint.WhenReturnsStatusCodeNotFound.ProblemDetailsContentIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Integration\Integration.Contract.Tests.cs:line 282
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationContractTests+ApiV1IntegrationDeleteEndpoint+WhenReturnsStatusCodeUnauthorized.ProblemDetailsContentIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration" method="IntegrationContractTests+ApiV1IntegrationDeleteEndpoint+WhenReturnsStatusCodeUnauthorized.ProblemDetailsContentIsReturned" time="0.1372246" result="Fail">
        <failure>
          <message>System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationContractTests+ApiV1IntegrationDeleteEndpoint+WhenReturnsStatusCodeForbidden.ProblemDetailsContentIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration" method="IntegrationContractTests+ApiV1IntegrationDeleteEndpoint+WhenReturnsStatusCodeForbidden.ProblemDetailsContentIsReturned" time="0.1358374" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationContractTests.ApiV1IntegrationDeleteEndpoint.WhenReturnsStatusCodeForbidden.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Integration\Integration.Contract.Tests.cs:line 360
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationContractTests.ApiV1IntegrationDeleteEndpoint.WhenReturnsStatusCodeForbidden.ProblemDetailsContentIsReturned() in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Integration\Integration.Contract.Tests.cs:line 335
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationContractTests+ApiV1IntegrationDeleteEndpoint+WhenReturnsStatusCodeNotFound.ProblemDetailsContentIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration" method="IntegrationContractTests+ApiV1IntegrationDeleteEndpoint+WhenReturnsStatusCodeNotFound.ProblemDetailsContentIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNzEzODc3NTk2LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMHxTQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.2486483" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected HttpStatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected HttpStatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.HttpResponseMessageAssertions`1.HaveStatusCode(HttpStatusCode expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationContractTests.ApiV1IntegrationDeleteEndpoint.WhenReturnsStatusCodeNotFound.ProblemDetailsContentIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Integration\Integration.Contract.Tests.cs:line 408
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationContractTests+ApiV1IntegrationPostEndpoint+WhenReturnsStatusCodeUnauthorized.ProblemDetailsContentIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration" method="IntegrationContractTests+ApiV1IntegrationPostEndpoint+WhenReturnsStatusCodeUnauthorized.ProblemDetailsContentIsReturned()" time="0.1639352" result="Fail">
        <failure>
          <message>System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationContractTests+ApiV1IntegrationPostEndpoint+WhenReturnsStatusCodeUnauthorized.ProblemDetailsContentIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration" method="IntegrationContractTests+ApiV1IntegrationPostEndpoint+WhenReturnsStatusCodeUnauthorized.ProblemDetailsContentIsReturned()" time="0.1524673" result="Fail">
        <failure>
          <message>System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationContractTests+ApiV1IntegrationPostEndpoint+WhenReturnsStatusCodeForbidden.ProblemDetailsContentIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration" method="IntegrationContractTests+ApiV1IntegrationPostEndpoint+WhenReturnsStatusCodeForbidden.ProblemDetailsContentIsReturned" time="0.1172773" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationContractTests.ApiV1IntegrationPostEndpoint.WhenReturnsStatusCodeForbidden.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Integration\Integration.Contract.Tests.cs:line 495
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationContractTests.ApiV1IntegrationPostEndpoint.WhenReturnsStatusCodeForbidden.ProblemDetailsContentIsReturned() in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Integration\Integration.Contract.Tests.cs:line 472
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationContractTests+ApiV1IntegrationPostEndpoint+WhenReturnsStatusCodeProblem.ProblemDetailsContentIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration" method="IntegrationContractTests+ApiV1IntegrationPostEndpoint+WhenReturnsStatusCodeProblem.ProblemDetailsContentIsReturned" time="0.1351188" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationContractTests.ApiV1IntegrationPostEndpoint.WhenReturnsStatusCodeProblem.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Integration\Integration.Contract.Tests.cs:line 549
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationContractTests.ApiV1IntegrationPostEndpoint.WhenReturnsStatusCodeProblem.ProblemDetailsContentIsReturned() in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Integration\Integration.Contract.Tests.cs:line 526
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationContractTests+ApiV1IntegrationPostEndpoint+WhenReturnsStatusCodeBadRequest.ProblemDetailsContentIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration" method="IntegrationContractTests+ApiV1IntegrationPostEndpoint+WhenReturnsStatusCodeBadRequest.ProblemDetailsContentIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNzI2MjMyNzk3LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMHxTQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.2341088" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected HttpStatusCode to be HttpStatusCode.BadRequest {value: 400}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected HttpStatusCode to be HttpStatusCode.BadRequest {value: 400}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.HttpResponseMessageAssertions`1.HaveStatusCode(HttpStatusCode expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationContractTests.ApiV1IntegrationPostEndpoint.WhenReturnsStatusCodeBadRequest.ProblemDetailsContentIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Integration\Integration.Contract.Tests.cs:line 604
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationContractTests+ApiV1IntegrationPostEndpoint+WhenReturnsStatusCodeNotFound.ProblemDetailsContentIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration" method="IntegrationContractTests+ApiV1IntegrationPostEndpoint+WhenReturnsStatusCodeNotFound.ProblemDetailsContentIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNzI4OTExMTk3LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIkZBIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vc3Vic2NyaXB0aW9ucyI6W10sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.2101164" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected HttpStatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected HttpStatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.HttpResponseMessageAssertions`1.HaveStatusCode(HttpStatusCode expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationContractTests.ApiV1IntegrationPostEndpoint.WhenReturnsStatusCodeNotFound.ProblemDetailsContentIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Integration\Integration.Contract.Tests.cs:line 633
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationContractTests+ApiV1IntegrationsGetEndpoint+WhenReturnsStatusCodeUnauthorized.ProblemDetailsContentIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration" method="IntegrationContractTests+ApiV1IntegrationsGetEndpoint+WhenReturnsStatusCodeUnauthorized.ProblemDetailsContentIsReturned" time="0.2079139" result="Fail">
        <failure>
          <message>System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationContractTests+ApiV1IntegrationsGetEndpoint+WhenReturnsStatusCodeForbidden.ProblemDetailsContentIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration" method="IntegrationContractTests+ApiV1IntegrationsGetEndpoint+WhenReturnsStatusCodeForbidden.ProblemDetailsContentIsReturned" time="0.1465370" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationContractTests.ApiV1IntegrationsGetEndpoint.WhenReturnsStatusCodeForbidden.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Integration\Integration.Contract.Tests.cs:line 711
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationContractTests.ApiV1IntegrationsGetEndpoint.WhenReturnsStatusCodeForbidden.ProblemDetailsContentIsReturned() in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Integration\Integration.Contract.Tests.cs:line 686
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationContractTests+ApiV1IntegrationsGetEndpoint+WhenReturnsStatusCodeNotFound.ProblemDetailsContentIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration" method="IntegrationContractTests+ApiV1IntegrationsGetEndpoint+WhenReturnsStatusCodeNotFound.ProblemDetailsContentIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNzE4MjgzOTk4LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMHxTQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.2080275" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected HttpStatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected HttpStatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.HttpResponseMessageAssertions`1.HaveStatusCode(HttpStatusCode expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationContractTests.ApiV1IntegrationsGetEndpoint.WhenReturnsStatusCodeNotFound.ProblemDetailsContentIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Integration\Integration.Contract.Tests.cs:line 759
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationContractTests+ApiV1IntegrationPutEndpoint+WhenReturnsStatusCodeUnauthorized.ProblemDetailsContentIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration" method="IntegrationContractTests+ApiV1IntegrationPutEndpoint+WhenReturnsStatusCodeUnauthorized.ProblemDetailsContentIsReturned" time="0.1341446" result="Fail">
        <failure>
          <message>System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationContractTests+ApiV1IntegrationPutEndpoint+WhenReturnsStatusCodeForbidden.ProblemDetailsContentIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration" method="IntegrationContractTests+ApiV1IntegrationPutEndpoint+WhenReturnsStatusCodeForbidden.ProblemDetailsContentIsReturned" time="0.1376628" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationContractTests.ApiV1IntegrationPutEndpoint.WhenReturnsStatusCodeForbidden.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Integration\Integration.Contract.Tests.cs:line 843
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationContractTests.ApiV1IntegrationPutEndpoint.WhenReturnsStatusCodeForbidden.ProblemDetailsContentIsReturned() in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Integration\Integration.Contract.Tests.cs:line 820
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationContractTests+ApiV1IntegrationPutEndpoint+WhenReturnsStatusCodeBadRequest.ProblemDetailsContentIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration" method="IntegrationContractTests+ApiV1IntegrationPutEndpoint+WhenReturnsStatusCodeBadRequest.ProblemDetailsContentIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MzM5OTk5LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMHxTQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.2234263" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected HttpStatusCode to be HttpStatusCode.BadRequest {value: 400}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected HttpStatusCode to be HttpStatusCode.BadRequest {value: 400}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.HttpResponseMessageAssertions`1.HaveStatusCode(HttpStatusCode expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationContractTests.ApiV1IntegrationPutEndpoint.WhenReturnsStatusCodeBadRequest.ProblemDetailsContentIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Integration\Integration.Contract.Tests.cs:line 896
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationContractTests+ApiV1IntegrationPutEndpoint+WhenReturnsStatusCodeNotFound.ProblemDetailsContentIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration" method="IntegrationContractTests+ApiV1IntegrationPutEndpoint+WhenReturnsStatusCodeNotFound.ProblemDetailsContentIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNzIyMTcxOTk5LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIkZBIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vc3Vic2NyaXB0aW9ucyI6W10sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.2105737" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected HttpStatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected HttpStatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.HttpResponseMessageAssertions`1.HaveStatusCode(HttpStatusCode expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationContractTests.ApiV1IntegrationPutEndpoint.WhenReturnsStatusCodeNotFound.ProblemDetailsContentIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Integration\Integration.Contract.Tests.cs:line 925
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationContractTests+ApiV1IntegrationPermissionsGetEndpoint+WhenReturnsStatusCodeUnauthorized.ProblemDetailsContentIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration" method="IntegrationContractTests+ApiV1IntegrationPermissionsGetEndpoint+WhenReturnsStatusCodeUnauthorized.ProblemDetailsContentIsReturned" time="0.1562590" result="Fail">
        <failure>
          <message>System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationContractTests+ApiV1IntegrationPermissionsGetEndpoint+WhenReturnsStatusCodeForbidden.ProblemDetailsContentIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration" method="IntegrationContractTests+ApiV1IntegrationPermissionsGetEndpoint+WhenReturnsStatusCodeForbidden.ProblemDetailsContentIsReturned" time="0.1181151" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationContractTests.ApiV1IntegrationPermissionsGetEndpoint.WhenReturnsStatusCodeForbidden.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Integration\Integration.Contract.Tests.cs:line 1003
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationContractTests.ApiV1IntegrationPermissionsGetEndpoint.WhenReturnsStatusCodeForbidden.ProblemDetailsContentIsReturned() in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Integration\Integration.Contract.Tests.cs:line 978
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationContractTests+ApiV1IntegrationPermissionsGetEndpoint+WhenReturnsStatusCodeNotFound.ProblemDetailsContentIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration" method="IntegrationContractTests+ApiV1IntegrationPermissionsGetEndpoint+WhenReturnsStatusCodeNotFound.ProblemDetailsContentIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjk2OTQzMTk5LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMHxTQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.2356137" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected HttpStatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected HttpStatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.HttpResponseMessageAssertions`1.HaveStatusCode(HttpStatusCode expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationContractTests.ApiV1IntegrationPermissionsGetEndpoint.WhenReturnsStatusCodeNotFound.ProblemDetailsContentIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Integration\Integration.Contract.Tests.cs:line 1051
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationContractTests+ApiV1IntegrationPermissionsPutEndpoint+WhenReturnsStatusCodeUnauthorized.ProblemDetailsContentIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration" method="IntegrationContractTests+ApiV1IntegrationPermissionsPutEndpoint+WhenReturnsStatusCodeUnauthorized.ProblemDetailsContentIsReturned" time="0.1520973" result="Fail">
        <failure>
          <message>System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationContractTests+ApiV1IntegrationPermissionsPutEndpoint+WhenReturnsStatusCodeForbidden.ProblemDetailsContentIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration" method="IntegrationContractTests+ApiV1IntegrationPermissionsPutEndpoint+WhenReturnsStatusCodeForbidden.ProblemDetailsContentIsReturned" time="0.1505642" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationContractTests.ApiV1IntegrationPermissionsPutEndpoint.WhenReturnsStatusCodeForbidden.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Integration\Integration.Contract.Tests.cs:line 1134
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationContractTests.ApiV1IntegrationPermissionsPutEndpoint.WhenReturnsStatusCodeForbidden.ProblemDetailsContentIsReturned() in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Integration\Integration.Contract.Tests.cs:line 1111
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationContractTests+ApiV1IntegrationPermissionsPutEndpoint+WhenReturnsStatusCodeBadRequest.ProblemDetailsContentIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration" method="IntegrationContractTests+ApiV1IntegrationPermissionsPutEndpoint+WhenReturnsStatusCodeBadRequest.ProblemDetailsContentIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjkxNTAwMDAwLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMHxTQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.2115586" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected HttpStatusCode to be HttpStatusCode.BadRequest {value: 400}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected HttpStatusCode to be HttpStatusCode.BadRequest {value: 400}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.HttpResponseMessageAssertions`1.HaveStatusCode(HttpStatusCode expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationContractTests.ApiV1IntegrationPermissionsPutEndpoint.WhenReturnsStatusCodeBadRequest.ProblemDetailsContentIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Integration\Integration.Contract.Tests.cs:line 1184
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationContractTests+ApiV1IntegrationPermissionsPutEndpoint+WhenReturnsStatusCodeNotFound.ProblemDetailsContentIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration" method="IntegrationContractTests+ApiV1IntegrationPermissionsPutEndpoint+WhenReturnsStatusCodeNotFound.ProblemDetailsContentIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNzE3ODUyMDAwLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIkZBIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vc3Vic2NyaXB0aW9ucyI6W10sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.2101392" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected HttpStatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected HttpStatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.HttpResponseMessageAssertions`1.HaveStatusCode(HttpStatusCode expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationContractTests.ApiV1IntegrationPermissionsPutEndpoint.WhenReturnsStatusCodeNotFound.ProblemDetailsContentIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Integration\Integration.Contract.Tests.cs:line 1213
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationContractTests+ApiV1IntegrationsAvailablePermissionsGetEndpoint+WhenReturnsStatusCodeUnauthorized.ProblemDetailsContentIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration" method="IntegrationContractTests+ApiV1IntegrationsAvailablePermissionsGetEndpoint+WhenReturnsStatusCodeUnauthorized.ProblemDetailsContentIsReturned" time="0.1878685" result="Fail">
        <failure>
          <message>System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationContractTests+ApiV1IntegrationsAvailablePermissionsGetEndpoint+WhenReturnsStatusCodeForbidden.ProblemDetailsContentIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration" method="IntegrationContractTests+ApiV1IntegrationsAvailablePermissionsGetEndpoint+WhenReturnsStatusCodeForbidden.ProblemDetailsContentIsReturned" time="0.2615228" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected HttpStatusCode to be HttpStatusCode.Forbidden {value: 403}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected HttpStatusCode to be HttpStatusCode.Forbidden {value: 403}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.HttpResponseMessageAssertions`1.HaveStatusCode(HttpStatusCode expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationContractTests.ApiV1IntegrationsAvailablePermissionsGetEndpoint.WhenReturnsStatusCodeForbidden.ProblemDetailsContentIsReturned() in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Integration\Integration.Contract.Tests.cs:line 1278
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationContractTests+ApiV1IntegrationsAvailablePermissionsGetEndpoint+WhenReturnsStatusCodeInternalServerError.ProblemDetailsContentIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration" method="IntegrationContractTests+ApiV1IntegrationsAvailablePermissionsGetEndpoint+WhenReturnsStatusCodeInternalServerError.ProblemDetailsContentIsReturned" time="0.1983476" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected HttpStatusCode to be HttpStatusCode.InternalServerError {value: 500}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected HttpStatusCode to be HttpStatusCode.InternalServerError {value: 500}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.HttpResponseMessageAssertions`1.HaveStatusCode(HttpStatusCode expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationContractTests.ApiV1IntegrationsAvailablePermissionsGetEndpoint.WhenReturnsStatusCodeInternalServerError.ProblemDetailsContentIsReturned() in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Integration\Integration.Contract.Tests.cs:line 1309
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When integration is not found by SA, FA, EA. Returns 404NotFound." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration" method="IntegrationIntegrationTests+WhenFetchingASingleIntegration+WhenIntegrationIsNotFound.TheNotFoundStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MjAxLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIkZBIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vc3Vic2NyaXB0aW9ucyI6W10sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.2124073" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected result.StatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected result.StatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.EnumAssertions`2.Be(TEnum expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationIntegrationTests.WhenFetchingASingleIntegration.WhenIntegrationIsNotFound.TheNotFoundStatusCodeIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Integration\Integration.Integration.Tests.cs:line 117
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When integration is not found by SA, FA, EA. Returns 404NotFound." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration" method="IntegrationIntegrationTests+WhenFetchingASingleIntegration+WhenIntegrationIsNotFound.TheNotFoundStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MjAxLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMHxTQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.2109688" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected result.StatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected result.StatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.EnumAssertions`2.Be(TEnum expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationIntegrationTests.WhenFetchingASingleIntegration.WhenIntegrationIsNotFound.TheNotFoundStatusCodeIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Integration\Integration.Integration.Tests.cs:line 117
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When integration is not found by SA, FA, EA. Returns 404NotFound." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration" method="IntegrationIntegrationTests+WhenFetchingASingleIntegration+WhenIntegrationIsNotFound.TheNotFoundStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MjAxLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbImY2ZDE0OGUzLTEwZWMtNDViZS05ZTlhLTNhNGQyOGU5YjIzNXxFQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMTFjNmMxZmItZTYyOC00ZTYzLTgyYjEtYjQ2YTZkNDNiNTQ5Il0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.2263350" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected result.StatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected result.StatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.EnumAssertions`2.Be(TEnum expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationIntegrationTests.WhenFetchingASingleIntegration.WhenIntegrationIsNotFound.TheNotFoundStatusCodeIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Integration\Integration.Integration.Tests.cs:line 117
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When integration is not found by SA, FA, EA. Returns 404NotFound." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration" method="IntegrationIntegrationTests+WhenRotatingAnIntegrationsClientSecret+WhenIntegrationIsNotFound.TheNotFoundStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MjAyLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIkZBIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vc3Vic2NyaXB0aW9ucyI6W10sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.2550592" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected result.StatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected result.StatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.EnumAssertions`2.Be(TEnum expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationIntegrationTests.WhenRotatingAnIntegrationsClientSecret.WhenIntegrationIsNotFound.TheNotFoundStatusCodeIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Integration\Integration.Integration.Tests.cs:line 344
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When integration is not found by SA, FA, EA. Returns 404NotFound." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration" method="IntegrationIntegrationTests+WhenRotatingAnIntegrationsClientSecret+WhenIntegrationIsNotFound.TheNotFoundStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MjAyLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMHxTQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.1926048" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected result.StatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected result.StatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.EnumAssertions`2.Be(TEnum expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationIntegrationTests.WhenRotatingAnIntegrationsClientSecret.WhenIntegrationIsNotFound.TheNotFoundStatusCodeIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Integration\Integration.Integration.Tests.cs:line 344
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When integration is not found by SA, FA, EA. Returns 404NotFound." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration" method="IntegrationIntegrationTests+WhenRotatingAnIntegrationsClientSecret+WhenIntegrationIsNotFound.TheNotFoundStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MjAyLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbImY2ZDE0OGUzLTEwZWMtNDViZS05ZTlhLTNhNGQyOGU5YjIzNXxFQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiNTdkMzMxYmYtMDI3My00Y2JmLWE0ZmItMjhkZjg3NmMyZjQ3Il0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.2187375" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected result.StatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected result.StatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.EnumAssertions`2.Be(TEnum expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationIntegrationTests.WhenRotatingAnIntegrationsClientSecret.WhenIntegrationIsNotFound.TheNotFoundStatusCodeIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Integration\Integration.Integration.Tests.cs:line 344
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When integration is not found by SA, FA, EA. Returns 404NotFound." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration" method="IntegrationIntegrationTests+WhenDeleteIntegration+WhenIntegrationIsNotFound.TheNotFoundStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MjAyLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIkZBIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vc3Vic2NyaXB0aW9ucyI6W10sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.1987340" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected result.StatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected result.StatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.EnumAssertions`2.Be(TEnum expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationIntegrationTests.WhenDeleteIntegration.WhenIntegrationIsNotFound.TheNotFoundStatusCodeIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Integration\Integration.Integration.Tests.cs:line 571
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When integration is not found by SA, FA, EA. Returns 404NotFound." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration" method="IntegrationIntegrationTests+WhenDeleteIntegration+WhenIntegrationIsNotFound.TheNotFoundStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MjAyLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMHxTQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.2175188" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected result.StatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected result.StatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.EnumAssertions`2.Be(TEnum expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationIntegrationTests.WhenDeleteIntegration.WhenIntegrationIsNotFound.TheNotFoundStatusCodeIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Integration\Integration.Integration.Tests.cs:line 571
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When integration is not found by SA, FA, EA. Returns 404NotFound." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration" method="IntegrationIntegrationTests+WhenDeleteIntegration+WhenIntegrationIsNotFound.TheNotFoundStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MjAyLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbImY2ZDE0OGUzLTEwZWMtNDViZS05ZTlhLTNhNGQyOGU5YjIzNXxFQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiN2FhZjRiOGMtMjA0YS00OWMxLWIwZDMtOTU2ODBiMGJlZjkyIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.1923388" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected result.StatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected result.StatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.EnumAssertions`2.Be(TEnum expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationIntegrationTests.WhenDeleteIntegration.WhenIntegrationIsNotFound.TheNotFoundStatusCodeIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Integration\Integration.Integration.Tests.cs:line 571
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When no integrations are found, a 404 is returned." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration" method="IntegrationIntegrationTests+WhenFetchingIntegrationsOfAnEnvironment+WhenNoIntegrationsAreFound.TheNotFoundStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MjAzLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIkZBIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vc3Vic2NyaXB0aW9ucyI6W10sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.2019807" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected result.StatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected result.StatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.EnumAssertions`2.Be(TEnum expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationIntegrationTests.WhenFetchingIntegrationsOfAnEnvironment.WhenNoIntegrationsAreFound.TheNotFoundStatusCodeIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Integration\Integration.Integration.Tests.cs:line 792
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When no integrations are found, a 404 is returned." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration" method="IntegrationIntegrationTests+WhenFetchingIntegrationsOfAnEnvironment+WhenNoIntegrationsAreFound.TheNotFoundStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MjAzLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMHxTQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.2280331" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected result.StatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected result.StatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.EnumAssertions`2.Be(TEnum expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationIntegrationTests.WhenFetchingIntegrationsOfAnEnvironment.WhenNoIntegrationsAreFound.TheNotFoundStatusCodeIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Integration\Integration.Integration.Tests.cs:line 792
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When no integrations are found, a 404 is returned." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration" method="IntegrationIntegrationTests+WhenFetchingIntegrationsOfAnEnvironment+WhenNoIntegrationsAreFound.TheNotFoundStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MjAzLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbImY2ZDE0OGUzLTEwZWMtNDViZS05ZTlhLTNhNGQyOGU5YjIzNXxFQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiYmU0ZDcwOGItY2ExMi00MWFiLWI4MjItMzQ3NDMxMDg1MjMzIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.1994669" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected result.StatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected result.StatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.EnumAssertions`2.Be(TEnum expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationIntegrationTests.WhenFetchingIntegrationsOfAnEnvironment.WhenNoIntegrationsAreFound.TheNotFoundStatusCodeIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Integration\Integration.Integration.Tests.cs:line 792
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When integration environment is created by SA, EA, FA. Returns 200OK." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration" method="IntegrationIntegrationTests+WhenCreatingSingleIntegration+WhenEnvironmentExists.TheOkStatusCodeIsReturnedWithIntegration(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MjAzLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIkZBIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vc3Vic2NyaXB0aW9ucyI6W10sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.1509452" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationIntegrationTests.WhenCreatingSingleIntegration.WhenEnvironmentExists.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Integration\Integration.Integration.Tests.cs:line 1069
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationIntegrationTests.WhenCreatingSingleIntegration.WhenEnvironmentExists.TheOkStatusCodeIsReturnedWithIntegration(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Integration\Integration.Integration.Tests.cs:line 1040
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When integration environment is created by SA, EA, FA. Returns 200OK." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration" method="IntegrationIntegrationTests+WhenCreatingSingleIntegration+WhenEnvironmentExists.TheOkStatusCodeIsReturnedWithIntegration(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MjAzLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbImVkODhiMTQyLTQ2M2EtNDY0OC05OTMyLTI1ZDE2NTc2ZGJmNXxTQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiZWQ4OGIxNDItNDYzYS00NjQ4LTk5MzItMjVkMTY1NzZkYmY1Il0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.1364219" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationIntegrationTests.WhenCreatingSingleIntegration.WhenEnvironmentExists.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Integration\Integration.Integration.Tests.cs:line 1069
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationIntegrationTests.WhenCreatingSingleIntegration.WhenEnvironmentExists.TheOkStatusCodeIsReturnedWithIntegration(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Integration\Integration.Integration.Tests.cs:line 1040
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When integration environment is created by SA, EA, FA. Returns 200OK." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration" method="IntegrationIntegrationTests+WhenCreatingSingleIntegration+WhenEnvironmentExists.TheOkStatusCodeIsReturnedWithIntegration(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MjAzLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbImY2ZDE0OGUzLTEwZWMtNDViZS05ZTlhLTNhNGQyOGU5YjIzNXxFQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiZWQ4OGIxNDItNDYzYS00NjQ4LTk5MzItMjVkMTY1NzZkYmY1Il0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.1412264" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationIntegrationTests.WhenCreatingSingleIntegration.WhenEnvironmentExists.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Integration\Integration.Integration.Tests.cs:line 1069
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationIntegrationTests.WhenCreatingSingleIntegration.WhenEnvironmentExists.TheOkStatusCodeIsReturnedWithIntegration(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Integration\Integration.Integration.Tests.cs:line 1040
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When integration environment is not found. Returns 404NotFound." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration" method="IntegrationIntegrationTests+WhenCreatingSingleIntegration+WhenEnvironmentDoesNotExist.TheNotFoundStatusCodeIsReturned" time="0.2497027" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected HttpStatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected HttpStatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.HttpResponseMessageAssertions`1.HaveStatusCode(HttpStatusCode expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationIntegrationTests.WhenCreatingSingleIntegration.WhenEnvironmentDoesNotExist.TheNotFoundStatusCodeIsReturned() in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Integration\Integration.Integration.Tests.cs:line 1093
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When integration environment is created by SA, EA, FA. Returns 200OK." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration" method="IntegrationIntegrationTests+WhenUpdatingSingleIntegration+WhenEnvironmentExists.TheOkStatusCodeIsReturnedWithIntegration(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MjA0LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIkZBIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vc3Vic2NyaXB0aW9ucyI6W10sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.1941604" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationIntegrationTests.WhenUpdatingSingleIntegration.WhenEnvironmentExists.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Integration\Integration.Integration.Tests.cs:line 1196
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationIntegrationTests.WhenUpdatingSingleIntegration.WhenEnvironmentExists.TheOkStatusCodeIsReturnedWithIntegration(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Integration\Integration.Integration.Tests.cs:line 1167
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When integration environment is created by SA, EA, FA. Returns 200OK." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration" method="IntegrationIntegrationTests+WhenUpdatingSingleIntegration+WhenEnvironmentExists.TheOkStatusCodeIsReturnedWithIntegration(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MjA0LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbImFiNmVlZmM1LWNjOGYtNDQ0ZC1iNTQwLTMxY2UxOTQ2N2JiYnxTQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiYWI2ZWVmYzUtY2M4Zi00NDRkLWI1NDAtMzFjZTE5NDY3YmJiIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.1908657" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationIntegrationTests.WhenUpdatingSingleIntegration.WhenEnvironmentExists.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Integration\Integration.Integration.Tests.cs:line 1196
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationIntegrationTests.WhenUpdatingSingleIntegration.WhenEnvironmentExists.TheOkStatusCodeIsReturnedWithIntegration(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Integration\Integration.Integration.Tests.cs:line 1167
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When integration environment is created by SA, EA, FA. Returns 200OK." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration" method="IntegrationIntegrationTests+WhenUpdatingSingleIntegration+WhenEnvironmentExists.TheOkStatusCodeIsReturnedWithIntegration(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MjA0LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbImY2ZDE0OGUzLTEwZWMtNDViZS05ZTlhLTNhNGQyOGU5YjIzNXxFQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiYWI2ZWVmYzUtY2M4Zi00NDRkLWI1NDAtMzFjZTE5NDY3YmJiIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.1403095" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationIntegrationTests.WhenUpdatingSingleIntegration.WhenEnvironmentExists.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Integration\Integration.Integration.Tests.cs:line 1196
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationIntegrationTests.WhenUpdatingSingleIntegration.WhenEnvironmentExists.TheOkStatusCodeIsReturnedWithIntegration(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Integration\Integration.Integration.Tests.cs:line 1167
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When integration environment is not found. Returns 404NotFound." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration" method="IntegrationIntegrationTests+WhenUpdatingSingleIntegration+WhenEnvironmentDoesNotExist.TheNotFoundStatusCodeIsReturned" time="0.2220513" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected HttpStatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected HttpStatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.HttpResponseMessageAssertions`1.HaveStatusCode(HttpStatusCode expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationIntegrationTests.WhenUpdatingSingleIntegration.WhenEnvironmentDoesNotExist.TheNotFoundStatusCodeIsReturned() in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Integration\Integration.Integration.Tests.cs:line 1227
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When integration is not found by SA, FA, EA. Returns 404NotFound." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration" method="IntegrationIntegrationTests+WhenFetchingIntegrationPermissions+WhenIntegrationIsNotFound.TheNotFoundStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MjA1LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIkZBIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vc3Vic2NyaXB0aW9ucyI6W10sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.2492704" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected result.StatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected result.StatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.EnumAssertions`2.Be(TEnum expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationIntegrationTests.WhenFetchingIntegrationPermissions.WhenIntegrationIsNotFound.TheNotFoundStatusCodeIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Integration\Integration.Integration.Tests.cs:line 1305
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When integration is not found by SA, FA, EA. Returns 404NotFound." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration" method="IntegrationIntegrationTests+WhenFetchingIntegrationPermissions+WhenIntegrationIsNotFound.TheNotFoundStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MjA1LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMHxTQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.7494347" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected result.StatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected result.StatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.EnumAssertions`2.Be(TEnum expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationIntegrationTests.WhenFetchingIntegrationPermissions.WhenIntegrationIsNotFound.TheNotFoundStatusCodeIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Integration\Integration.Integration.Tests.cs:line 1305
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When integration is not found by SA, FA, EA. Returns 404NotFound." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration" method="IntegrationIntegrationTests+WhenFetchingIntegrationPermissions+WhenIntegrationIsNotFound.TheNotFoundStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MjA1LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbImY2ZDE0OGUzLTEwZWMtNDViZS05ZTlhLTNhNGQyOGU5YjIzNXxFQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiOGQ0NmJmNjgtZDk3Mi00MThjLWIwNDctM2Y2NTIzZjY4ZTY4Il0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.2014829" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected result.StatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected result.StatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.EnumAssertions`2.Be(TEnum expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationIntegrationTests.WhenFetchingIntegrationPermissions.WhenIntegrationIsNotFound.TheNotFoundStatusCodeIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Integration\Integration.Integration.Tests.cs:line 1305
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When integration is not found by SA, FA, EA. Returns 404NotFound." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration" method="IntegrationIntegrationTests+WhenUpdatingIntegrationPermissions+WhenIntegrationIsNotFound.TheNotFoundStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MjA2LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIkZBIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vc3Vic2NyaXB0aW9ucyI6W10sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.2102621" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected result.StatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected result.StatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.EnumAssertions`2.Be(TEnum expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationIntegrationTests.WhenUpdatingIntegrationPermissions.WhenIntegrationIsNotFound.TheNotFoundStatusCodeIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Integration\Integration.Integration.Tests.cs:line 1588
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When integration is not found by SA, FA, EA. Returns 404NotFound." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration" method="IntegrationIntegrationTests+WhenUpdatingIntegrationPermissions+WhenIntegrationIsNotFound.TheNotFoundStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MjA2LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMHxTQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.2266281" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected result.StatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected result.StatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.EnumAssertions`2.Be(TEnum expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationIntegrationTests.WhenUpdatingIntegrationPermissions.WhenIntegrationIsNotFound.TheNotFoundStatusCodeIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Integration\Integration.Integration.Tests.cs:line 1588
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When integration is not found by SA, FA, EA. Returns 404NotFound." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration" method="IntegrationIntegrationTests+WhenUpdatingIntegrationPermissions+WhenIntegrationIsNotFound.TheNotFoundStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MjA2LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbImY2ZDE0OGUzLTEwZWMtNDViZS05ZTlhLTNhNGQyOGU5YjIzNXxFQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiNmFlMDI5MjktNDkyYi00MDAzLThlMzItYmQ2ZDBhNWQxZDc1Il0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.2191648" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected result.StatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected result.StatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.EnumAssertions`2.Be(TEnum expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationIntegrationTests.WhenUpdatingIntegrationPermissions.WhenIntegrationIsNotFound.TheNotFoundStatusCodeIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Integration\Integration.Integration.Tests.cs:line 1588
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When api is found. Adds `Cache-Control` header." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration" method="IntegrationIntegrationTests+WhenGettingAvailablePermissions+WhenApiExists.TheCacheControlIsAdded" time="0.1461652" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'Kwality.UVault.APIs.Managers.ApiManager`2[CHILI.GraFx.Platform.API.Modules.Integration.Internal.Models.Auth0Api,Kwality.UVault.Auth0.Keys.StringKey]' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'Kwality.UVault.APIs.Managers.ApiManager`2[CHILI.GraFx.Platform.API.Modules.Integration.Internal.Models.Auth0Api,Kwality.UVault.Auth0.Keys.StringKey]' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationIntegrationTests.WhenGettingAvailablePermissions.WhenApiExists.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Integration\Integration.Integration.Tests.cs:line 1897
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationIntegrationTests.WhenGettingAvailablePermissions.WhenApiExists.TheCacheControlIsAdded() in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Integration\Integration.Integration.Tests.cs:line 1879
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When api is found. Returns 200Ok." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration" method="IntegrationIntegrationTests+WhenGettingAvailablePermissions+WhenApiExists.TheOkStatusCodeIsReturned" time="0.1415532" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'Kwality.UVault.APIs.Managers.ApiManager`2[CHILI.GraFx.Platform.API.Modules.Integration.Internal.Models.Auth0Api,Kwality.UVault.Auth0.Keys.StringKey]' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'Kwality.UVault.APIs.Managers.ApiManager`2[CHILI.GraFx.Platform.API.Modules.Integration.Internal.Models.Auth0Api,Kwality.UVault.Auth0.Keys.StringKey]' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationIntegrationTests.WhenGettingAvailablePermissions.WhenApiExists.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Integration\Integration.Integration.Tests.cs:line 1897
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationIntegrationTests.WhenGettingAvailablePermissions.WhenApiExists.TheOkStatusCodeIsReturned() in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Integration\Integration.Integration.Tests.cs:line 1852
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When integration is not found by SA, FA, EA. Returns 404NotFound." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration" method="IntegrationIntegrationTests+WhenFetchingASingleIntegration+WhenIntegrationIsFound+WhenIntegrationEnvironmentDoesNotExist.TheNotFoundStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MzU4LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIkZBIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vc3Vic2NyaXB0aW9ucyI6W10sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.4031622" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected result.StatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected result.StatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.EnumAssertions`2.Be(TEnum expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationIntegrationTests.WhenFetchingASingleIntegration.WhenIntegrationIsFound.WhenIntegrationEnvironmentDoesNotExist.TheNotFoundStatusCodeIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Integration\Integration.Integration.Tests.cs:line 265
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When integration is not found by SA, FA, EA. Returns 404NotFound." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration" method="IntegrationIntegrationTests+WhenRotatingAnIntegrationsClientSecret+WhenIntegrationIsFound+WhenIntegrationEnvironmentDoesNotExist.TheNotFoundStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MzU4LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIkZBIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vc3Vic2NyaXB0aW9ucyI6W10sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.2328118" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected result.StatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected result.StatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.EnumAssertions`2.Be(TEnum expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationIntegrationTests.WhenRotatingAnIntegrationsClientSecret.WhenIntegrationIsFound.WhenIntegrationEnvironmentDoesNotExist.TheNotFoundStatusCodeIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Integration\Integration.Integration.Tests.cs:line 492
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When integration is not found by SA, FA, EA. Returns 404NotFound." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration" method="IntegrationIntegrationTests+WhenDeleteIntegration+WhenIntegrationIsFound+WhenIntegrationEnvironmentDoesNotExist.TheNotFoundStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MzU5LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIkZBIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vc3Vic2NyaXB0aW9ucyI6W10sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.2639843" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected result.StatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected result.StatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.EnumAssertions`2.Be(TEnum expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationIntegrationTests.WhenDeleteIntegration.WhenIntegrationIsFound.WhenIntegrationEnvironmentDoesNotExist.TheNotFoundStatusCodeIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Integration\Integration.Integration.Tests.cs:line 713
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When integration is not found by SA, FA, EA. Returns 404NotFound." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration" method="IntegrationIntegrationTests+WhenFetchingIntegrationPermissions+WhenIntegrationIsFound+WhenIntegrationEnvironmentDoesNotExist.TheNotFoundStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MzU5LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIkZBIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vc3Vic2NyaXB0aW9ucyI6W10sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.2235701" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected result.StatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected result.StatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.EnumAssertions`2.Be(TEnum expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationIntegrationTests.WhenFetchingIntegrationPermissions.WhenIntegrationIsFound.WhenIntegrationEnvironmentDoesNotExist.TheNotFoundStatusCodeIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Integration\Integration.Integration.Tests.cs:line 1503
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When integration is not found. Returns 404NotFound." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration" method="IntegrationIntegrationTests+WhenUpdatingIntegrationPermissions+WhenIntegrationIsFound+WhenIntegrationEnvironmentDoesNotExist.TheNotFoundStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MzU5LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIkZBIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vc3Vic2NyaXB0aW9ucyI6W10sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.2561550" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected result.StatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected result.StatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.EnumAssertions`2.Be(TEnum expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationIntegrationTests.WhenUpdatingIntegrationPermissions.WhenIntegrationIsFound.WhenIntegrationEnvironmentDoesNotExist.TheNotFoundStatusCodeIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Integration\Integration.Integration.Tests.cs:line 1822
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When integration is returned to SA, FA, EA. Returns 404NotFound." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration" method="IntegrationIntegrationTests+WhenFetchingASingleIntegration+WhenIntegrationIsFound+WhenIntegrationEnvironmentExists+WhenIntegrationIsAccessible.TheOkStatusCodeIsReturnedWithIntegration(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3Mzg0LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIkZBIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vc3Vic2NyaXB0aW9ucyI6W10sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.1742871" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationIntegrationTests.WhenFetchingASingleIntegration.WhenIntegrationIsFound.WhenIntegrationEnvironmentExists.WhenIntegrationIsAccessible.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Integration\Integration.Integration.Tests.cs:line 176
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationIntegrationTests.WhenFetchingASingleIntegration.WhenIntegrationIsFound.WhenIntegrationEnvironmentExists.WhenIntegrationIsAccessible.TheOkStatusCodeIsReturnedWithIntegration(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Integration\Integration.Integration.Tests.cs:line 154
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When integration is returned to SA, FA, EA. Returns 404NotFound." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration" method="IntegrationIntegrationTests+WhenFetchingASingleIntegration+WhenIntegrationIsFound+WhenIntegrationEnvironmentExists+WhenIntegrationIsAccessible.TheOkStatusCodeIsReturnedWithIntegration(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3Mzg0LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjExYzZjMWZiLWU2MjgtNGU2My04MmIxLWI0NmE2ZDQzYjU0OXxTQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMTFjNmMxZmItZTYyOC00ZTYzLTgyYjEtYjQ2YTZkNDNiNTQ5Il0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.1775253" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationIntegrationTests.WhenFetchingASingleIntegration.WhenIntegrationIsFound.WhenIntegrationEnvironmentExists.WhenIntegrationIsAccessible.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Integration\Integration.Integration.Tests.cs:line 176
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationIntegrationTests.WhenFetchingASingleIntegration.WhenIntegrationIsFound.WhenIntegrationEnvironmentExists.WhenIntegrationIsAccessible.TheOkStatusCodeIsReturnedWithIntegration(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Integration\Integration.Integration.Tests.cs:line 154
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When integration is returned to SA, FA, EA. Returns 404NotFound." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration" method="IntegrationIntegrationTests+WhenFetchingASingleIntegration+WhenIntegrationIsFound+WhenIntegrationEnvironmentExists+WhenIntegrationIsAccessible.TheOkStatusCodeIsReturnedWithIntegration(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3Mzg0LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbImY2ZDE0OGUzLTEwZWMtNDViZS05ZTlhLTNhNGQyOGU5YjIzNXxFQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMTFjNmMxZmItZTYyOC00ZTYzLTgyYjEtYjQ2YTZkNDNiNTQ5Il0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.1755751" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationIntegrationTests.WhenFetchingASingleIntegration.WhenIntegrationIsFound.WhenIntegrationEnvironmentExists.WhenIntegrationIsAccessible.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Integration\Integration.Integration.Tests.cs:line 176
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationIntegrationTests.WhenFetchingASingleIntegration.WhenIntegrationIsFound.WhenIntegrationEnvironmentExists.WhenIntegrationIsAccessible.TheOkStatusCodeIsReturnedWithIntegration(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Integration\Integration.Integration.Tests.cs:line 154
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When token doesn't have required role. Returns 403Forbid." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration" method="IntegrationIntegrationTests+WhenFetchingASingleIntegration+WhenIntegrationIsFound+WhenIntegrationEnvironmentExists+WhenIntegrationIsNotAccessible.TheForbidStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3Mzg0LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbImY2ZDE0OGUzLTEwZWMtNDViZS05ZTlhLTNhNGQyOGU5YjIzNXxTVSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiYzQ5NWFkYmEtZGUzZC00ZmY0LTlkODAtNDgyYTM0OGM0MDE5Il0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.2226140" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationIntegrationTests.WhenFetchingASingleIntegration.WhenIntegrationIsFound.WhenIntegrationEnvironmentExists.WhenIntegrationIsNotAccessible.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Integration\Integration.Integration.Tests.cs:line 227
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationIntegrationTests.WhenFetchingASingleIntegration.WhenIntegrationIsFound.WhenIntegrationEnvironmentExists.WhenIntegrationIsNotAccessible.TheForbidStatusCodeIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Integration\Integration.Integration.Tests.cs:line 211
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When token doesn't have required role. Returns 403Forbid." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration" method="IntegrationIntegrationTests+WhenFetchingASingleIntegration+WhenIntegrationIsFound+WhenIntegrationEnvironmentExists+WhenIntegrationIsNotAccessible.TheForbidStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3Mzg0LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbImFhZjZjZjgxLWM5MDYtNDk4OS1iOTE3LTAwYWZmNDZhMTc4ZnxTQSIsImY2ZDE0OGUzLTEwZWMtNDViZS05ZTlhLTNhNGQyOGU5YjIzNXxTVSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiYWFmNmNmODEtYzkwNi00OTg5LWI5MTctMDBhZmY0NmExNzhmIiwiOTZlZTVkMzUtNmE5Zi00OWYxLTg3OWMtZDEwMzQ1NDY5ZjEyIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.2229458" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationIntegrationTests.WhenFetchingASingleIntegration.WhenIntegrationIsFound.WhenIntegrationEnvironmentExists.WhenIntegrationIsNotAccessible.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Integration\Integration.Integration.Tests.cs:line 227
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationIntegrationTests.WhenFetchingASingleIntegration.WhenIntegrationIsFound.WhenIntegrationEnvironmentExists.WhenIntegrationIsNotAccessible.TheForbidStatusCodeIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Integration\Integration.Integration.Tests.cs:line 211
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When integration is returned to SA, FA, EA. Returns 404NotFound." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration" method="IntegrationIntegrationTests+WhenRotatingAnIntegrationsClientSecret+WhenIntegrationIsFound+WhenIntegrationEnvironmentExists+WhenIntegrationIsAccessible.TheOkStatusCodeIsReturnedWithIntegration(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3Mzg0LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIkZBIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vc3Vic2NyaXB0aW9ucyI6W10sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.2996558" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationIntegrationTests.WhenRotatingAnIntegrationsClientSecret.WhenIntegrationIsFound.WhenIntegrationEnvironmentExists.WhenIntegrationIsAccessible.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Integration\Integration.Integration.Tests.cs:line 403
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationIntegrationTests.WhenRotatingAnIntegrationsClientSecret.WhenIntegrationIsFound.WhenIntegrationEnvironmentExists.WhenIntegrationIsAccessible.TheOkStatusCodeIsReturnedWithIntegration(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Integration\Integration.Integration.Tests.cs:line 381
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When integration is returned to SA, FA, EA. Returns 404NotFound." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration" method="IntegrationIntegrationTests+WhenRotatingAnIntegrationsClientSecret+WhenIntegrationIsFound+WhenIntegrationEnvironmentExists+WhenIntegrationIsAccessible.TheOkStatusCodeIsReturnedWithIntegration(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3Mzg0LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjU3ZDMzMWJmLTAyNzMtNGNiZi1hNGZiLTI4ZGY4NzZjMmY0N3xTQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiNTdkMzMxYmYtMDI3My00Y2JmLWE0ZmItMjhkZjg3NmMyZjQ3Il0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.1974981" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationIntegrationTests.WhenRotatingAnIntegrationsClientSecret.WhenIntegrationIsFound.WhenIntegrationEnvironmentExists.WhenIntegrationIsAccessible.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Integration\Integration.Integration.Tests.cs:line 403
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationIntegrationTests.WhenRotatingAnIntegrationsClientSecret.WhenIntegrationIsFound.WhenIntegrationEnvironmentExists.WhenIntegrationIsAccessible.TheOkStatusCodeIsReturnedWithIntegration(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Integration\Integration.Integration.Tests.cs:line 381
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When integration is returned to SA, FA, EA. Returns 404NotFound." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration" method="IntegrationIntegrationTests+WhenRotatingAnIntegrationsClientSecret+WhenIntegrationIsFound+WhenIntegrationEnvironmentExists+WhenIntegrationIsAccessible.TheOkStatusCodeIsReturnedWithIntegration(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3Mzg0LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbImY2ZDE0OGUzLTEwZWMtNDViZS05ZTlhLTNhNGQyOGU5YjIzNXxFQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiNTdkMzMxYmYtMDI3My00Y2JmLWE0ZmItMjhkZjg3NmMyZjQ3Il0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.2433452" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationIntegrationTests.WhenRotatingAnIntegrationsClientSecret.WhenIntegrationIsFound.WhenIntegrationEnvironmentExists.WhenIntegrationIsAccessible.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Integration\Integration.Integration.Tests.cs:line 403
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationIntegrationTests.WhenRotatingAnIntegrationsClientSecret.WhenIntegrationIsFound.WhenIntegrationEnvironmentExists.WhenIntegrationIsAccessible.TheOkStatusCodeIsReturnedWithIntegration(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Integration\Integration.Integration.Tests.cs:line 381
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When token doesn't have required role. Returns 403Forbid." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration" method="IntegrationIntegrationTests+WhenRotatingAnIntegrationsClientSecret+WhenIntegrationIsFound+WhenIntegrationEnvironmentExists+WhenIntegrationIsNotAccessible.TheForbidStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3Mzg1LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbImY2ZDE0OGUzLTEwZWMtNDViZS05ZTlhLTNhNGQyOGU5YjIzNXxTVSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMTZjNDYzODEtMmIwNC00Yjc4LTlmNDktYzZkZDBlZTgzYzMxIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.2200049" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationIntegrationTests.WhenRotatingAnIntegrationsClientSecret.WhenIntegrationIsFound.WhenIntegrationEnvironmentExists.WhenIntegrationIsNotAccessible.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Integration\Integration.Integration.Tests.cs:line 454
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationIntegrationTests.WhenRotatingAnIntegrationsClientSecret.WhenIntegrationIsFound.WhenIntegrationEnvironmentExists.WhenIntegrationIsNotAccessible.TheForbidStatusCodeIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Integration\Integration.Integration.Tests.cs:line 438
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When token doesn't have required role. Returns 403Forbid." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration" method="IntegrationIntegrationTests+WhenRotatingAnIntegrationsClientSecret+WhenIntegrationIsFound+WhenIntegrationEnvironmentExists+WhenIntegrationIsNotAccessible.TheForbidStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3Mzg1LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjZhYjUwMDBiLTdmYzItNDJkNy1hOThjLWI0YmVkZmM4MTk3NHxTQSIsImY2ZDE0OGUzLTEwZWMtNDViZS05ZTlhLTNhNGQyOGU5YjIzNXxTVSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiNmFiNTAwMGItN2ZjMi00MmQ3LWE5OGMtYjRiZWRmYzgxOTc0IiwiZDUwYzRkMWMtZDQyZS00YWNmLTlmZGQtNzQxMDAzNjc2YTBhIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.2193282" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationIntegrationTests.WhenRotatingAnIntegrationsClientSecret.WhenIntegrationIsFound.WhenIntegrationEnvironmentExists.WhenIntegrationIsNotAccessible.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Integration\Integration.Integration.Tests.cs:line 454
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationIntegrationTests.WhenRotatingAnIntegrationsClientSecret.WhenIntegrationIsFound.WhenIntegrationEnvironmentExists.WhenIntegrationIsNotAccessible.TheForbidStatusCodeIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Integration\Integration.Integration.Tests.cs:line 438
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When integration is returned to SA, FA, EA. Returns 404NotFound." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration" method="IntegrationIntegrationTests+WhenDeleteIntegration+WhenIntegrationIsFound+WhenIntegrationEnvironmentExists+WhenIntegrationIsAccessible.TheOkStatusCodeIsReturnedWithIntegration(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3Mzg2LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIkZBIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vc3Vic2NyaXB0aW9ucyI6W10sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.2491763" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationIntegrationTests.WhenDeleteIntegration.WhenIntegrationIsFound.WhenIntegrationEnvironmentExists.WhenIntegrationIsAccessible.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Integration\Integration.Integration.Tests.cs:line 624
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationIntegrationTests.WhenDeleteIntegration.WhenIntegrationIsFound.WhenIntegrationEnvironmentExists.WhenIntegrationIsAccessible.TheOkStatusCodeIsReturnedWithIntegration(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Integration\Integration.Integration.Tests.cs:line 608
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When integration is returned to SA, FA, EA. Returns 404NotFound." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration" method="IntegrationIntegrationTests+WhenDeleteIntegration+WhenIntegrationIsFound+WhenIntegrationEnvironmentExists+WhenIntegrationIsAccessible.TheOkStatusCodeIsReturnedWithIntegration(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3Mzg2LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjdhYWY0YjhjLTIwNGEtNDljMS1iMGQzLTk1NjgwYjBiZWY5MnxTQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiN2FhZjRiOGMtMjA0YS00OWMxLWIwZDMtOTU2ODBiMGJlZjkyIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.3028862" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationIntegrationTests.WhenDeleteIntegration.WhenIntegrationIsFound.WhenIntegrationEnvironmentExists.WhenIntegrationIsAccessible.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Integration\Integration.Integration.Tests.cs:line 624
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationIntegrationTests.WhenDeleteIntegration.WhenIntegrationIsFound.WhenIntegrationEnvironmentExists.WhenIntegrationIsAccessible.TheOkStatusCodeIsReturnedWithIntegration(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Integration\Integration.Integration.Tests.cs:line 608
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When integration is returned to SA, FA, EA. Returns 404NotFound." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration" method="IntegrationIntegrationTests+WhenDeleteIntegration+WhenIntegrationIsFound+WhenIntegrationEnvironmentExists+WhenIntegrationIsAccessible.TheOkStatusCodeIsReturnedWithIntegration(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3Mzg2LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbImY2ZDE0OGUzLTEwZWMtNDViZS05ZTlhLTNhNGQyOGU5YjIzNXxFQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiN2FhZjRiOGMtMjA0YS00OWMxLWIwZDMtOTU2ODBiMGJlZjkyIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.2802660" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationIntegrationTests.WhenDeleteIntegration.WhenIntegrationIsFound.WhenIntegrationEnvironmentExists.WhenIntegrationIsAccessible.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Integration\Integration.Integration.Tests.cs:line 624
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationIntegrationTests.WhenDeleteIntegration.WhenIntegrationIsFound.WhenIntegrationEnvironmentExists.WhenIntegrationIsAccessible.TheOkStatusCodeIsReturnedWithIntegration(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Integration\Integration.Integration.Tests.cs:line 608
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When token doesn't have required role. Returns 403Forbid." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration" method="IntegrationIntegrationTests+WhenDeleteIntegration+WhenIntegrationIsFound+WhenIntegrationEnvironmentExists+WhenIntegrationIsNotAccessible.TheForbidStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3Mzg3LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbImY2ZDE0OGUzLTEwZWMtNDViZS05ZTlhLTNhNGQyOGU5YjIzNXxTVSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMjNjZGVmOTktZjU3ZS00MGU3LTgwNjctNTM1NWJkZjg2OGY2Il0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.2049861" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationIntegrationTests.WhenDeleteIntegration.WhenIntegrationIsFound.WhenIntegrationEnvironmentExists.WhenIntegrationIsNotAccessible.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Integration\Integration.Integration.Tests.cs:line 675
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationIntegrationTests.WhenDeleteIntegration.WhenIntegrationIsFound.WhenIntegrationEnvironmentExists.WhenIntegrationIsNotAccessible.TheForbidStatusCodeIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Integration\Integration.Integration.Tests.cs:line 659
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When token doesn't have required role. Returns 403Forbid." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration" method="IntegrationIntegrationTests+WhenDeleteIntegration+WhenIntegrationIsFound+WhenIntegrationEnvironmentExists+WhenIntegrationIsNotAccessible.TheForbidStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3Mzg3LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbImU3YmI2YzA5LTg1YWUtNDRjYi04ZWViLTY1MGU1MDAwYTA4Y3xTQSIsImY2ZDE0OGUzLTEwZWMtNDViZS05ZTlhLTNhNGQyOGU5YjIzNXxTVSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiZTdiYjZjMDktODVhZS00NGNiLThlZWItNjUwZTUwMDBhMDhjIiwiMDRkMDJlZDQtZDBlOS00ODViLWJmNmYtOWFmZGQ3MTkzNGQyIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.2351155" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationIntegrationTests.WhenDeleteIntegration.WhenIntegrationIsFound.WhenIntegrationEnvironmentExists.WhenIntegrationIsNotAccessible.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Integration\Integration.Integration.Tests.cs:line 675
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationIntegrationTests.WhenDeleteIntegration.WhenIntegrationIsFound.WhenIntegrationEnvironmentExists.WhenIntegrationIsNotAccessible.TheForbidStatusCodeIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Integration\Integration.Integration.Tests.cs:line 659
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="Returns the integrations for the environments." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration" method="IntegrationIntegrationTests+WhenFetchingIntegrationsOfAnEnvironment+WhenIntegrationsForTheEnvironmentAreFound+WhenIntegrationEnvironmentExists+WhenIntegrationIsAccessible.TheOkStatusCodeIsReturnedWithIntegration(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3Mzg3LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIkZBIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vc3Vic2NyaXB0aW9ucyI6W10sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.3095829" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationIntegrationTests.WhenFetchingIntegrationsOfAnEnvironment.WhenIntegrationsForTheEnvironmentAreFound.WhenIntegrationEnvironmentExists.WhenIntegrationIsAccessible.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Integration\Integration.Integration.Tests.cs:line 907
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationIntegrationTests.WhenFetchingIntegrationsOfAnEnvironment.WhenIntegrationsForTheEnvironmentAreFound.WhenIntegrationEnvironmentExists.WhenIntegrationIsAccessible.TheOkStatusCodeIsReturnedWithIntegration(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Integration\Integration.Integration.Tests.cs:line 885
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="Returns the integrations for the environments." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration" method="IntegrationIntegrationTests+WhenFetchingIntegrationsOfAnEnvironment+WhenIntegrationsForTheEnvironmentAreFound+WhenIntegrationEnvironmentExists+WhenIntegrationIsAccessible.TheOkStatusCodeIsReturnedWithIntegration(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3Mzg3LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbImJlNGQ3MDhiLWNhMTItNDFhYi1iODIyLTM0NzQzMTA4NTIzM3xTQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiYmU0ZDcwOGItY2ExMi00MWFiLWI4MjItMzQ3NDMxMDg1MjMzIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.2522032" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationIntegrationTests.WhenFetchingIntegrationsOfAnEnvironment.WhenIntegrationsForTheEnvironmentAreFound.WhenIntegrationEnvironmentExists.WhenIntegrationIsAccessible.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Integration\Integration.Integration.Tests.cs:line 907
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationIntegrationTests.WhenFetchingIntegrationsOfAnEnvironment.WhenIntegrationsForTheEnvironmentAreFound.WhenIntegrationEnvironmentExists.WhenIntegrationIsAccessible.TheOkStatusCodeIsReturnedWithIntegration(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Integration\Integration.Integration.Tests.cs:line 885
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="Returns the integrations for the environments." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration" method="IntegrationIntegrationTests+WhenFetchingIntegrationsOfAnEnvironment+WhenIntegrationsForTheEnvironmentAreFound+WhenIntegrationEnvironmentExists+WhenIntegrationIsAccessible.TheOkStatusCodeIsReturnedWithIntegration(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3Mzg3LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbImY2ZDE0OGUzLTEwZWMtNDViZS05ZTlhLTNhNGQyOGU5YjIzNXxFQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiYmU0ZDcwOGItY2ExMi00MWFiLWI4MjItMzQ3NDMxMDg1MjMzIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.2845198" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationIntegrationTests.WhenFetchingIntegrationsOfAnEnvironment.WhenIntegrationsForTheEnvironmentAreFound.WhenIntegrationEnvironmentExists.WhenIntegrationIsAccessible.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Integration\Integration.Integration.Tests.cs:line 907
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationIntegrationTests.WhenFetchingIntegrationsOfAnEnvironment.WhenIntegrationsForTheEnvironmentAreFound.WhenIntegrationEnvironmentExists.WhenIntegrationIsAccessible.TheOkStatusCodeIsReturnedWithIntegration(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Integration\Integration.Integration.Tests.cs:line 885
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="Returns a 403, forbidden." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration" method="IntegrationIntegrationTests+WhenFetchingIntegrationsOfAnEnvironment+WhenIntegrationsForTheEnvironmentAreFound+WhenIntegrationEnvironmentExists+WhenIntegrationIsNotAccessible.TheForbidStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3Mzg4LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbImY2ZDE0OGUzLTEwZWMtNDViZS05ZTlhLTNhNGQyOGU5YjIzNXxTVSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiY2QzYzQ3NzYtMTNiOC00ZTg3LTkxMmItZGQ5MjdjYmIzN2FlIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.2023260" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationIntegrationTests.WhenFetchingIntegrationsOfAnEnvironment.WhenIntegrationsForTheEnvironmentAreFound.WhenIntegrationEnvironmentExists.WhenIntegrationIsNotAccessible.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Integration\Integration.Integration.Tests.cs:line 958
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationIntegrationTests.WhenFetchingIntegrationsOfAnEnvironment.WhenIntegrationsForTheEnvironmentAreFound.WhenIntegrationEnvironmentExists.WhenIntegrationIsNotAccessible.TheForbidStatusCodeIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Integration\Integration.Integration.Tests.cs:line 942
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="Returns a 403, forbidden." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration" method="IntegrationIntegrationTests+WhenFetchingIntegrationsOfAnEnvironment+WhenIntegrationsForTheEnvironmentAreFound+WhenIntegrationEnvironmentExists+WhenIntegrationIsNotAccessible.TheForbidStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3Mzg4LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjU2MGUwZDE5LTVhN2ItNDM0Zi1hZjk2LTFlNGYxYTdhYWE1ZXxTQSIsImY2ZDE0OGUzLTEwZWMtNDViZS05ZTlhLTNhNGQyOGU5YjIzNXxTVSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiNTYwZTBkMTktNWE3Yi00MzRmLWFmOTYtMWU0ZjFhN2FhYTVlIiwiNGRhZGFlZTItMmFmYi00YzlhLWJlMjItODcxZjBmNjM2OWFjIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.2445392" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationIntegrationTests.WhenFetchingIntegrationsOfAnEnvironment.WhenIntegrationsForTheEnvironmentAreFound.WhenIntegrationEnvironmentExists.WhenIntegrationIsNotAccessible.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Integration\Integration.Integration.Tests.cs:line 958
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationIntegrationTests.WhenFetchingIntegrationsOfAnEnvironment.WhenIntegrationsForTheEnvironmentAreFound.WhenIntegrationEnvironmentExists.WhenIntegrationIsNotAccessible.TheForbidStatusCodeIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Integration\Integration.Integration.Tests.cs:line 942
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When token doesn't have required role. Returns 403Forbid." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration" method="IntegrationIntegrationTests+WhenFetchingIntegrationPermissions+WhenIntegrationIsFound+WhenIntegrationEnvironmentExists+WhenIntegrationIsNotAccessible.TheForbidStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3Mzg4LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbImY2ZDE0OGUzLTEwZWMtNDViZS05ZTlhLTNhNGQyOGU5YjIzNXxTVSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiNjRhNzMyYTYtY2VjNS00YjU5LTlkMzMtNGJkNTE2ZTFjYzgwIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.3368665" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationIntegrationTests.WhenFetchingIntegrationPermissions.WhenIntegrationIsFound.WhenIntegrationEnvironmentExists.WhenIntegrationIsNotAccessible.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Integration\Integration.Integration.Tests.cs:line 1465
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationIntegrationTests.WhenFetchingIntegrationPermissions.WhenIntegrationIsFound.WhenIntegrationEnvironmentExists.WhenIntegrationIsNotAccessible.TheForbidStatusCodeIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Integration\Integration.Integration.Tests.cs:line 1449
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When token doesn't have required role. Returns 403Forbid." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration" method="IntegrationIntegrationTests+WhenFetchingIntegrationPermissions+WhenIntegrationIsFound+WhenIntegrationEnvironmentExists+WhenIntegrationIsNotAccessible.TheForbidStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3Mzg4LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjQ2YjAzYzhlLTRlZDQtNDg4Mi05M2IyLWU4YTIyOTY5OTNiM3xTQSIsImY2ZDE0OGUzLTEwZWMtNDViZS05ZTlhLTNhNGQyOGU5YjIzNXxTVSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiNDZiMDNjOGUtNGVkNC00ODgyLTkzYjItZThhMjI5Njk5M2IzIiwiZjA0MGRkOGQtODYxMi00M2NhLWI1NWMtMGMwMWEwY2EwZWYwIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.2451756" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationIntegrationTests.WhenFetchingIntegrationPermissions.WhenIntegrationIsFound.WhenIntegrationEnvironmentExists.WhenIntegrationIsNotAccessible.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Integration\Integration.Integration.Tests.cs:line 1465
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationIntegrationTests.WhenFetchingIntegrationPermissions.WhenIntegrationIsFound.WhenIntegrationEnvironmentExists.WhenIntegrationIsNotAccessible.TheForbidStatusCodeIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Integration\Integration.Integration.Tests.cs:line 1449
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When token doesn't have required role. Returns 403Forbid." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration" method="IntegrationIntegrationTests+WhenUpdatingIntegrationPermissions+WhenIntegrationIsFound+WhenIntegrationEnvironmentExists+WhenIntegrationIsNotAccessible.TheForbidStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3Mzg5LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbImY2ZDE0OGUzLTEwZWMtNDViZS05ZTlhLTNhNGQyOGU5YjIzNXxTVSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiNzVlYzM0ZjgtODI1Mi00ZjRiLTgxNDYtZjlhNGI3ZWEzNDMzIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.2799111" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationIntegrationTests.WhenUpdatingIntegrationPermissions.WhenIntegrationIsFound.WhenIntegrationEnvironmentExists.WhenIntegrationIsNotAccessible.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Integration\Integration.Integration.Tests.cs:line 1784
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationIntegrationTests.WhenUpdatingIntegrationPermissions.WhenIntegrationIsFound.WhenIntegrationEnvironmentExists.WhenIntegrationIsNotAccessible.TheForbidStatusCodeIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Integration\Integration.Integration.Tests.cs:line 1768
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When token doesn't have required role. Returns 403Forbid." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration" method="IntegrationIntegrationTests+WhenUpdatingIntegrationPermissions+WhenIntegrationIsFound+WhenIntegrationEnvironmentExists+WhenIntegrationIsNotAccessible.TheForbidStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3Mzg5LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjlmM2UwYjMzLTI4OGQtNDM1Zi04OWE5LWI5MWNmMzA2ZDVhZXxTQSIsImY2ZDE0OGUzLTEwZWMtNDViZS05ZTlhLTNhNGQyOGU5YjIzNXxTVSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiOWYzZTBiMzMtMjg4ZC00MzVmLTg5YTktYjkxY2YzMDZkNWFlIiwiMjI5MzlhZDMtZTAyMi00NjBjLTk4MWQtMmMyOTU5ZTM5OTExIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.2086418" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationIntegrationTests.WhenUpdatingIntegrationPermissions.WhenIntegrationIsFound.WhenIntegrationEnvironmentExists.WhenIntegrationIsNotAccessible.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Integration\Integration.Integration.Tests.cs:line 1784
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationIntegrationTests.WhenUpdatingIntegrationPermissions.WhenIntegrationIsFound.WhenIntegrationEnvironmentExists.WhenIntegrationIsNotAccessible.TheForbidStatusCodeIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Integration\Integration.Integration.Tests.cs:line 1768
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When integration is returned. Returns 404NotFound." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration" method="IntegrationIntegrationTests+WhenFetchingIntegrationPermissions+WhenIntegrationIsFound+WhenIntegrationEnvironmentExists+WhenIntegrationIsAccessible+WhenIntegrationHasPermissions.TheOkStatusCodeIsReturnedWithIntegration(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3NzcxLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIkZBIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vc3Vic2NyaXB0aW9ucyI6W10sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="1.4484475" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationIntegrationTests.WhenFetchingIntegrationPermissions.WhenIntegrationIsFound.WhenIntegrationEnvironmentExists.WhenIntegrationIsAccessible.WhenIntegrationHasPermissions.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Integration\Integration.Integration.Tests.cs:line 1362
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationIntegrationTests.WhenFetchingIntegrationPermissions.WhenIntegrationIsFound.WhenIntegrationEnvironmentExists.WhenIntegrationIsAccessible.WhenIntegrationHasPermissions.TheOkStatusCodeIsReturnedWithIntegration(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Integration\Integration.Integration.Tests.cs:line 1340
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When integration is returned. Returns 404NotFound." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration" method="IntegrationIntegrationTests+WhenFetchingIntegrationPermissions+WhenIntegrationIsFound+WhenIntegrationEnvironmentExists+WhenIntegrationIsAccessible+WhenIntegrationHasPermissions.TheOkStatusCodeIsReturnedWithIntegration(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3NzcxLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjhkNDZiZjY4LWQ5NzItNDE4Yy1iMDQ3LTNmNjUyM2Y2OGU2OHxTQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiOGQ0NmJmNjgtZDk3Mi00MThjLWIwNDctM2Y2NTIzZjY4ZTY4Il0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.8343325" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationIntegrationTests.WhenFetchingIntegrationPermissions.WhenIntegrationIsFound.WhenIntegrationEnvironmentExists.WhenIntegrationIsAccessible.WhenIntegrationHasPermissions.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Integration\Integration.Integration.Tests.cs:line 1362
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationIntegrationTests.WhenFetchingIntegrationPermissions.WhenIntegrationIsFound.WhenIntegrationEnvironmentExists.WhenIntegrationIsAccessible.WhenIntegrationHasPermissions.TheOkStatusCodeIsReturnedWithIntegration(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Integration\Integration.Integration.Tests.cs:line 1340
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When empty integration permissions are returned. Returns 404NotFound." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration" method="IntegrationIntegrationTests+WhenFetchingIntegrationPermissions+WhenIntegrationIsFound+WhenIntegrationEnvironmentExists+WhenIntegrationIsAccessible+WhenIntegrationHasNoPermissions.TheOkStatusCodeIsReturnedWithIntegration(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3Nzc0LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbImY2ZDE0OGUzLTEwZWMtNDViZS05ZTlhLTNhNGQyOGU5YjIzNXxFQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiOGQ0NmJmNjgtZDk3Mi00MThjLWIwNDctM2Y2NTIzZjY4ZTY4Il0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="5.4145388" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationIntegrationTests.WhenFetchingIntegrationPermissions.WhenIntegrationIsFound.WhenIntegrationEnvironmentExists.WhenIntegrationIsAccessible.WhenIntegrationHasNoPermissions.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Integration\Integration.Integration.Tests.cs:line 1414
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationIntegrationTests.WhenFetchingIntegrationPermissions.WhenIntegrationIsFound.WhenIntegrationEnvironmentExists.WhenIntegrationIsAccessible.WhenIntegrationHasNoPermissions.TheOkStatusCodeIsReturnedWithIntegration(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Integration\Integration.Integration.Tests.cs:line 1392
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When integration permissions are updated by SA, FA, EA. Returns 404NotFound." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration" method="IntegrationIntegrationTests+WhenUpdatingIntegrationPermissions+WhenIntegrationIsFound+WhenIntegrationEnvironmentExists+WhenIntegrationIsAccessible+WhenTheListOfPermissionsIsValid.TheOkStatusCodeIsReturnedWithIntegration(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3Nzc5LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIkZBIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vc3Vic2NyaXB0aW9ucyI6W10sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="1.6773293" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationIntegrationTests.WhenUpdatingIntegrationPermissions.WhenIntegrationIsFound.WhenIntegrationEnvironmentExists.WhenIntegrationIsAccessible.WhenTheListOfPermissionsIsValid.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Integration\Integration.Integration.Tests.cs:line 1670
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationIntegrationTests.WhenUpdatingIntegrationPermissions.WhenIntegrationIsFound.WhenIntegrationEnvironmentExists.WhenIntegrationIsAccessible.WhenTheListOfPermissionsIsValid.TheOkStatusCodeIsReturnedWithIntegration(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Integration\Integration.Integration.Tests.cs:line 1638
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When integration permissions are updated by SA, FA, EA. Returns 404NotFound." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration" method="IntegrationIntegrationTests+WhenUpdatingIntegrationPermissions+WhenIntegrationIsFound+WhenIntegrationEnvironmentExists+WhenIntegrationIsAccessible+WhenTheListOfPermissionsIsValid.TheOkStatusCodeIsReturnedWithIntegration(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3Nzc5LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjZhZTAyOTI5LTQ5MmItNDAwMy04ZTMyLWJkNmQwYTVkMWQ3NXxTQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiNmFlMDI5MjktNDkyYi00MDAzLThlMzItYmQ2ZDBhNWQxZDc1Il0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="4.2856769" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationIntegrationTests.WhenUpdatingIntegrationPermissions.WhenIntegrationIsFound.WhenIntegrationEnvironmentExists.WhenIntegrationIsAccessible.WhenTheListOfPermissionsIsValid.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Integration\Integration.Integration.Tests.cs:line 1670
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationIntegrationTests.WhenUpdatingIntegrationPermissions.WhenIntegrationIsFound.WhenIntegrationEnvironmentExists.WhenIntegrationIsAccessible.WhenTheListOfPermissionsIsValid.TheOkStatusCodeIsReturnedWithIntegration(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Integration\Integration.Integration.Tests.cs:line 1638
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When integration permissions are updated by SA, FA, EA. Returns 404NotFound." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration" method="IntegrationIntegrationTests+WhenUpdatingIntegrationPermissions+WhenIntegrationIsFound+WhenIntegrationEnvironmentExists+WhenIntegrationIsAccessible+WhenTheListOfPermissionsIsValid.TheOkStatusCodeIsReturnedWithIntegration(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3Nzc5LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbImY2ZDE0OGUzLTEwZWMtNDViZS05ZTlhLTNhNGQyOGU5YjIzNXxFQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiNmFlMDI5MjktNDkyYi00MDAzLThlMzItYmQ2ZDBhNWQxZDc1Il0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="1.8860310" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationIntegrationTests.WhenUpdatingIntegrationPermissions.WhenIntegrationIsFound.WhenIntegrationEnvironmentExists.WhenIntegrationIsAccessible.WhenTheListOfPermissionsIsValid.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Integration\Integration.Integration.Tests.cs:line 1670
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationIntegrationTests.WhenUpdatingIntegrationPermissions.WhenIntegrationIsFound.WhenIntegrationEnvironmentExists.WhenIntegrationIsAccessible.WhenTheListOfPermissionsIsValid.TheOkStatusCodeIsReturnedWithIntegration(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Integration\Integration.Integration.Tests.cs:line 1638
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When invalid list of permissions provided. Returns 404NotFound." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration" method="IntegrationIntegrationTests+WhenUpdatingIntegrationPermissions+WhenIntegrationIsFound+WhenIntegrationEnvironmentExists+WhenIntegrationIsAccessible+WhenTheListOfPermissionsIsNotValid.TheOkStatusCodeIsReturnedWithIntegration(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3Nzg3LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjZhZTAyOTI5LTQ5MmItNDAwMy04ZTMyLWJkNmQwYTVkMWQ3NXxTQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiNmFlMDI5MjktNDkyYi00MDAzLThlMzItYmQ2ZDBhNWQxZDc1Il0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.6043819" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationIntegrationTests.WhenUpdatingIntegrationPermissions.WhenIntegrationIsFound.WhenIntegrationEnvironmentExists.WhenIntegrationIsAccessible.WhenTheListOfPermissionsIsNotValid.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Integration\Integration.Integration.Tests.cs:line 1730
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Integration.IntegrationIntegrationTests.WhenUpdatingIntegrationPermissions.WhenIntegrationIsFound.WhenIntegrationEnvironmentExists.WhenIntegrationIsAccessible.WhenTheListOfPermissionsIsNotValid.TheOkStatusCodeIsReturnedWithIntegration(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Integration\Integration.Integration.Tests.cs:line 1704
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
    </collection>
    <collection total="14" passed="0" failed="14" skipped="0" name="Test collection for CHILI.GraFx.Platform.API.Integration.Tests.Modules.Roles" time="3.274">
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Roles.RolesContractTests+ApiV1RolesGetEndpoint+WhenReturnsStatusCodeUnauthorized.ProblemDetailsContentIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Roles" method="RolesContractTests+ApiV1RolesGetEndpoint+WhenReturnsStatusCodeUnauthorized.ProblemDetailsContentIsReturned" time="0.1551513" result="Fail">
        <failure>
          <message>System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Roles.RolesContractTests+ApiV1EnvironmentRolesGetEndpoint+WhenReturnsStatusCodeUnauthorized.ProblemDetailsContentIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Roles" method="RolesContractTests+ApiV1EnvironmentRolesGetEndpoint+WhenReturnsStatusCodeUnauthorized.ProblemDetailsContentIsReturned" time="0.1720539" result="Fail">
        <failure>
          <message>System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Roles.RolesIntegrationTests+WhenFetchingAllTheRoles+WhenNoTokenIsProvided.AnHttpUnauthorizedStatusCodeIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Roles" method="RolesIntegrationTests+WhenFetchingAllTheRoles+WhenNoTokenIsProvided.AnHttpUnauthorizedStatusCodeIsReturned" time="0.1318952" result="Fail">
        <failure>
          <message>System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Roles.RolesIntegrationTests+WhenFetchingAllTheRoles+WhenTheTokenIsValid.AnHttpOkStatusCodeIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Roles" method="RolesIntegrationTests+WhenFetchingAllTheRoles+WhenTheTokenIsValid.AnHttpOkStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNzE5OTI1NTk0LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIlNVIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vc3Vic2NyaXB0aW9ucyI6W10sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.2021005" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected result.StatusCode to be HttpStatusCode.OK {value: 200}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected result.StatusCode to be HttpStatusCode.OK {value: 200}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.EnumAssertions`2.Be(TEnum expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Roles.RolesIntegrationTests.WhenFetchingAllTheRoles.WhenTheTokenIsValid.AnHttpOkStatusCodeIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Roles\Roles.Integration.Tests.cs:line 135
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Roles.RolesIntegrationTests+WhenFetchingAllTheRoles+WhenTheTokenIsValid.TheRolesAreReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Roles" method="RolesIntegrationTests+WhenFetchingAllTheRoles+WhenTheTokenIsValid.TheRolesAreReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjk4NDExOTk0LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIlNBIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vc3Vic2NyaXB0aW9ucyI6W10sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.2873340" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected resultString to be "["SA","EA","TD","EU","SU","WA"]" with a length of 31, but "{"type":"https://httpstatuses.io/401","title":"Unauthorized","status":401,"traceId":"00-e0f20975b0818a1017759780853cfd8e-2df5d1932e0dbf5e-00"}" has a length of 142, differs near "{"t" (index 0).) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected resultString to be "["SA","EA","TD","EU","SU","WA"]" with a length of 31, but "{"type":"https://httpstatuses.io/401","title":"Unauthorized","status":401,"traceId":"00-e0f20975b0818a1017759780853cfd8e-2df5d1932e0dbf5e-00"}" has a length of 142, differs near "{"t" (index 0).
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.StringEqualityValidator.ValidateAgainstLengthDifferences()
   at FluentAssertions.Primitives.StringValidator.Validate()
   at FluentAssertions.Primitives.StringAssertions`1.Be(String expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Roles.RolesIntegrationTests.WhenFetchingAllTheRoles.WhenTheTokenIsValid.TheRolesAreReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Roles\Roles.Integration.Tests.cs:line 157
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Roles.RolesIntegrationTests+WhenFetchingEnvironmentRoles+WhenNoTokenIsProvided.AnHttpUnauthorizedStatusCodeIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Roles" method="RolesIntegrationTests+WhenFetchingEnvironmentRoles+WhenNoTokenIsProvided.AnHttpUnauthorizedStatusCodeIsReturned" time="0.1682037" result="Fail">
        <failure>
          <message>System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Roles.RolesIntegrationTests+WhenFetchingEnvironmentRoles+WhenTheTokenIsValid.AnHttpOkStatusCodeIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Roles" method="RolesIntegrationTests+WhenFetchingEnvironmentRoles+WhenTheTokenIsValid.AnHttpOkStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjk5NDQ4Nzk1LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIkVVIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vc3Vic2NyaXB0aW9ucyI6W10sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.2537766" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected _ = result.StatusCode to be HttpStatusCode.OK {value: 200}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected _ = result.StatusCode to be HttpStatusCode.OK {value: 200}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.EnumAssertions`2.Be(TEnum expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Roles.RolesIntegrationTests.WhenFetchingEnvironmentRoles.WhenTheTokenIsValid.AnHttpOkStatusCodeIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Roles\Roles.Integration.Tests.cs:line 275
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Roles.RolesIntegrationTests+WhenFetchingEnvironmentRoles+WhenTheTokenIsValid.TheRolesAreReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Roles" method="RolesIntegrationTests+WhenFetchingEnvironmentRoles+WhenTheTokenIsValid.TheRolesAreReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNzAwMTM5OTk1LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIkVBIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vc3Vic2NyaXB0aW9ucyI6W10sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.2344880" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected _ = resultString to be "["EA","EU"]" with a length of 11, but "{"type":"https://httpstatuses.io/401","title":"Unauthorized","status":401,"traceId":"00-fce0b74ade64872ed0922f762839005a-ef691770cfd5ffaf-00"}" has a length of 142, differs near "{"t" (index 0).) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected _ = resultString to be "["EA","EU"]" with a length of 11, but "{"type":"https://httpstatuses.io/401","title":"Unauthorized","status":401,"traceId":"00-fce0b74ade64872ed0922f762839005a-ef691770cfd5ffaf-00"}" has a length of 142, differs near "{"t" (index 0).
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.StringEqualityValidator.ValidateAgainstLengthDifferences()
   at FluentAssertions.Primitives.StringValidator.Validate()
   at FluentAssertions.Primitives.StringAssertions`1.Be(String expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Roles.RolesIntegrationTests.WhenFetchingEnvironmentRoles.WhenTheTokenIsValid.TheRolesAreReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Roles\Roles.Integration.Tests.cs:line 297
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Roles.RolesIntegrationTests+WhenFetchingAllTheRoles+WhenTheTokenIsInvalid+WhenTheTokenIsExpired.AnHttpUnauthorizedStatusCodeIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Roles" method="RolesIntegrationTests+WhenFetchingAllTheRoles+WhenTheTokenIsInvalid+WhenTheTokenIsExpired.AnHttpUnauthorizedStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjU3NjMxMzU2LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbXSwiaHR0cHM6Ly9jaGlsaS1wdWJsaXNoLmNvbS9zdWJzY3JpcHRpb25zIjpbXSwiaHR0cHM6Ly9jaGlsaS1wdWJsaXNoLmNvbS9jdXN0b21lcl9ndWlkIjoiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIiwic3ViIjoiMSIsImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vZW52aXJvbm1lbnRJZCI6IiIsInNjb3BlIjoiIn0.)" time="0.2704906" result="Fail">
        <failure>
          <message>System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Roles.RolesIntegrationTests+WhenFetchingAllTheRoles+WhenTheTokenIsInvalid+WhenTheTokenHasAnUnsupportedIssuer.AnHttpUnauthorizedStatusCodeIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Roles" method="RolesIntegrationTests+WhenFetchingAllTheRoles+WhenTheTokenIsInvalid+WhenTheTokenHasAnUnsupportedIssuer.AnHttpUnauthorizedStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiI2YmJhOGFjMy1jOTExLTQzN2UtYmRkOS0xNDU5OGYxYmU2MDAiLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MzU3LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbXSwiaHR0cHM6Ly9jaGlsaS1wdWJsaXNoLmNvbS9zdWJzY3JpcHRpb25zIjpbXSwiaHR0cHM6Ly9jaGlsaS1wdWJsaXNoLmNvbS9jdXN0b21lcl9ndWlkIjoiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIiwic3ViIjoiMSIsImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vZW52aXJvbm1lbnRJZCI6IiIsInNjb3BlIjoiIn0.)" time="0.2559133" result="Fail">
        <failure>
          <message>System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Roles.RolesIntegrationTests+WhenFetchingAllTheRoles+WhenTheTokenIsInvalid+WhenTheTokenHasAnUnsupportedAudience.AnHttpUnauthorizedStatusCodeIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Roles" method="RolesIntegrationTests+WhenFetchingAllTheRoles+WhenTheTokenIsInvalid+WhenTheTokenHasAnUnsupportedAudience.AnHttpUnauthorizedStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiI2NzExY2IwNS01MzI5LTQwNjMtYjk3MC1lNDQwZTAyOTNlNjIiLCJhenAiOiIiLCJleHAiOjE2ODkxNjczNTcsImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vcm9sZXMiOltdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOltdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2N1c3RvbWVyX2d1aWQiOiIwMDAwMDAwMC0wMDAwLTAwMDAtMDAwMC0wMDAwMDAwMDAwMDAiLCJzdWIiOiIxIiwiaHR0cHM6Ly9jaGlsaS1wdWJsaXNoLmNvbS9lbnZpcm9ubWVudElkIjoiIiwic2NvcGUiOiIifQ.)" time="0.2621233" result="Fail">
        <failure>
          <message>System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Roles.RolesIntegrationTests+WhenFetchingEnvironmentRoles+WhenTheTokenIsInvalid+WhenTheTokenIsExpired.AnHttpUnauthorizedStatusCodeIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Roles" method="RolesIntegrationTests+WhenFetchingEnvironmentRoles+WhenTheTokenIsInvalid+WhenTheTokenIsExpired.AnHttpUnauthorizedStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjcxNDU1MzU3LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbXSwiaHR0cHM6Ly9jaGlsaS1wdWJsaXNoLmNvbS9zdWJzY3JpcHRpb25zIjpbXSwiaHR0cHM6Ly9jaGlsaS1wdWJsaXNoLmNvbS9jdXN0b21lcl9ndWlkIjoiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIiwic3ViIjoiMSIsImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vZW52aXJvbm1lbnRJZCI6IiIsInNjb3BlIjoiIn0.)" time="0.3002445" result="Fail">
        <failure>
          <message>System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Roles.RolesIntegrationTests+WhenFetchingEnvironmentRoles+WhenTheTokenIsInvalid+WhenTheTokenHasAnUnsupportedIssuer.AnHttpUnauthorizedStatusCodeIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Roles" method="RolesIntegrationTests+WhenFetchingEnvironmentRoles+WhenTheTokenIsInvalid+WhenTheTokenHasAnUnsupportedIssuer.AnHttpUnauthorizedStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiIyZmIyNmQxNC1kOGYyLTRkNzEtYmZiNi1hNjZhNGI4YjA3ZGQiLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MzU3LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbXSwiaHR0cHM6Ly9jaGlsaS1wdWJsaXNoLmNvbS9zdWJzY3JpcHRpb25zIjpbXSwiaHR0cHM6Ly9jaGlsaS1wdWJsaXNoLmNvbS9jdXN0b21lcl9ndWlkIjoiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIiwic3ViIjoiMSIsImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vZW52aXJvbm1lbnRJZCI6IiIsInNjb3BlIjoiIn0.)" time="0.2972595" result="Fail">
        <failure>
          <message>System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Roles.RolesIntegrationTests+WhenFetchingEnvironmentRoles+WhenTheTokenIsInvalid+WhenTheTokenHasAnUnsupportedAudience.AnHttpUnauthorizedStatusCodeIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Roles" method="RolesIntegrationTests+WhenFetchingEnvironmentRoles+WhenTheTokenIsInvalid+WhenTheTokenHasAnUnsupportedAudience.AnHttpUnauthorizedStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiIyYmU3NDgxMi0wOGUyLTRkNTQtYTViNC00N2QzOGJlYTNmNzMiLCJhenAiOiIiLCJleHAiOjE2ODkxNjczNTgsImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vcm9sZXMiOltdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOltdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2N1c3RvbWVyX2d1aWQiOiIwMDAwMDAwMC0wMDAwLTAwMDAtMDAwMC0wMDAwMDAwMDAwMDAiLCJzdWIiOiIxIiwiaHR0cHM6Ly9jaGlsaS1wdWJsaXNoLmNvbS9lbnZpcm9ubWVudElkIjoiIiwic2NvcGUiOiIifQ.)" time="0.2826238" result="Fail">
        <failure>
          <message>System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
    </collection>
    <collection total="2" passed="0" failed="2" skipped="0" name="Test collection for CHILI.GraFx.Platform.API.Integration.Tests.Modules.ServerInfo" time="0.504">
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.ServerInfo.ServerInfoIntegrationTests+WhenRequestingTheServerInformationEndpoint.AnHttpOkStatusCodeIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.ServerInfo" method="ServerInfoIntegrationTests+WhenRequestingTheServerInformationEndpoint.AnHttpOkStatusCodeIsReturned" time="0.2381788" result="Fail">
        <failure>
          <message>System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 79</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.ServerInfo.ServerInfoIntegrationTests+WhenRequestingThePingEndpoint.AnHttpOkStatusCodeIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.ServerInfo" method="ServerInfoIntegrationTests+WhenRequestingThePingEndpoint.AnHttpOkStatusCodeIsReturned" time="0.2656208" result="Fail">
        <failure>
          <message>System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 79</stack-trace>
        </failure>
        <traits />
      </test>
    </collection>
    <collection total="145" passed="0" failed="145" skipped="0" name="Test collection for CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" time="97.444">
      <test name="When request is invalid. Returns 401Unauthorized." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionContractTests+ApiV1SubscriptionsGetEndpoint+WhenReturnsStatusCodeUnauthorized.ProblemDetailsContentIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJjOWU0ZTk3Yi03MjI1LTQ0YjItYjYxOS1hZTkwMWI2ZWI5YmIiLCJhenAiOiIiLCJleHAiOjE2ODkxNjcxODAsImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vcm9sZXMiOltdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOltdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2N1c3RvbWVyX2d1aWQiOiIwMDAwMDAwMC0wMDAwLTAwMDAtMDAwMC0wMDAwMDAwMDAwMDAiLCJzdWIiOiIxIiwiaHR0cHM6Ly9jaGlsaS1wdWJsaXNoLmNvbS9lbnZpcm9ubWVudElkIjoiIiwic2NvcGUiOiIifQ.)" time="0.1911467" result="Fail">
        <failure>
          <message>System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When request is invalid. Returns 401Unauthorized." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionContractTests+ApiV1SubscriptionsGetEndpoint+WhenReturnsStatusCodeUnauthorized.ProblemDetailsContentIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjQ4MjEzNTgwLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbXSwiaHR0cHM6Ly9jaGlsaS1wdWJsaXNoLmNvbS9zdWJzY3JpcHRpb25zIjpbXSwiaHR0cHM6Ly9jaGlsaS1wdWJsaXNoLmNvbS9jdXN0b21lcl9ndWlkIjoiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIiwic3ViIjoiMSIsImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vZW52aXJvbm1lbnRJZCI6IiIsInNjb3BlIjoiIn0.)" time="0.2089554" result="Fail">
        <failure>
          <message>System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When request is invalid. Returns 401Unauthorized." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionContractTests+ApiV1SubscriptionsGetEndpoint+WhenReturnsStatusCodeUnauthorized.ProblemDetailsContentIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiI3YWY5MTNlNy02ZmM2LTRjMzctYWVkNC0yYjNjODU4M2Q5MzMiLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MTgwLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbXSwiaHR0cHM6Ly9jaGlsaS1wdWJsaXNoLmNvbS9zdWJzY3JpcHRpb25zIjpbXSwiaHR0cHM6Ly9jaGlsaS1wdWJsaXNoLmNvbS9jdXN0b21lcl9ndWlkIjoiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIiwic3ViIjoiMSIsImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vZW52aXJvbm1lbnRJZCI6IiIsInNjb3BlIjoiIn0.)" time="0.2008678" result="Fail">
        <failure>
          <message>System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When user doesn't have permissions. Returns 403Forbid." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionContractTests+ApiV1SubscriptionsGetEndpoint+WhenReturnsStatusCodeForbid.ProblemDetailsContentIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNzA5MTI1NTgwLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjJlMDU2MzZhLTg0MDAtNGE2Ni04MmVhLWEyOGJiZDg5ODZjZHxTVSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOltdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2N1c3RvbWVyX2d1aWQiOiIwMDAwMDAwMC0wMDAwLTAwMDAtMDAwMC0wMDAwMDAwMDAwMDAiLCJzdWIiOiIxIiwiaHR0cHM6Ly9jaGlsaS1wdWJsaXNoLmNvbS9lbnZpcm9ubWVudElkIjoiIiwic2NvcGUiOiIifQ.)" time="0.1814141" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected HttpStatusCode to be HttpStatusCode.Forbidden {value: 403}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected HttpStatusCode to be HttpStatusCode.Forbidden {value: 403}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.TestFrameworkProvider.Throw(String message)
   at FluentAssertions.Execution.DefaultAssertionStrategy.HandleFailure(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.HttpResponseMessageAssertions`1.HaveStatusCode(HttpStatusCode expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionContractTests.ApiV1SubscriptionsGetEndpoint.WhenReturnsStatusCodeForbid.ProblemDetailsContentIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Contract.Tests.cs:line 112
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When request is invalid. Returns 401Unauthorized." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionContractTests+ApiV1SubscriptionGetEndpoint+WhenReturnsStatusCodeUnauthorized.ProblemDetailsContentIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiI4Y2E5YjQxMi1kZTQzLTQwMGMtOTYxYS01NWZiYzczZWIwYjMiLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MTgxLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbXSwiaHR0cHM6Ly9jaGlsaS1wdWJsaXNoLmNvbS9zdWJzY3JpcHRpb25zIjpbXSwiaHR0cHM6Ly9jaGlsaS1wdWJsaXNoLmNvbS9jdXN0b21lcl9ndWlkIjoiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIiwic3ViIjoiMSIsImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vZW52aXJvbm1lbnRJZCI6IiIsInNjb3BlIjoiIn0.)" time="0.2121709" result="Fail">
        <failure>
          <message>System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When request is invalid. Returns 401Unauthorized." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionContractTests+ApiV1SubscriptionGetEndpoint+WhenReturnsStatusCodeUnauthorized.ProblemDetailsContentIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjY1NjY2MzgxLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbXSwiaHR0cHM6Ly9jaGlsaS1wdWJsaXNoLmNvbS9zdWJzY3JpcHRpb25zIjpbXSwiaHR0cHM6Ly9jaGlsaS1wdWJsaXNoLmNvbS9jdXN0b21lcl9ndWlkIjoiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIiwic3ViIjoiMSIsImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vZW52aXJvbm1lbnRJZCI6IiIsInNjb3BlIjoiIn0.)" time="0.1985139" result="Fail">
        <failure>
          <message>System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When request is invalid. Returns 401Unauthorized." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionContractTests+ApiV1SubscriptionGetEndpoint+WhenReturnsStatusCodeUnauthorized.ProblemDetailsContentIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJiODViNWQyYi1jZDJmLTRjZTYtYjhmMC1kMmRmNzU4NDlkZjEiLCJhenAiOiIiLCJleHAiOjE2ODkxNjcxODEsImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vcm9sZXMiOltdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOltdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2N1c3RvbWVyX2d1aWQiOiIwMDAwMDAwMC0wMDAwLTAwMDAtMDAwMC0wMDAwMDAwMDAwMDAiLCJzdWIiOiIxIiwiaHR0cHM6Ly9jaGlsaS1wdWJsaXNoLmNvbS9lbnZpcm9ubWVudElkIjoiIiwic2NvcGUiOiIifQ.)" time="0.1985872" result="Fail">
        <failure>
          <message>System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When user doesn't have permissions. Returns 403Forbid." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionContractTests+ApiV1SubscriptionGetEndpoint+WhenReturnsStatusCodeForbidden.ProblemDetailsContentIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MTgxLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMHxTVSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.1168531" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionContractTests.ApiV1SubscriptionGetEndpoint.WhenReturnsStatusCodeForbidden.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Contract.Tests.cs:line 231
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionContractTests.ApiV1SubscriptionGetEndpoint.WhenReturnsStatusCodeForbidden.ProblemDetailsContentIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Contract.Tests.cs:line 208
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When user doesn't have permissions. Returns 403Forbid." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionContractTests+ApiV1SubscriptionGetEndpoint+WhenReturnsStatusCodeForbidden.ProblemDetailsContentIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MTgxLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMHxFQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.1705745" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionContractTests.ApiV1SubscriptionGetEndpoint.WhenReturnsStatusCodeForbidden.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Contract.Tests.cs:line 231
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionContractTests.ApiV1SubscriptionGetEndpoint.WhenReturnsStatusCodeForbidden.ProblemDetailsContentIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Contract.Tests.cs:line 208
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When user doesn't have permissions. Returns 403Forbid." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionContractTests+ApiV1SubscriptionGetEndpoint+WhenReturnsStatusCodeForbidden.ProblemDetailsContentIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MTgxLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjU3Yjg3OGVkLTVlOWMtNDY3ZS05YThkLTg1YmUyYTMwMTQ5MXxTQSIsIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMHxFQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiNTdiODc4ZWQtNWU5Yy00NjdlLTlhOGQtODViZTJhMzAxNDkxIiwiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.1396834" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionContractTests.ApiV1SubscriptionGetEndpoint.WhenReturnsStatusCodeForbidden.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Contract.Tests.cs:line 231
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionContractTests.ApiV1SubscriptionGetEndpoint.WhenReturnsStatusCodeForbidden.ProblemDetailsContentIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Contract.Tests.cs:line 208
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When the entity isn't found. Returns 404NotFound." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionContractTests+ApiV1SubscriptionGetEndpoint+WhenReturnsStatusCodeNotFound.ProblemDetailsContentIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNzE4ODg4NzgyLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIkZBIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vc3Vic2NyaXB0aW9ucyI6W10sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.1935412" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected HttpStatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected HttpStatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.TestFrameworkProvider.Throw(String message)
   at FluentAssertions.Execution.DefaultAssertionStrategy.HandleFailure(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.HttpResponseMessageAssertions`1.HaveStatusCode(HttpStatusCode expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionContractTests.ApiV1SubscriptionGetEndpoint.WhenReturnsStatusCodeNotFound.ProblemDetailsContentIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Contract.Tests.cs:line 265
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When request token is invalid. Returns 401Unauthorized." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionContractTests+ApiV1SubscriptionEnvironmentGetEndpoint+WhenReturnsStatusCodeUnauthorized.ProblemDetailsContentIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJlZTFkZDU3My1iMWNhLTQ4NDMtYWU1NS1iNjFiYjZkMzc4MzkiLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MTgyLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbXSwiaHR0cHM6Ly9jaGlsaS1wdWJsaXNoLmNvbS9zdWJzY3JpcHRpb25zIjpbXSwiaHR0cHM6Ly9jaGlsaS1wdWJsaXNoLmNvbS9jdXN0b21lcl9ndWlkIjoiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIiwic3ViIjoiMSIsImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vZW52aXJvbm1lbnRJZCI6IiIsInNjb3BlIjoiIn0.)" time="0.1998029" result="Fail">
        <failure>
          <message>System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When request token is invalid. Returns 401Unauthorized." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionContractTests+ApiV1SubscriptionEnvironmentGetEndpoint+WhenReturnsStatusCodeUnauthorized.ProblemDetailsContentIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjYzOTM4MzgyLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbXSwiaHR0cHM6Ly9jaGlsaS1wdWJsaXNoLmNvbS9zdWJzY3JpcHRpb25zIjpbXSwiaHR0cHM6Ly9jaGlsaS1wdWJsaXNoLmNvbS9jdXN0b21lcl9ndWlkIjoiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIiwic3ViIjoiMSIsImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vZW52aXJvbm1lbnRJZCI6IiIsInNjb3BlIjoiIn0.)" time="0.1832351" result="Fail">
        <failure>
          <message>System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When request token is invalid. Returns 401Unauthorized." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionContractTests+ApiV1SubscriptionEnvironmentGetEndpoint+WhenReturnsStatusCodeUnauthorized.ProblemDetailsContentIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJmOGUxOTczMi0yMjEzLTQ4ZDQtYWVlZi1jOTQ1MDZmMGM2N2QiLCJhenAiOiIiLCJleHAiOjE2ODkxNjcxODIsImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vcm9sZXMiOltdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOltdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2N1c3RvbWVyX2d1aWQiOiIwMDAwMDAwMC0wMDAwLTAwMDAtMDAwMC0wMDAwMDAwMDAwMDAiLCJzdWIiOiIxIiwiaHR0cHM6Ly9jaGlsaS1wdWJsaXNoLmNvbS9lbnZpcm9ubWVudElkIjoiIiwic2NvcGUiOiIifQ.)" time="0.2246845" result="Fail">
        <failure>
          <message>System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When request is invalid. Returns 401Unauthorized/403Forbid/404NotFound/400BadRequest" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionContractTests+ApiV1SubscriptionRendersGetEndpoint+WhenReturnsStatusCodeUnauthorized.ProblemDetailsContentIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiI5NTdmMDZiMi0wOTdmLTQyOWEtYWY4Zi04MzUxNGJlMTE5NjYiLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MTgyLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbXSwiaHR0cHM6Ly9jaGlsaS1wdWJsaXNoLmNvbS9zdWJzY3JpcHRpb25zIjpbXSwiaHR0cHM6Ly9jaGlsaS1wdWJsaXNoLmNvbS9jdXN0b21lcl9ndWlkIjoiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIiwic3ViIjoiMSIsImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vZW52aXJvbm1lbnRJZCI6IiIsInNjb3BlIjoiIn0., grouping: &quot;groupingb1e15c68-7a3c-43ca-9bfb-9079909d29d1&quot;, startDate: &quot;startDate2a3c84c0-97ee-47e9-9cfc-538efd56677e&quot;, endDate: &quot;endDate2e1f3d6e-4695-4cbf-bbfb-706314d9e573&quot;)" time="0.2436948" result="Fail">
        <failure>
          <message>System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When request is invalid. Returns 401Unauthorized/403Forbid/404NotFound/400BadRequest" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionContractTests+ApiV1SubscriptionRendersGetEndpoint+WhenReturnsStatusCodeUnauthorized.ProblemDetailsContentIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg3OTU3NTgyLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbXSwiaHR0cHM6Ly9jaGlsaS1wdWJsaXNoLmNvbS9zdWJzY3JpcHRpb25zIjpbXSwiaHR0cHM6Ly9jaGlsaS1wdWJsaXNoLmNvbS9jdXN0b21lcl9ndWlkIjoiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIiwic3ViIjoiMSIsImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vZW52aXJvbm1lbnRJZCI6IiIsInNjb3BlIjoiIn0., grouping: &quot;groupingb1e15c68-7a3c-43ca-9bfb-9079909d29d1&quot;, startDate: &quot;startDate2a3c84c0-97ee-47e9-9cfc-538efd56677e&quot;, endDate: &quot;endDate2e1f3d6e-4695-4cbf-bbfb-706314d9e573&quot;)" time="0.1818234" result="Fail">
        <failure>
          <message>System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When request is invalid. Returns 401Unauthorized/403Forbid/404NotFound/400BadRequest" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionContractTests+ApiV1SubscriptionRendersGetEndpoint+WhenReturnsStatusCodeUnauthorized.ProblemDetailsContentIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJiNmI1MmRjZi04ZWU0LTQ1ZTQtYWVjNi0zYjdjZTM5ZmQ1NTAiLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MTgyLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbXSwiaHR0cHM6Ly9jaGlsaS1wdWJsaXNoLmNvbS9zdWJzY3JpcHRpb25zIjpbXSwiaHR0cHM6Ly9jaGlsaS1wdWJsaXNoLmNvbS9jdXN0b21lcl9ndWlkIjoiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIiwic3ViIjoiMSIsImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vZW52aXJvbm1lbnRJZCI6IiIsInNjb3BlIjoiIn0., grouping: &quot;groupingb1e15c68-7a3c-43ca-9bfb-9079909d29d1&quot;, startDate: &quot;startDate2a3c84c0-97ee-47e9-9cfc-538efd56677e&quot;, endDate: &quot;endDate2e1f3d6e-4695-4cbf-bbfb-706314d9e573&quot;)" time="0.2038444" result="Fail">
        <failure>
          <message>System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When user doesn't have permissions. Returns 403Forbid." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionContractTests+ApiV1SubscriptionRendersGetEndpoint+WhenReturnsStatusCodeForbidden.ProblemDetailsContentIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MTgzLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMHxTVSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.1128713" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionContractTests.ApiV1SubscriptionRendersGetEndpoint.WhenReturnsStatusCodeForbidden.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Contract.Tests.cs:line 444
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionContractTests.ApiV1SubscriptionRendersGetEndpoint.WhenReturnsStatusCodeForbidden.ProblemDetailsContentIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Contract.Tests.cs:line 421
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When user doesn't have permissions. Returns 403Forbid." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionContractTests+ApiV1SubscriptionRendersGetEndpoint+WhenReturnsStatusCodeForbidden.ProblemDetailsContentIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MTgzLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMHxFQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.1302752" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionContractTests.ApiV1SubscriptionRendersGetEndpoint.WhenReturnsStatusCodeForbidden.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Contract.Tests.cs:line 444
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionContractTests.ApiV1SubscriptionRendersGetEndpoint.WhenReturnsStatusCodeForbidden.ProblemDetailsContentIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Contract.Tests.cs:line 421
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When user doesn't have permissions. Returns 403Forbid." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionContractTests+ApiV1SubscriptionRendersGetEndpoint+WhenReturnsStatusCodeForbidden.ProblemDetailsContentIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MTgzLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjY2MzIyZmYzLTZhZWYtNGUxOC05YjE5LTIzYTRhNjUxNmIzNHxTQSIsIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMHxFQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiNjYzMjJmZjMtNmFlZi00ZTE4LTliMTktMjNhNGE2NTE2YjM0IiwiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.1388600" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionContractTests.ApiV1SubscriptionRendersGetEndpoint.WhenReturnsStatusCodeForbidden.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Contract.Tests.cs:line 444
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionContractTests.ApiV1SubscriptionRendersGetEndpoint.WhenReturnsStatusCodeForbidden.ProblemDetailsContentIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Contract.Tests.cs:line 421
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When the entity isn't found. Returns 404NotFound." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionContractTests+ApiV1SubscriptionRendersGetEndpoint+WhenReturnsStatusCodeNotFound.ProblemDetailsContentIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNzIwOTYyMzgzLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIkZBIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vc3Vic2NyaXB0aW9ucyI6W10sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.1911590" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected HttpStatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected HttpStatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.TestFrameworkProvider.Throw(String message)
   at FluentAssertions.Execution.DefaultAssertionStrategy.HandleFailure(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.HttpResponseMessageAssertions`1.HaveStatusCode(HttpStatusCode expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionContractTests.ApiV1SubscriptionRendersGetEndpoint.WhenReturnsStatusCodeNotFound.ProblemDetailsContentIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Contract.Tests.cs:line 478
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When request is invalid. Returns 400BadRequest." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionContractTests+ApiV1SubscriptionRendersGetEndpoint+WhenReturnsStatusCodeBadRequest.ProblemDetailsContentIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjk3ODkzNTg0LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIkZBIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vc3Vic2NyaXB0aW9ucyI6W10sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.1957019" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected HttpStatusCode to be HttpStatusCode.BadRequest {value: 400}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected HttpStatusCode to be HttpStatusCode.BadRequest {value: 400}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.HttpResponseMessageAssertions`1.HaveStatusCode(HttpStatusCode expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionContractTests.ApiV1SubscriptionRendersGetEndpoint.WhenReturnsStatusCodeBadRequest.ProblemDetailsContentIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Contract.Tests.cs:line 507
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When request is invalid. Returns 401Unauthorized/403Forbid/404NotFound/400BadRequest" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionContractTests+ApiV1SubscriptionUsersGetEndpointUsingTheIdOverload+WhenReturnsStatusCodeUnauthorized.ProblemDetailsContentIsReturned" time="0.1651025" result="Fail">
        <failure>
          <message>System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When user doesn't have permissions. Returns 403Forbid." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionContractTests+ApiV1SubscriptionUsersGetEndpointUsingTheIdOverload+WhenReturnsStatusCodeForbidden.ProblemDetailsContentIsReturned" time="0.1155767" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionContractTests.ApiV1SubscriptionUsersGetEndpointUsingTheIdOverload.WhenReturnsStatusCodeForbidden.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Contract.Tests.cs:line 581
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionContractTests.ApiV1SubscriptionUsersGetEndpointUsingTheIdOverload.WhenReturnsStatusCodeForbidden.ProblemDetailsContentIsReturned() in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Contract.Tests.cs:line 556
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When the entity isn't found. Returns 404NotFound." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionContractTests+ApiV1SubscriptionUsersGetEndpointUsingTheIdOverload+WhenReturnsStatusCodeNotFound.ProblemDetailsContentIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjk2MTY1NTg0LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMHxTQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.2209905" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected HttpStatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected HttpStatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.HttpResponseMessageAssertions`1.HaveStatusCode(HttpStatusCode expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionContractTests.ApiV1SubscriptionUsersGetEndpointUsingTheIdOverload.WhenReturnsStatusCodeNotFound.ProblemDetailsContentIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Contract.Tests.cs:line 615
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When request is invalid. Returns 401Unauthorized/403Forbid/404NotFound/400BadRequest" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionContractTests+ApiV1SubscriptionUsersGetEndpointUsingTheGuidOverload+WhenReturnsStatusCodeUnauthorized.ProblemDetailsContentIsReturned" time="0.1373202" result="Fail">
        <failure>
          <message>System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When user doesn't have permissions. Returns 403Forbid." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionContractTests+ApiV1SubscriptionUsersGetEndpointUsingTheGuidOverload+WhenReturnsStatusCodeForbidden.ProblemDetailsContentIsReturned" time="0.1690054" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionContractTests.ApiV1SubscriptionUsersGetEndpointUsingTheGuidOverload.WhenReturnsStatusCodeForbidden.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Contract.Tests.cs:line 689
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionContractTests.ApiV1SubscriptionUsersGetEndpointUsingTheGuidOverload.WhenReturnsStatusCodeForbidden.ProblemDetailsContentIsReturned() in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Contract.Tests.cs:line 664
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When the entity isn't found. Returns 404NotFound." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionContractTests+ApiV1SubscriptionUsersGetEndpointUsingTheGuidOverload+WhenReturnsStatusCodeNotFound.ProblemDetailsContentIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNzI5NDI5NTg1LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMHxTQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.2205047" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected HttpStatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected HttpStatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.HttpResponseMessageAssertions`1.HaveStatusCode(HttpStatusCode expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionContractTests.ApiV1SubscriptionUsersGetEndpointUsingTheGuidOverload.WhenReturnsStatusCodeNotFound.ProblemDetailsContentIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Contract.Tests.cs:line 723
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When no token provided. Returns 401Unauthorized." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionContractTests+ApiV1SubscriptionUserGetEndpoint+WhenReturnsStatusCodeUnauthorized.ProblemDetailsContentIsReturned" time="0.1363613" result="Fail">
        <failure>
          <message>System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When users doesn't have permissions. Returns 403Forbid." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionContractTests+ApiV1SubscriptionUserGetEndpoint+WhenReturnsStatusCodeForbidden.ProblemDetailsContentIsReturned" time="0.1225807" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionContractTests.ApiV1SubscriptionUserGetEndpoint.WhenReturnsStatusCodeForbidden.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Contract.Tests.cs:line 797
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionContractTests.ApiV1SubscriptionUserGetEndpoint.WhenReturnsStatusCodeForbidden.ProblemDetailsContentIsReturned() in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Contract.Tests.cs:line 772
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When subscription or user aren't exist. Returns 404NotFound." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionContractTests+ApiV1SubscriptionUserGetEndpoint+WhenReturnsStatusCodeNotFound.ProblemDetailsContentIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNzE3NDE5OTg1LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMHxTQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.2215765" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected HttpStatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected HttpStatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.HttpResponseMessageAssertions`1.HaveStatusCode(HttpStatusCode expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionContractTests.ApiV1SubscriptionUserGetEndpoint.WhenReturnsStatusCodeNotFound.ProblemDetailsContentIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Contract.Tests.cs:line 831
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When request is invalid. Returns 401Unauthorized/403Forbid/404NotFound/400BadRequest" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionContractTests+ApiV1SubscriptionEnvironmentRolesGetEndPoint+WhenReturnStatusCodeUnauthorized.ProblemDetailsContentIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJkMTY1OWU2MS00NWYyLTQ4ZTAtOTQzNy0wZTExYWIwZDIwNWUiLCJhenAiOiIiLCJleHAiOjE2ODkxNjcxODUsImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vcm9sZXMiOltdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOltdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2N1c3RvbWVyX2d1aWQiOiIwMDAwMDAwMC0wMDAwLTAwMDAtMDAwMC0wMDAwMDAwMDAwMDAiLCJzdWIiOiIxIiwiaHR0cHM6Ly9jaGlsaS1wdWJsaXNoLmNvbS9lbnZpcm9ubWVudElkIjoiIiwic2NvcGUiOiIifQ.)" time="0.2020527" result="Fail">
        <failure>
          <message>System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When users doesn't have permissions. Returns 403Forbid." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionContractTests+ApiV1SubscriptionEnvironmentRolesGetEndPoint+WhenReturnsStatusCodeForbidden.ProblemDetailsContentIsReturned" time="0.1400875" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionContractTests.ApiV1SubscriptionEnvironmentRolesGetEndPoint.WhenReturnsStatusCodeForbidden.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Contract.Tests.cs:line 910
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionContractTests.ApiV1SubscriptionEnvironmentRolesGetEndPoint.WhenReturnsStatusCodeForbidden.ProblemDetailsContentIsReturned() in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Contract.Tests.cs:line 885
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When subscription or user aren't exist. Returns 404NotFound." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionContractTests+ApiV1SubscriptionEnvironmentRolesGetEndPoint+WhenReturnsStatusCodeNotFound.ProblemDetailsContentIsReturned" time="0.2296368" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected HttpStatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected HttpStatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.HttpResponseMessageAssertions`1.HaveStatusCode(HttpStatusCode expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionContractTests.ApiV1SubscriptionEnvironmentRolesGetEndPoint.WhenReturnsStatusCodeNotFound.ProblemDetailsContentIsReturned() in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Contract.Tests.cs:line 945
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When subscription is accessible for EA, EU, CA, FA, SA. Returns 200OK and accessible subs" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionsIntegrationTests+WhenFetchingAllSubscriptions+WhenTheTokenIsLinkedFAOrSAOrEAOrEUOrCa.TheSubscriptionsAreReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MTg2LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIkZBIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vc3Vic2NyaXB0aW9ucyI6W10sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., expectedContent: &quot;[{\&quot;id\&quot;:1,\&quot;guid\&quot;:\&quot;27fb99e0-9cef-44ef-a60b-42c0&quot;...)" time="0.1364496" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingAllSubscriptions.WhenTheTokenIsLinkedFAOrSAOrEAOrEUOrCa.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 285
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingAllSubscriptions.WhenTheTokenIsLinkedFAOrSAOrEAOrEUOrCa.TheSubscriptionsAreReturned(Jwt jwt, String expectedContent) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 263
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When subscription is accessible for EA, EU, CA, FA, SA. Returns 200OK and accessible subs" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionsIntegrationTests+WhenFetchingAllSubscriptions+WhenTheTokenIsLinkedFAOrSAOrEAOrEUOrCa.TheSubscriptionsAreReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MTg2LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbImU3ZDMzNDhlLTBlMTktNDY0OS04Yzk3LTU5ZDFjYjUxNGFhNXxTQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiZTdkMzM0OGUtMGUxOS00NjQ5LThjOTctNTlkMWNiNTE0YWE1Il0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., expectedContent: &quot;[{\&quot;id\&quot;:2,\&quot;guid\&quot;:\&quot;e7d3348e-0e19-4649-8c97-59d1&quot;...)" time="0.1291153" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingAllSubscriptions.WhenTheTokenIsLinkedFAOrSAOrEAOrEUOrCa.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 285
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingAllSubscriptions.WhenTheTokenIsLinkedFAOrSAOrEAOrEUOrCa.TheSubscriptionsAreReturned(Jwt jwt, String expectedContent) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 263
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When subscription is accessible for EA, EU, CA, FA, SA. Returns 200OK and accessible subs" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionsIntegrationTests+WhenFetchingAllSubscriptions+WhenTheTokenIsLinkedFAOrSAOrEAOrEUOrCa.TheSubscriptionsAreReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MTg2LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjcwN2U1OGYxLWY4MzMtNGZkZi05OGIzLTk0NTFiZjI4OTgzNXxFQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMjdmYjk5ZTAtOWNlZi00NGVmLWE2MGItNDJjMDIxYmM1OTg3Il0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., expectedContent: &quot;[{\&quot;id\&quot;:1,\&quot;guid\&quot;:\&quot;27fb99e0-9cef-44ef-a60b-42c0&quot;...)" time="0.1510765" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingAllSubscriptions.WhenTheTokenIsLinkedFAOrSAOrEAOrEUOrCa.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 285
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingAllSubscriptions.WhenTheTokenIsLinkedFAOrSAOrEAOrEUOrCa.TheSubscriptionsAreReturned(Jwt jwt, String expectedContent) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 263
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When subscription is accessible for EA, EU, CA, FA, SA. Returns 200OK and accessible subs" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionsIntegrationTests+WhenFetchingAllSubscriptions+WhenTheTokenIsLinkedFAOrSAOrEAOrEUOrCa.TheSubscriptionsAreReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MTg2LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjcwN2U1OGYxLWY4MzMtNGZkZi05OGIzLTk0NTFiZjI4OTgzNXxFVSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMjdmYjk5ZTAtOWNlZi00NGVmLWE2MGItNDJjMDIxYmM1OTg3Il0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., expectedContent: &quot;[{\&quot;id\&quot;:1,\&quot;guid\&quot;:\&quot;27fb99e0-9cef-44ef-a60b-42c0&quot;...)" time="0.1440109" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingAllSubscriptions.WhenTheTokenIsLinkedFAOrSAOrEAOrEUOrCa.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 285
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingAllSubscriptions.WhenTheTokenIsLinkedFAOrSAOrEAOrEUOrCa.TheSubscriptionsAreReturned(Jwt jwt, String expectedContent) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 263
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When subscription is accessible for EA, EU, CA, FA, SA. Returns 200OK and accessible subs" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionsIntegrationTests+WhenFetchingAllSubscriptions+WhenTheTokenIsLinkedFAOrSAOrEAOrEUOrCa.TheSubscriptionsAreReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MTg2LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjdmMDgwNGI4LTYwZjAtNDllNi1hNmQyLTNlYWMzNmRiNWZjZXxDQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiNWVmMDhmMmYtYzRmMy00YmQ3LWI1ODUtODEzYmNmYWQzMWE0Il0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., expectedContent: &quot;[{\&quot;id\&quot;:4,\&quot;guid\&quot;:\&quot;5ef08f2f-c4f3-4bd7-b585-813b&quot;...)" time="0.1287822" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingAllSubscriptions.WhenTheTokenIsLinkedFAOrSAOrEAOrEUOrCa.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 285
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingAllSubscriptions.WhenTheTokenIsLinkedFAOrSAOrEAOrEUOrCa.TheSubscriptionsAreReturned(Jwt jwt, String expectedContent) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 263
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When doesn't have required role. Returns 403Forbid." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionsIntegrationTests+WhenFetchingAllSubscriptions+WhenTokenDoesNotHavePermissions.TheForbidStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MTg3LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMHxTVSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.2052960" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected result.StatusCode to be HttpStatusCode.Forbidden {value: 403}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected result.StatusCode to be HttpStatusCode.Forbidden {value: 403}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.EnumAssertions`2.Be(TEnum expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingAllSubscriptions.WhenTokenDoesNotHavePermissions.TheForbidStatusCodeIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 322
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When doesn't have required role. Returns 403Forbid." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionsIntegrationTests+WhenFetchingAllSubscriptions+WhenTokenDoesNotHavePermissions.TheForbidStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MTg3LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMHxURCJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.2021090" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected result.StatusCode to be HttpStatusCode.Forbidden {value: 403}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected result.StatusCode to be HttpStatusCode.Forbidden {value: 403}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.EnumAssertions`2.Be(TEnum expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingAllSubscriptions.WhenTokenDoesNotHavePermissions.TheForbidStatusCodeIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 322
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When token doesn't have required role. Returns 403Forbid." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionsIntegrationTests+WhenFetchingASingleSubscription+WhenTokenDoesNotHavePermissions.TheNotFoundStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MTg3LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMHxTVSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.1954184" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected result.StatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected result.StatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.EnumAssertions`2.Be(TEnum expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingASingleSubscription.WhenTokenDoesNotHavePermissions.TheNotFoundStatusCodeIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 467
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When token doesn't have required role. Returns 403Forbid." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionsIntegrationTests+WhenFetchingASingleSubscription+WhenTokenDoesNotHavePermissions.TheNotFoundStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MTg3LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMHxURCJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.2001083" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected result.StatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected result.StatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.EnumAssertions`2.Be(TEnum expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingASingleSubscription.WhenTokenDoesNotHavePermissions.TheNotFoundStatusCodeIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 467
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When token doesn't have required role. Returns 403Forbid." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionsIntegrationTests+WhenFetchingASingleSubscription+WhenTokenDoesNotHavePermissions.TheNotFoundStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MTg3LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMHxDQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.1958061" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected result.StatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected result.StatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.EnumAssertions`2.Be(TEnum expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingASingleSubscription.WhenTokenDoesNotHavePermissions.TheNotFoundStatusCodeIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 467
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When token doesn't have required role. Returns 403Forbid." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionsIntegrationTests+WhenFetchingASingleSubscription+WhenTokenDoesNotHavePermissions.TheNotFoundStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MTg3LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMHxFVSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.2151161" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected result.StatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected result.StatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.EnumAssertions`2.Be(TEnum expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingASingleSubscription.WhenTokenDoesNotHavePermissions.TheNotFoundStatusCodeIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 467
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When token doesn't have required role. Returns 403Forbid." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionsIntegrationTests+WhenFetchingASingleSubscription+WhenTokenDoesNotHavePermissions.TheNotFoundStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MTg3LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMHxFQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.2190965" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected result.StatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected result.StatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.EnumAssertions`2.Be(TEnum expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingASingleSubscription.WhenTokenDoesNotHavePermissions.TheNotFoundStatusCodeIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 467
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When token doesn't have required role. Returns 403Forbid." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionsIntegrationTests+WhenVerifyingIfEnvironmentIsUnderSubscription+WhenTheTokenHasNoPermissions.AnHttpForbiddenStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MTg4LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMHxTVSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.2868269" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected result.StatusCode to be HttpStatusCode.Forbidden {value: 403}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected result.StatusCode to be HttpStatusCode.Forbidden {value: 403}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.EnumAssertions`2.Be(TEnum expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenVerifyingIfEnvironmentIsUnderSubscription.WhenTheTokenHasNoPermissions.AnHttpForbiddenStatusCodeIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 742
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When token doesn't have required role. Returns 403Forbid." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionsIntegrationTests+WhenVerifyingIfEnvironmentIsUnderSubscription+WhenTheTokenHasNoPermissions.AnHttpForbiddenStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MTg4LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMHxURCJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.2288595" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected result.StatusCode to be HttpStatusCode.Forbidden {value: 403}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected result.StatusCode to be HttpStatusCode.Forbidden {value: 403}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.EnumAssertions`2.Be(TEnum expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenVerifyingIfEnvironmentIsUnderSubscription.WhenTheTokenHasNoPermissions.AnHttpForbiddenStatusCodeIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 742
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When token doesn't have required role. Returns 403Forbid." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionsIntegrationTests+WhenVerifyingIfEnvironmentIsUnderSubscription+WhenTheTokenHasNoPermissions.AnHttpForbiddenStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MTg4LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMHxTQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.1933332" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected result.StatusCode to be HttpStatusCode.Forbidden {value: 403}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected result.StatusCode to be HttpStatusCode.Forbidden {value: 403}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.EnumAssertions`2.Be(TEnum expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenVerifyingIfEnvironmentIsUnderSubscription.WhenTheTokenHasNoPermissions.AnHttpForbiddenStatusCodeIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 742
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When token doesn't have required role. Returns 403Forbid." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionsIntegrationTests+WhenVerifyingIfEnvironmentIsUnderSubscription+WhenTheTokenHasNoPermissions.AnHttpForbiddenStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MTg4LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMHxDQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.2024857" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected result.StatusCode to be HttpStatusCode.Forbidden {value: 403}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected result.StatusCode to be HttpStatusCode.Forbidden {value: 403}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.EnumAssertions`2.Be(TEnum expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenVerifyingIfEnvironmentIsUnderSubscription.WhenTheTokenHasNoPermissions.AnHttpForbiddenStatusCodeIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 742
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When token doesn't have required role. Returns 403Forbid." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionsIntegrationTests+WhenVerifyingIfEnvironmentIsUnderSubscription+WhenTheTokenHasNoPermissions.AnHttpForbiddenStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MTg4LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMHxFVSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.3198631" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected result.StatusCode to be HttpStatusCode.Forbidden {value: 403}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected result.StatusCode to be HttpStatusCode.Forbidden {value: 403}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.EnumAssertions`2.Be(TEnum expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenVerifyingIfEnvironmentIsUnderSubscription.WhenTheTokenHasNoPermissions.AnHttpForbiddenStatusCodeIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 742
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When token doesn't have required role. Returns 403Forbid." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionsIntegrationTests+WhenVerifyingIfEnvironmentIsUnderSubscription+WhenTheTokenHasNoPermissions.AnHttpForbiddenStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MTg4LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMHxFQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.2088706" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected result.StatusCode to be HttpStatusCode.Forbidden {value: 403}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected result.StatusCode to be HttpStatusCode.Forbidden {value: 403}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.EnumAssertions`2.Be(TEnum expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenVerifyingIfEnvironmentIsUnderSubscription.WhenTheTokenHasNoPermissions.AnHttpForbiddenStatusCodeIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 742
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When token has FA role. Returns 200OK." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionsIntegrationTests+WhenVerifyingIfEnvironmentIsUnderSubscription+WhenTheTokenIsLinkedToFA.TheCorrectValueIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MTkwLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIkZBIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vc3Vic2NyaXB0aW9ucyI6W10sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., environmentGuid: 00000000-0000-0000-0000-000000000000, expectedResponseValue: &quot;false&quot;)" time="0.1325256" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenVerifyingIfEnvironmentIsUnderSubscription.WhenTheTokenIsLinkedToFA.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 795
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenVerifyingIfEnvironmentIsUnderSubscription.WhenTheTokenIsLinkedToFA.TheCorrectValueIsReturned(Jwt jwt, Guid environmentGuid, String expectedResponseValue) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 773
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When token has FA role. Returns 200OK." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionsIntegrationTests+WhenVerifyingIfEnvironmentIsUnderSubscription+WhenTheTokenIsLinkedToFA.TheCorrectValueIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MTkwLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIkZBIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vc3Vic2NyaXB0aW9ucyI6W10sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., environmentGuid: 00000000-0000-0000-0000-000000000001, expectedResponseValue: &quot;true&quot;)" time="0.1466516" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenVerifyingIfEnvironmentIsUnderSubscription.WhenTheTokenIsLinkedToFA.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 795
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenVerifyingIfEnvironmentIsUnderSubscription.WhenTheTokenIsLinkedToFA.TheCorrectValueIsReturned(Jwt jwt, Guid environmentGuid, String expectedResponseValue) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 773
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When token doesn't have required role. Returns 403Forbid." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionsIntegrationTests+WhenFetchingASingleSubscriptionWithRenders+WhenTokenDoesNotHavePermissions.TheNotFoundStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MTkwLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMHxTVSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.1939872" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected result.StatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected result.StatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.EnumAssertions`2.Be(TEnum expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingASingleSubscriptionWithRenders.WhenTokenDoesNotHavePermissions.TheNotFoundStatusCodeIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 2342
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When token doesn't have required role. Returns 403Forbid." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionsIntegrationTests+WhenFetchingASingleSubscriptionWithRenders+WhenTokenDoesNotHavePermissions.TheNotFoundStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MTkwLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMHxDQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.1990123" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected result.StatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected result.StatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.EnumAssertions`2.Be(TEnum expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingASingleSubscriptionWithRenders.WhenTokenDoesNotHavePermissions.TheNotFoundStatusCodeIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 2342
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When token doesn't have required role. Returns 403Forbid." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionsIntegrationTests+WhenFetchingASingleSubscriptionWithRenders+WhenTokenDoesNotHavePermissions.TheNotFoundStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MTkwLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMHxURCJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.1943796" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected result.StatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected result.StatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.EnumAssertions`2.Be(TEnum expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingASingleSubscriptionWithRenders.WhenTokenDoesNotHavePermissions.TheNotFoundStatusCodeIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 2342
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When token doesn't have required role. Returns 403Forbid." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionsIntegrationTests+WhenFetchingASingleSubscriptionWithRenders+WhenTokenDoesNotHavePermissions.TheNotFoundStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MTkwLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMHxFVSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.2004976" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected result.StatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected result.StatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.EnumAssertions`2.Be(TEnum expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingASingleSubscriptionWithRenders.WhenTokenDoesNotHavePermissions.TheNotFoundStatusCodeIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 2342
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When token doesn't have required role. Returns 403Forbid." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionsIntegrationTests+WhenFetchingASingleSubscriptionWithRenders+WhenTokenDoesNotHavePermissions.TheNotFoundStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MTkwLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMHxFQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.1982987" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected result.StatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected result.StatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.EnumAssertions`2.Be(TEnum expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingASingleSubscriptionWithRenders.WhenTokenDoesNotHavePermissions.TheNotFoundStatusCodeIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 2342
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When the token has no permissions. Returns 403HttpForbidden." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionsIntegrationTests+WhenFetchingTheUsersOfASingleSubscriptionUsingTheIdOverload+WhenTheTokenHasNoPermissions.AnHttpForbiddenStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MTkxLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjk3OWE0OTQ3LWVhODUtNGVjMC1iNTg4LTc3YjE0ZGNkMTFjYXxURCJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiOTc5YTQ5NDctZWE4NS00ZWMwLWI1ODgtNzdiMTRkY2QxMWNhIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.1328689" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingTheUsersOfASingleSubscriptionUsingTheIdOverload.WhenTheTokenHasNoPermissions.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 2389
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingTheUsersOfASingleSubscriptionUsingTheIdOverload.WhenTheTokenHasNoPermissions.AnHttpForbiddenStatusCodeIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 2373
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When the token has no permissions. Returns 403HttpForbidden." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionsIntegrationTests+WhenFetchingTheUsersOfASingleSubscriptionUsingTheIdOverload+WhenTheTokenHasNoPermissions.AnHttpForbiddenStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MTkxLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjE4MzNiOThkLWJkYzktNGViMy04MDRjLWU5OTFlMWVhMmFkMnxTVSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiOTc5YTQ5NDctZWE4NS00ZWMwLWI1ODgtNzdiMTRkY2QxMWNhIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.1129646" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingTheUsersOfASingleSubscriptionUsingTheIdOverload.WhenTheTokenHasNoPermissions.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 2389
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingTheUsersOfASingleSubscriptionUsingTheIdOverload.WhenTheTokenHasNoPermissions.AnHttpForbiddenStatusCodeIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 2373
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When the token has no permissions. Returns 403HttpForbidden." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionsIntegrationTests+WhenFetchingTheUsersOfASingleSubscriptionUsingTheIdOverload+WhenTheTokenHasNoPermissions.AnHttpForbiddenStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MTkxLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjE4MzNiOThkLWJkYzktNGViMy04MDRjLWU5OTFlMWVhMmFkMnxTVSIsImE0MTFiZjI2LTBmNzctNDE4My1iZGFmLTM0MWNmOTlmMThlOHxFQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiOTc5YTQ5NDctZWE4NS00ZWMwLWI1ODgtNzdiMTRkY2QxMWNhIiwiMGU1NDVmMDEtYmI3Ni00OTYyLWJkNTQtMzJlOTNjYzZkMDAwIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.1327367" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingTheUsersOfASingleSubscriptionUsingTheIdOverload.WhenTheTokenHasNoPermissions.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 2389
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingTheUsersOfASingleSubscriptionUsingTheIdOverload.WhenTheTokenHasNoPermissions.AnHttpForbiddenStatusCodeIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 2373
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When the token has no permissions. Returns 403HttpForbidden." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionsIntegrationTests+WhenFetchingTheUsersOfASingleSubscription+WhenTheTokenHasNoPermissions.AnHttpForbiddenStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MTkxLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjk3OWE0OTQ3LWVhODUtNGVjMC1iNTg4LTc3YjE0ZGNkMTFjYXxURCJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiOTc5YTQ5NDctZWE4NS00ZWMwLWI1ODgtNzdiMTRkY2QxMWNhIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.1925369" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingTheUsersOfASingleSubscription.WhenTheTokenHasNoPermissions.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 2552
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingTheUsersOfASingleSubscription.WhenTheTokenHasNoPermissions.AnHttpForbiddenStatusCodeIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 2531
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When the token has no permissions. Returns 403HttpForbidden." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionsIntegrationTests+WhenFetchingTheUsersOfASingleSubscription+WhenTheTokenHasNoPermissions.AnHttpForbiddenStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MTkxLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjE4MzNiOThkLWJkYzktNGViMy04MDRjLWU5OTFlMWVhMmFkMnxTVSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiOTc5YTQ5NDctZWE4NS00ZWMwLWI1ODgtNzdiMTRkY2QxMWNhIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.1339121" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingTheUsersOfASingleSubscription.WhenTheTokenHasNoPermissions.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 2552
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingTheUsersOfASingleSubscription.WhenTheTokenHasNoPermissions.AnHttpForbiddenStatusCodeIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 2531
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When the token has no permissions. Returns 403HttpForbidden." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionsIntegrationTests+WhenFetchingTheUsersOfASingleSubscription+WhenTheTokenHasNoPermissions.AnHttpForbiddenStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MTkxLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjE4MzNiOThkLWJkYzktNGViMy04MDRjLWU5OTFlMWVhMmFkMnxTVSIsImZiN2M1MzBkLTNhODctNDczOS04ZjdjLWI3YTZjNmMzZTFhNnxFQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiOTc5YTQ5NDctZWE4NS00ZWMwLWI1ODgtNzdiMTRkY2QxMWNhIiwiMzc2NTIxYjgtMjI0ZC00ZDgyLTgxZGQtMTIyN2E1OGRjMWUzIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.1437454" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingTheUsersOfASingleSubscription.WhenTheTokenHasNoPermissions.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 2552
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingTheUsersOfASingleSubscription.WhenTheTokenHasNoPermissions.AnHttpForbiddenStatusCodeIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 2531
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When the token has no permissions. Returns 403HttpForbid." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionsIntegrationTests+WhenFetchingTheUserOfASingleSubscription+WhenTheTokenHasNoPermissions.AnHttpForbiddenOrNotFoundStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MTkyLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjE4MzNiOThkLWJkYzktNGViMy04MDRjLWU5OTFlMWVhMmFkMnxFVSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiOTc5YTQ5NDctZWE4NS00ZWMwLWI1ODgtNzdiMTRkY2QxMWNhIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.1281458" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingTheUserOfASingleSubscription.WhenTheTokenHasNoPermissions.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 2730
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingTheUserOfASingleSubscription.WhenTheTokenHasNoPermissions.AnHttpForbiddenOrNotFoundStatusCodeIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 2714
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When the token has no permissions. Returns 403HttpForbid." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionsIntegrationTests+WhenFetchingTheUserOfASingleSubscription+WhenTheTokenHasNoPermissions.AnHttpForbiddenOrNotFoundStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MTkyLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjE4MzNiOThkLWJkYzktNGViMy04MDRjLWU5OTFlMWVhMmFkMnxDQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiOTc5YTQ5NDctZWE4NS00ZWMwLWI1ODgtNzdiMTRkY2QxMWNhIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.1329072" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingTheUserOfASingleSubscription.WhenTheTokenHasNoPermissions.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 2730
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingTheUserOfASingleSubscription.WhenTheTokenHasNoPermissions.AnHttpForbiddenOrNotFoundStatusCodeIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 2714
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When the token has no permissions. Returns 403HttpForbid." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionsIntegrationTests+WhenFetchingTheUserOfASingleSubscription+WhenTheTokenHasNoPermissions.AnHttpForbiddenOrNotFoundStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MTkyLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjk3OWE0OTQ3LWVhODUtNGVjMC1iNTg4LTc3YjE0ZGNkMTFjYXxURCJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiOTc5YTQ5NDctZWE4NS00ZWMwLWI1ODgtNzdiMTRkY2QxMWNhIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.1287187" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingTheUserOfASingleSubscription.WhenTheTokenHasNoPermissions.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 2730
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingTheUserOfASingleSubscription.WhenTheTokenHasNoPermissions.AnHttpForbiddenOrNotFoundStatusCodeIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 2714
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When the token has no permissions. Returns 403HttpForbid." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionsIntegrationTests+WhenFetchingTheUserOfASingleSubscription+WhenTheTokenHasNoPermissions.AnHttpForbiddenOrNotFoundStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MTkyLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMHxTQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.1494755" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingTheUserOfASingleSubscription.WhenTheTokenHasNoPermissions.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 2730
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingTheUserOfASingleSubscription.WhenTheTokenHasNoPermissions.AnHttpForbiddenOrNotFoundStatusCodeIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 2714
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When the token has no permissions. Returns 403HttpForbid." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionsIntegrationTests+WhenFetchingTheUserOfASingleSubscription+WhenTheTokenHasNoPermissions.AnHttpForbiddenOrNotFoundStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MTkyLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMHxFQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.1356410" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingTheUserOfASingleSubscription.WhenTheTokenHasNoPermissions.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 2730
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingTheUserOfASingleSubscription.WhenTheTokenHasNoPermissions.AnHttpForbiddenOrNotFoundStatusCodeIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 2714
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When the token has no permissions. Returns 403HttpForbid." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionsIntegrationTests+WhenFetchingTheUserOfASingleSubscription+WhenTheTokenHasNoPermissions.AnHttpForbiddenOrNotFoundStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MTkyLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjE4MzNiOThkLWJkYzktNGViMy04MDRjLWU5OTFlMWVhMmFkMnxFVSIsImQ0MzNjZjQwLWI0ZGEtNDk5ZC04M2U3LTI4ZDAwMWUyYzNlM3xTQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiOTc5YTQ5NDctZWE4NS00ZWMwLWI1ODgtNzdiMTRkY2QxMWNhIiwiZDQzM2NmNDAtYjRkYS00OTlkLTgzZTctMjhkMDAxZTJjM2UzIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.1619314" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingTheUserOfASingleSubscription.WhenTheTokenHasNoPermissions.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 2730
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingTheUserOfASingleSubscription.WhenTheTokenHasNoPermissions.AnHttpForbiddenOrNotFoundStatusCodeIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 2714
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When feature flag is disabled. Returns Environment roles without CA." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionsIntegrationTests+WhenFetchingSubscriptionEnvironmentRoles+WhenHideFeatureFlagDisabled.AnHttpNotFoundStatusCodeIsReturned(expectedContent: &quot;[\&quot;EA\&quot;,\&quot;EU\&quot;]&quot;, token: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjkwMDMxMTkyLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIkZBIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vc3Vic2NyaXB0aW9ucyI6W10sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.1573239" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingSubscriptionEnvironmentRoles.WhenHideFeatureFlagDisabled.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 2974
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingSubscriptionEnvironmentRoles.WhenHideFeatureFlagDisabled.AnHttpNotFoundStatusCodeIsReturned(String expectedContent, Jwt token) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 2952
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When the token has no permissions. Returns 403HttpForbid." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionsIntegrationTests+WhenFetchingSubscriptionEnvironmentRoles+WhenTheTokenHasNoPermissions.AnHttpForbiddenOrNotFoundStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MTkzLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMXxFVSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAxIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.1313045" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingSubscriptionEnvironmentRoles.WhenTheTokenHasNoPermissions.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 3042
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingSubscriptionEnvironmentRoles.WhenTheTokenHasNoPermissions.AnHttpForbiddenOrNotFoundStatusCodeIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 3026
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When the token has no permissions. Returns 403HttpForbid." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionsIntegrationTests+WhenFetchingSubscriptionEnvironmentRoles+WhenTheTokenHasNoPermissions.AnHttpForbiddenOrNotFoundStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MTkzLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMXxDQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAxIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.1123969" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingSubscriptionEnvironmentRoles.WhenTheTokenHasNoPermissions.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 3042
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingSubscriptionEnvironmentRoles.WhenTheTokenHasNoPermissions.AnHttpForbiddenOrNotFoundStatusCodeIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 3026
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When the token has no permissions. Returns 403HttpForbid." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionsIntegrationTests+WhenFetchingSubscriptionEnvironmentRoles+WhenTheTokenHasNoPermissions.AnHttpForbiddenOrNotFoundStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MTkzLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMXxURCJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAxIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.1350293" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingSubscriptionEnvironmentRoles.WhenTheTokenHasNoPermissions.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 3042
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingSubscriptionEnvironmentRoles.WhenTheTokenHasNoPermissions.AnHttpForbiddenOrNotFoundStatusCodeIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 3026
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When the token has no permissions. Returns 403HttpForbid." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionsIntegrationTests+WhenFetchingSubscriptionEnvironmentRoles+WhenTheTokenHasNoPermissions.AnHttpForbiddenOrNotFoundStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MTkzLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMHxTQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.1343144" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingSubscriptionEnvironmentRoles.WhenTheTokenHasNoPermissions.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 3042
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingSubscriptionEnvironmentRoles.WhenTheTokenHasNoPermissions.AnHttpForbiddenOrNotFoundStatusCodeIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 3026
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When the token has no permissions. Returns 403HttpForbid." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionsIntegrationTests+WhenFetchingSubscriptionEnvironmentRoles+WhenTheTokenHasNoPermissions.AnHttpForbiddenOrNotFoundStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MTkzLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMHxFQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.1423193" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingSubscriptionEnvironmentRoles.WhenTheTokenHasNoPermissions.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 3042
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingSubscriptionEnvironmentRoles.WhenTheTokenHasNoPermissions.AnHttpForbiddenOrNotFoundStatusCodeIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 3026
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When the token has no permissions. Returns 403HttpForbid." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionsIntegrationTests+WhenFetchingSubscriptionEnvironmentRoles+WhenTheTokenHasNoPermissions.AnHttpForbiddenOrNotFoundStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MTkzLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMXxFVSIsIjVmMzA4NmZlLTQ0YzctNGM1MC1iOTk4LTgxOGYwYTZkOWJjM3xTQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAxIiwiNWYzMDg2ZmUtNDRjNy00YzUwLWI5OTgtODE4ZjBhNmQ5YmMzIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.1547601" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingSubscriptionEnvironmentRoles.WhenTheTokenHasNoPermissions.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 3042
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingSubscriptionEnvironmentRoles.WhenTheTokenHasNoPermissions.AnHttpForbiddenOrNotFoundStatusCodeIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 3026
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When subscription is not found by SA, FA. Returns 404NotFound." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionsIntegrationTests+WhenFetchingASingleSubscription+WhenTokenIsLinkedToFAOrSA+WhenSubscriptionIsNotFound.TheNotFoundStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MzQ1LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIkZBIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vc3Vic2NyaXB0aW9ucyI6W10sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.2837297" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected result.StatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected result.StatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.EnumAssertions`2.Be(TEnum expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingASingleSubscription.WhenTokenIsLinkedToFAOrSA.WhenSubscriptionIsNotFound.TheNotFoundStatusCodeIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 647
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When subscription is not found by SA, FA. Returns 404NotFound." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionsIntegrationTests+WhenFetchingASingleSubscription+WhenTokenIsLinkedToFAOrSA+WhenSubscriptionIsNotFound.TheNotFoundStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MzQ1LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMHxTQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.3505557" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected result.StatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected result.StatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.EnumAssertions`2.Be(TEnum expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingASingleSubscription.WhenTokenIsLinkedToFAOrSA.WhenSubscriptionIsNotFound.TheNotFoundStatusCodeIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 647
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When one of params is not valid. Returns 400BadRequest." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionsIntegrationTests+WhenFetchingASingleSubscriptionWithRenders+WhenTokenIsLinkedToFAOrSA+WhenRequestIsNotValid.TheBadRequestStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MzQ2LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIkZBIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vc3Vic2NyaXB0aW9ucyI6W10sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., grouping: &quot;X&quot;, startDate: null, endDate: null)" time="0.3469314" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected result.StatusCode to be HttpStatusCode.BadRequest {value: 400}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected result.StatusCode to be HttpStatusCode.BadRequest {value: 400}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.EnumAssertions`2.Be(TEnum expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingASingleSubscriptionWithRenders.WhenTokenIsLinkedToFAOrSA.WhenRequestIsNotValid.TheBadRequestStatusCodeIsReturned(Jwt jwt, String grouping, String startDate, String endDate) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 874
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When one of params is not valid. Returns 400BadRequest." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionsIntegrationTests+WhenFetchingASingleSubscriptionWithRenders+WhenTokenIsLinkedToFAOrSA+WhenRequestIsNotValid.TheBadRequestStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MzQ2LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMHxTQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., grouping: &quot;year&quot;, startDate: null, endDate: &quot;2022-01-01&quot;)" time="0.3303060" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected result.StatusCode to be HttpStatusCode.BadRequest {value: 400}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected result.StatusCode to be HttpStatusCode.BadRequest {value: 400}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.EnumAssertions`2.Be(TEnum expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingASingleSubscriptionWithRenders.WhenTokenIsLinkedToFAOrSA.WhenRequestIsNotValid.TheBadRequestStatusCodeIsReturned(Jwt jwt, String grouping, String startDate, String endDate) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 874
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When one of params is not valid. Returns 400BadRequest." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionsIntegrationTests+WhenFetchingASingleSubscriptionWithRenders+WhenTokenIsLinkedToFAOrSA+WhenRequestIsNotValid.TheBadRequestStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MzQ2LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIkZBIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vc3Vic2NyaXB0aW9ucyI6W10sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., grouping: &quot;month&quot;, startDate: &quot;2022-01-30&quot;, endDate: &quot;2022-01-01&quot;)" time="0.4524740" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected result.StatusCode to be HttpStatusCode.BadRequest {value: 400}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected result.StatusCode to be HttpStatusCode.BadRequest {value: 400}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.EnumAssertions`2.Be(TEnum expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingASingleSubscriptionWithRenders.WhenTokenIsLinkedToFAOrSA.WhenRequestIsNotValid.TheBadRequestStatusCodeIsReturned(Jwt jwt, String grouping, String startDate, String endDate) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 874
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When one of params is not valid. Returns 400BadRequest." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionsIntegrationTests+WhenFetchingASingleSubscriptionWithRenders+WhenTokenIsLinkedToFAOrSA+WhenRequestIsNotValid.TheBadRequestStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MzQ2LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMHxTQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., grouping: &quot;month&quot;, startDate: null, endDate: &quot;2022-01-01&quot;)" time="0.3904421" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected result.StatusCode to be HttpStatusCode.BadRequest {value: 400}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected result.StatusCode to be HttpStatusCode.BadRequest {value: 400}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.EnumAssertions`2.Be(TEnum expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingASingleSubscriptionWithRenders.WhenTokenIsLinkedToFAOrSA.WhenRequestIsNotValid.TheBadRequestStatusCodeIsReturned(Jwt jwt, String grouping, String startDate, String endDate) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 874
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When subscription isn't found. Returns 404NotFound." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionsIntegrationTests+WhenFetchingASingleSubscriptionWithRenders+WhenTokenIsLinkedToFAOrSA+WhenSubscriptionIsNotFound.TheNotFoundStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MzQ3LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIkZBIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vc3Vic2NyaXB0aW9ucyI6W10sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., grouping: &quot;month&quot;, startDate: &quot;2020-01-30&quot;, endDate: &quot;2022-01-01&quot;)" time="0.3444494" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected result.StatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected result.StatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.EnumAssertions`2.Be(TEnum expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingASingleSubscriptionWithRenders.WhenTokenIsLinkedToFAOrSA.WhenSubscriptionIsNotFound.TheNotFoundStatusCodeIsReturned(Jwt jwt, String grouping, String startDate, String endDate) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 2286
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When subscription isn't found. Returns 404NotFound." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionsIntegrationTests+WhenFetchingASingleSubscriptionWithRenders+WhenTokenIsLinkedToFAOrSA+WhenSubscriptionIsNotFound.TheNotFoundStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MzQ3LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMHxTQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., grouping: &quot;year&quot;, startDate: &quot;2020-01-30&quot;, endDate: &quot;2022-01-01&quot;)" time="0.3754036" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected result.StatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected result.StatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.EnumAssertions`2.Be(TEnum expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingASingleSubscriptionWithRenders.WhenTokenIsLinkedToFAOrSA.WhenSubscriptionIsNotFound.TheNotFoundStatusCodeIsReturned(Jwt jwt, String grouping, String startDate, String endDate) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 2286
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When the subscription isn't found. Returns 404HttpNotFound." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionsIntegrationTests+WhenFetchingTheUsersOfASingleSubscriptionUsingTheIdOverload+WhenTokenHasPermissionsOfEAOrSAOrFAOrEU+WhenSubscriptionIsNotFound.AnHttpNotFoundStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MzQ4LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjE4MzNiOThkLWJkYzktNGViMy04MDRjLWU5OTFlMWVhMmFkMnxFQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiOTc5YTQ5NDctZWE4NS00ZWMwLWI1ODgtNzdiMTRkY2QxMWNhIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="4.8561903" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected result.StatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected result.StatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.EnumAssertions`2.Be(TEnum expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingTheUsersOfASingleSubscriptionUsingTheIdOverload.WhenTokenHasPermissionsOfEAOrSAOrFAOrEU.WhenSubscriptionIsNotFound.AnHttpNotFoundStatusCodeIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 2504
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When the subscription isn't found. Returns 404HttpNotFound." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionsIntegrationTests+WhenFetchingTheUsersOfASingleSubscriptionUsingTheIdOverload+WhenTokenHasPermissionsOfEAOrSAOrFAOrEU+WhenSubscriptionIsNotFound.AnHttpNotFoundStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MzQ4LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIkZBIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vc3Vic2NyaXB0aW9ucyI6W10sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.3411415" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected result.StatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected result.StatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.EnumAssertions`2.Be(TEnum expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingTheUsersOfASingleSubscriptionUsingTheIdOverload.WhenTokenHasPermissionsOfEAOrSAOrFAOrEU.WhenSubscriptionIsNotFound.AnHttpNotFoundStatusCodeIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 2504
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When the subscription isn't found. Returns 404HttpNotFound." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionsIntegrationTests+WhenFetchingTheUsersOfASingleSubscriptionUsingTheIdOverload+WhenTokenHasPermissionsOfEAOrSAOrFAOrEU+WhenSubscriptionIsNotFound.AnHttpNotFoundStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MzQ4LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjk3OWE0OTQ3LWVhODUtNGVjMC1iNTg4LTc3YjE0ZGNkMTFjYXxTQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiOTc5YTQ5NDctZWE4NS00ZWMwLWI1ODgtNzdiMTRkY2QxMWNhIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.2690647" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected result.StatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected result.StatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.EnumAssertions`2.Be(TEnum expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingTheUsersOfASingleSubscriptionUsingTheIdOverload.WhenTokenHasPermissionsOfEAOrSAOrFAOrEU.WhenSubscriptionIsNotFound.AnHttpNotFoundStatusCodeIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 2504
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When the subscription isn't found. Returns 404HttpNotFound." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionsIntegrationTests+WhenFetchingTheUsersOfASingleSubscription+WhenTokenHasPermissionsOfEAOrSAOrFAOrEU+WhenSubscriptionIsNotFound.AnHttpNotFoundStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MzUzLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjE4MzNiOThkLWJkYzktNGViMy04MDRjLWU5OTFlMWVhMmFkMnxFQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiOTc5YTQ5NDctZWE4NS00ZWMwLWI1ODgtNzdiMTRkY2QxMWNhIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.2568367" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected result.StatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected result.StatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.EnumAssertions`2.Be(TEnum expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingTheUsersOfASingleSubscription.WhenTokenHasPermissionsOfEAOrSAOrFAOrEU.WhenSubscriptionIsNotFound.AnHttpNotFoundStatusCodeIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 2672
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When the subscription isn't found. Returns 404HttpNotFound." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionsIntegrationTests+WhenFetchingTheUsersOfASingleSubscription+WhenTokenHasPermissionsOfEAOrSAOrFAOrEU+WhenSubscriptionIsNotFound.AnHttpNotFoundStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MzUzLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIkZBIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vc3Vic2NyaXB0aW9ucyI6W10sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.2850033" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected result.StatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected result.StatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.EnumAssertions`2.Be(TEnum expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingTheUsersOfASingleSubscription.WhenTokenHasPermissionsOfEAOrSAOrFAOrEU.WhenSubscriptionIsNotFound.AnHttpNotFoundStatusCodeIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 2672
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When the subscription isn't found. Returns 404HttpNotFound." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionsIntegrationTests+WhenFetchingTheUsersOfASingleSubscription+WhenTokenHasPermissionsOfEAOrSAOrFAOrEU+WhenSubscriptionIsNotFound.AnHttpNotFoundStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MzUzLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjk3OWE0OTQ3LWVhODUtNGVjMC1iNTg4LTc3YjE0ZGNkMTFjYXxTQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiOTc5YTQ5NDctZWE4NS00ZWMwLWI1ODgtNzdiMTRkY2QxMWNhIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.2819875" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected result.StatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected result.StatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.EnumAssertions`2.Be(TEnum expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingTheUsersOfASingleSubscription.WhenTokenHasPermissionsOfEAOrSAOrFAOrEU.WhenSubscriptionIsNotFound.AnHttpNotFoundStatusCodeIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 2672
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When the subscription isn't found. Returns 404HttpNotFound." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionsIntegrationTests+WhenFetchingTheUserOfASingleSubscription+WhenTheTokenHasPermissionsOfEAOrSAOrFA+WhenSubscriptionIsNotFound.AnHttpNotFoundStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MzU0LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjE4MzNiOThkLWJkYzktNGViMy04MDRjLWU5OTFlMWVhMmFkMnxFQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiOTc5YTQ5NDctZWE4NS00ZWMwLWI1ODgtNzdiMTRkY2QxMWNhIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.2775152" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected result.StatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected result.StatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.EnumAssertions`2.Be(TEnum expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingTheUserOfASingleSubscription.WhenTheTokenHasPermissionsOfEAOrSAOrFA.WhenSubscriptionIsNotFound.AnHttpNotFoundStatusCodeIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 2891
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When the subscription isn't found. Returns 404HttpNotFound." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionsIntegrationTests+WhenFetchingTheUserOfASingleSubscription+WhenTheTokenHasPermissionsOfEAOrSAOrFA+WhenSubscriptionIsNotFound.AnHttpNotFoundStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MzU0LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIkZBIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vc3Vic2NyaXB0aW9ucyI6W10sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.3510344" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected result.StatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected result.StatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.EnumAssertions`2.Be(TEnum expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingTheUserOfASingleSubscription.WhenTheTokenHasPermissionsOfEAOrSAOrFA.WhenSubscriptionIsNotFound.AnHttpNotFoundStatusCodeIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 2891
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When the subscription isn't found. Returns 404HttpNotFound." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionsIntegrationTests+WhenFetchingTheUserOfASingleSubscription+WhenTheTokenHasPermissionsOfEAOrSAOrFA+WhenSubscriptionIsNotFound.AnHttpNotFoundStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MzU0LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjk3OWE0OTQ3LWVhODUtNGVjMC1iNTg4LTc3YjE0ZGNkMTFjYXxTQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiOTc5YTQ5NDctZWE4NS00ZWMwLWI1ODgtNzdiMTRkY2QxMWNhIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.3397212" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected result.StatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected result.StatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.EnumAssertions`2.Be(TEnum expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingTheUserOfASingleSubscription.WhenTheTokenHasPermissionsOfEAOrSAOrFA.WhenSubscriptionIsNotFound.AnHttpNotFoundStatusCodeIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 2891
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When token has SA/EA/FA roles. Returns 200OK." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionsIntegrationTests+WhenFetchingSubscriptionEnvironmentRoles+WhenTokenIsLinkedToSAOrEARole+WhenSubscriptionIsFound.AnHttpOkStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MzU1LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIkZBIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vc3Vic2NyaXB0aW9ucyI6W10sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., subscriptionId: 00000000-0000-0000-0000-000000000001, expectedContent: &quot;[\&quot;EA\&quot;,\&quot;EU\&quot;]&quot;)" time="0.1551832" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingSubscriptionEnvironmentRoles.WhenTokenIsLinkedToSAOrEARole.WhenSubscriptionIsFound.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 3147
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingSubscriptionEnvironmentRoles.WhenTokenIsLinkedToSAOrEARole.WhenSubscriptionIsFound.AnHttpOkStatusCodeIsReturned(Jwt jwt, Guid subscriptionId, String expectedContent) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 3107
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When token has SA/EA/FA roles. Returns 200OK." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionsIntegrationTests+WhenFetchingSubscriptionEnvironmentRoles+WhenTokenIsLinkedToSAOrEARole+WhenSubscriptionIsFound.AnHttpOkStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MzU1LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMXxTQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAxIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., subscriptionId: 00000000-0000-0000-0000-000000000001, expectedContent: &quot;[\&quot;EA\&quot;,\&quot;EU\&quot;]&quot;)" time="0.2079428" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingSubscriptionEnvironmentRoles.WhenTokenIsLinkedToSAOrEARole.WhenSubscriptionIsFound.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 3147
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingSubscriptionEnvironmentRoles.WhenTokenIsLinkedToSAOrEARole.WhenSubscriptionIsFound.AnHttpOkStatusCodeIsReturned(Jwt jwt, Guid subscriptionId, String expectedContent) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 3107
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When token has SA/EA/FA roles. Returns 200OK." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionsIntegrationTests+WhenFetchingSubscriptionEnvironmentRoles+WhenTokenIsLinkedToSAOrEARole+WhenSubscriptionIsFound.AnHttpOkStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MzU1LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMXxFQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAxIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., subscriptionId: 00000000-0000-0000-0000-000000000001, expectedContent: &quot;[\&quot;EA\&quot;,\&quot;EU\&quot;]&quot;)" time="0.1640864" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingSubscriptionEnvironmentRoles.WhenTokenIsLinkedToSAOrEARole.WhenSubscriptionIsFound.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 3147
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingSubscriptionEnvironmentRoles.WhenTokenIsLinkedToSAOrEARole.WhenSubscriptionIsFound.AnHttpOkStatusCodeIsReturned(Jwt jwt, Guid subscriptionId, String expectedContent) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 3107
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When token has SA/EA/FA roles. Returns 200OK." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionsIntegrationTests+WhenFetchingSubscriptionEnvironmentRoles+WhenTokenIsLinkedToSAOrEARole+WhenSubscriptionIsFound.AnHttpOkStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MzU1LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIkZBIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vc3Vic2NyaXB0aW9ucyI6W10sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., subscriptionId: 00000000-0000-0000-0000-000000000002, expectedContent: &quot;[\&quot;EA\&quot;,\&quot;EU\&quot;,\&quot;CA\&quot;]&quot;)" time="0.1625551" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingSubscriptionEnvironmentRoles.WhenTokenIsLinkedToSAOrEARole.WhenSubscriptionIsFound.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 3147
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingSubscriptionEnvironmentRoles.WhenTokenIsLinkedToSAOrEARole.WhenSubscriptionIsFound.AnHttpOkStatusCodeIsReturned(Jwt jwt, Guid subscriptionId, String expectedContent) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 3107
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When token has SA/EA/FA roles. Returns 200OK." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionsIntegrationTests+WhenFetchingSubscriptionEnvironmentRoles+WhenTokenIsLinkedToSAOrEARole+WhenSubscriptionIsFound.AnHttpOkStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MzU1LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMnxTQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAyIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., subscriptionId: 00000000-0000-0000-0000-000000000002, expectedContent: &quot;[\&quot;EA\&quot;,\&quot;EU\&quot;,\&quot;CA\&quot;]&quot;)" time="0.1920833" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingSubscriptionEnvironmentRoles.WhenTokenIsLinkedToSAOrEARole.WhenSubscriptionIsFound.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 3147
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingSubscriptionEnvironmentRoles.WhenTokenIsLinkedToSAOrEARole.WhenSubscriptionIsFound.AnHttpOkStatusCodeIsReturned(Jwt jwt, Guid subscriptionId, String expectedContent) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 3107
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When token has SA/EA/FA roles. Returns 200OK." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionsIntegrationTests+WhenFetchingSubscriptionEnvironmentRoles+WhenTokenIsLinkedToSAOrEARole+WhenSubscriptionIsFound.AnHttpOkStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MzU1LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwM3xFQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAyIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., subscriptionId: 00000000-0000-0000-0000-000000000002, expectedContent: &quot;[\&quot;EA\&quot;,\&quot;EU\&quot;,\&quot;CA\&quot;]&quot;)" time="0.1682471" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingSubscriptionEnvironmentRoles.WhenTokenIsLinkedToSAOrEARole.WhenSubscriptionIsFound.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 3147
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingSubscriptionEnvironmentRoles.WhenTokenIsLinkedToSAOrEARole.WhenSubscriptionIsFound.AnHttpOkStatusCodeIsReturned(Jwt jwt, Guid subscriptionId, String expectedContent) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 3107
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When fetching a single subscription by SA, FA. Returns 200OK." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionsIntegrationTests+WhenFetchingASingleSubscription+WhenTokenIsLinkedToFAOrSA+WhenSubscriptionIsFound+WhenSubscriptionIsAccessible.TheSubscriptionIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3Mzc2LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIkZBIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vc3Vic2NyaXB0aW9ucyI6W10sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.2823422" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingASingleSubscription.WhenTokenIsLinkedToFAOrSA.WhenSubscriptionIsFound.WhenSubscriptionIsAccessible.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 564
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingASingleSubscription.WhenTokenIsLinkedToFAOrSA.WhenSubscriptionIsFound.WhenSubscriptionIsAccessible.TheSubscriptionIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 498
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When fetching a single subscription by SA, FA. Returns 200OK." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionsIntegrationTests+WhenFetchingASingleSubscription+WhenTokenIsLinkedToFAOrSA+WhenSubscriptionIsFound+WhenSubscriptionIsAccessible.TheSubscriptionIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3Mzc2LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMHxTQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.1843116" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingASingleSubscription.WhenTokenIsLinkedToFAOrSA.WhenSubscriptionIsFound.WhenSubscriptionIsAccessible.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 564
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingASingleSubscription.WhenTokenIsLinkedToFAOrSA.WhenSubscriptionIsFound.WhenSubscriptionIsAccessible.TheSubscriptionIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 498
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When fetching an inaccessible subscription. Returns 403Forbid." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionsIntegrationTests+WhenFetchingASingleSubscription+WhenTokenIsLinkedToFAOrSA+WhenSubscriptionIsFound+WhenSubscriptionIsNotAccessible.TheForbiddenStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3Mzc3LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjQ2NTliNmM3LWRlYzQtNDE3OS04OGIyLTc5NzY4OThjMTY1YnxTQSIsIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMHxFVSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiNDY1OWI2YzctZGVjNC00MTc5LTg4YjItNzk3Njg5OGMxNjViIiwiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.1837935" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingASingleSubscription.WhenTokenIsLinkedToFAOrSA.WhenSubscriptionIsFound.WhenSubscriptionIsNotAccessible.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 609
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingASingleSubscription.WhenTokenIsLinkedToFAOrSA.WhenSubscriptionIsFound.WhenSubscriptionIsNotAccessible.TheForbiddenStatusCodeIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 593
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When fetching an inaccessible subscription. Returns 403Forbid." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionsIntegrationTests+WhenFetchingASingleSubscription+WhenTokenIsLinkedToFAOrSA+WhenSubscriptionIsFound+WhenSubscriptionIsNotAccessible.TheForbiddenStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3Mzc3LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbImIwZTZkMjlhLWZkMmMtNGE5Ni1iNTc0LTJkM2IxYmU1ZGYzNHxTQSIsIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMHxFQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiYjBlNmQyOWEtZmQyYy00YTk2LWI1NzQtMmQzYjFiZTVkZjM0IiwiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.2269222" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingASingleSubscription.WhenTokenIsLinkedToFAOrSA.WhenSubscriptionIsFound.WhenSubscriptionIsNotAccessible.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 609
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingASingleSubscription.WhenTokenIsLinkedToFAOrSA.WhenSubscriptionIsFound.WhenSubscriptionIsNotAccessible.TheForbiddenStatusCodeIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 593
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When subscription isn't accessible. Returns 403Forbid." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionsIntegrationTests+WhenFetchingASingleSubscriptionWithRenders+WhenTokenIsLinkedToFAOrSA+WhenSubscriptionIsFound+WhenSubscriptionIsNotAccessible.TheNotFoundStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3Mzc3LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjFmNTgwOTg4LTQxZTgtNGRjMC1hZjJmLTJkY2RmMTY2MzBkZXxTQSIsIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMHxFQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMWY1ODA5ODgtNDFlOC00ZGMwLWFmMmYtMmRjZGYxNjYzMGRlIiwiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., grouping: &quot;year&quot;, startDate: &quot;2020-01-30&quot;, endDate: &quot;2022-01-01&quot;)" time="0.2618060" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingASingleSubscriptionWithRenders.WhenTokenIsLinkedToFAOrSA.WhenSubscriptionIsFound.WhenSubscriptionIsNotAccessible.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 2242
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingASingleSubscriptionWithRenders.WhenTokenIsLinkedToFAOrSA.WhenSubscriptionIsFound.WhenSubscriptionIsNotAccessible.TheNotFoundStatusCodeIsReturned(Jwt jwt, String grouping, String startDate, String endDate) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 2226
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When subscription isn't accessible. Returns 403Forbid." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionsIntegrationTests+WhenFetchingASingleSubscriptionWithRenders+WhenTokenIsLinkedToFAOrSA+WhenSubscriptionIsFound+WhenSubscriptionIsNotAccessible.TheNotFoundStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3Mzc3LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjQ2OTdiZTE1LWI5NzEtNGRiMy04OGVkLTA5NzQ4NzM5MWI4YXxTQSIsIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMHxFVSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiNDY5N2JlMTUtYjk3MS00ZGIzLTg4ZWQtMDk3NDg3MzkxYjhhIiwiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., grouping: &quot;month&quot;, startDate: &quot;2020-01-30&quot;, endDate: &quot;2020-02-10&quot;)" time="0.3431124" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingASingleSubscriptionWithRenders.WhenTokenIsLinkedToFAOrSA.WhenSubscriptionIsFound.WhenSubscriptionIsNotAccessible.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 2242
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingASingleSubscriptionWithRenders.WhenTokenIsLinkedToFAOrSA.WhenSubscriptionIsFound.WhenSubscriptionIsNotAccessible.TheNotFoundStatusCodeIsReturned(Jwt jwt, String grouping, String startDate, String endDate) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 2226
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="Accessible users are returned to SA, FA, EA, EU. Returns 200HttpOK" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionsIntegrationTests+WhenFetchingTheUsersOfASingleSubscriptionUsingTheIdOverload+WhenTokenHasPermissionsOfEAOrSAOrFAOrEU+WhenSubscriptionIsFound+WhenSubscriptionIsAccessible.SubscriptionUsersAreReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3Mzc4LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjE4MzNiOThkLWJkYzktNGViMy04MDRjLWU5OTFlMWVhMmFkMnxFVSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiOTc5YTQ5NDctZWE4NS00ZWMwLWI1ODgtNzdiMTRkY2QxMWNhIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., expectedContent: &quot;[{\&quot;id\&quot;:\&quot;subscriptionAdministrator\&quot;,\&quot;email\&quot;:\&quot;...)" time="0.2676545" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingTheUsersOfASingleSubscriptionUsingTheIdOverload.WhenTokenHasPermissionsOfEAOrSAOrFAOrEU.WhenSubscriptionIsFound.WhenSubscriptionIsAccessible.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 2441
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingTheUsersOfASingleSubscriptionUsingTheIdOverload.WhenTokenHasPermissionsOfEAOrSAOrFAOrEU.WhenSubscriptionIsFound.WhenSubscriptionIsAccessible.SubscriptionUsersAreReturned(Jwt jwt, String expectedContent) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 2419
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="Accessible users are returned to SA, FA, EA, EU. Returns 200HttpOK" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionsIntegrationTests+WhenFetchingTheUsersOfASingleSubscriptionUsingTheIdOverload+WhenTokenHasPermissionsOfEAOrSAOrFAOrEU+WhenSubscriptionIsFound+WhenSubscriptionIsAccessible.SubscriptionUsersAreReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3Mzc4LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjE4MzNiOThkLWJkYzktNGViMy04MDRjLWU5OTFlMWVhMmFkMnxFQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiOTc5YTQ5NDctZWE4NS00ZWMwLWI1ODgtNzdiMTRkY2QxMWNhIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., expectedContent: &quot;[{\&quot;id\&quot;:\&quot;subscriptionAdministrator\&quot;,\&quot;email\&quot;:\&quot;...)" time="0.1996593" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingTheUsersOfASingleSubscriptionUsingTheIdOverload.WhenTokenHasPermissionsOfEAOrSAOrFAOrEU.WhenSubscriptionIsFound.WhenSubscriptionIsAccessible.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 2441
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingTheUsersOfASingleSubscriptionUsingTheIdOverload.WhenTokenHasPermissionsOfEAOrSAOrFAOrEU.WhenSubscriptionIsFound.WhenSubscriptionIsAccessible.SubscriptionUsersAreReturned(Jwt jwt, String expectedContent) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 2419
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="Accessible users are returned to SA, FA, EA, EU. Returns 200HttpOK" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionsIntegrationTests+WhenFetchingTheUsersOfASingleSubscriptionUsingTheIdOverload+WhenTokenHasPermissionsOfEAOrSAOrFAOrEU+WhenSubscriptionIsFound+WhenSubscriptionIsAccessible.SubscriptionUsersAreReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3Mzc4LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIkZBIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vc3Vic2NyaXB0aW9ucyI6W10sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., expectedContent: &quot;[{\&quot;id\&quot;:\&quot;subscriptionAdministrator\&quot;,\&quot;email\&quot;:\&quot;...)" time="0.1727200" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingTheUsersOfASingleSubscriptionUsingTheIdOverload.WhenTokenHasPermissionsOfEAOrSAOrFAOrEU.WhenSubscriptionIsFound.WhenSubscriptionIsAccessible.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 2441
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingTheUsersOfASingleSubscriptionUsingTheIdOverload.WhenTokenHasPermissionsOfEAOrSAOrFAOrEU.WhenSubscriptionIsFound.WhenSubscriptionIsAccessible.SubscriptionUsersAreReturned(Jwt jwt, String expectedContent) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 2419
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="Accessible users are returned to SA, FA, EA, EU. Returns 200HttpOK" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionsIntegrationTests+WhenFetchingTheUsersOfASingleSubscriptionUsingTheIdOverload+WhenTokenHasPermissionsOfEAOrSAOrFAOrEU+WhenSubscriptionIsFound+WhenSubscriptionIsAccessible.SubscriptionUsersAreReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3Mzc4LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjE4MzNiOThkLWJkYzktNGViMy04MDRjLWU5OTFlMWVhMmFkMnxFQSIsImJlNDc1YmVjLTlkNDEtNDFmNS1hMWQxLTk4YzFhZmZiMzBkNHxFVSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiOTc5YTQ5NDctZWE4NS00ZWMwLWI1ODgtNzdiMTRkY2QxMWNhIiwiOTc5YTQ5NDctZWE4NS00ZWMwLWI1ODgtNzdiMTRkY2QxMWNhIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., expectedContent: &quot;[{\&quot;id\&quot;:\&quot;subscriptionAdministrator\&quot;,\&quot;email\&quot;:\&quot;...)" time="0.1674089" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingTheUsersOfASingleSubscriptionUsingTheIdOverload.WhenTokenHasPermissionsOfEAOrSAOrFAOrEU.WhenSubscriptionIsFound.WhenSubscriptionIsAccessible.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 2441
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingTheUsersOfASingleSubscriptionUsingTheIdOverload.WhenTokenHasPermissionsOfEAOrSAOrFAOrEU.WhenSubscriptionIsFound.WhenSubscriptionIsAccessible.SubscriptionUsersAreReturned(Jwt jwt, String expectedContent) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 2419
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="Accessible users are returned to SA, FA, EA, EU. Returns 200HttpOK" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionsIntegrationTests+WhenFetchingTheUsersOfASingleSubscriptionUsingTheIdOverload+WhenTokenHasPermissionsOfEAOrSAOrFAOrEU+WhenSubscriptionIsFound+WhenSubscriptionIsAccessible.SubscriptionUsersAreReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3Mzc4LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjk3OWE0OTQ3LWVhODUtNGVjMC1iNTg4LTc3YjE0ZGNkMTFjYXxTQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiOTc5YTQ5NDctZWE4NS00ZWMwLWI1ODgtNzdiMTRkY2QxMWNhIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., expectedContent: &quot;[{\&quot;id\&quot;:\&quot;subscriptionAdministrator\&quot;,\&quot;email\&quot;:\&quot;...)" time="0.1726011" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingTheUsersOfASingleSubscriptionUsingTheIdOverload.WhenTokenHasPermissionsOfEAOrSAOrFAOrEU.WhenSubscriptionIsFound.WhenSubscriptionIsAccessible.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 2441
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingTheUsersOfASingleSubscriptionUsingTheIdOverload.WhenTokenHasPermissionsOfEAOrSAOrFAOrEU.WhenSubscriptionIsFound.WhenSubscriptionIsAccessible.SubscriptionUsersAreReturned(Jwt jwt, String expectedContent) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 2419
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When the token has no permissions. Returns 403HttpForbidden." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionsIntegrationTests+WhenFetchingTheUsersOfASingleSubscriptionUsingTheIdOverload+WhenTokenHasPermissionsOfEAOrSAOrFAOrEU+WhenSubscriptionIsFound+WhenSubscriptionIsNotAccessible.AnHttpForbiddenStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3Mzc5LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjk3OWE0OTQ3LWVhODUtNGVjMC1iNTg4LTc3YjE0ZGNkMTFjYXxURCJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiOTc5YTQ5NDctZWE4NS00ZWMwLWI1ODgtNzdiMTRkY2QxMWNhIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.1681849" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingTheUsersOfASingleSubscriptionUsingTheIdOverload.WhenTokenHasPermissionsOfEAOrSAOrFAOrEU.WhenSubscriptionIsFound.WhenSubscriptionIsNotAccessible.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 2475
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingTheUsersOfASingleSubscriptionUsingTheIdOverload.WhenTokenHasPermissionsOfEAOrSAOrFAOrEU.WhenSubscriptionIsFound.WhenSubscriptionIsNotAccessible.AnHttpForbiddenStatusCodeIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 2459
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When the token has no permissions. Returns 403HttpForbidden." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionsIntegrationTests+WhenFetchingTheUsersOfASingleSubscriptionUsingTheIdOverload+WhenTokenHasPermissionsOfEAOrSAOrFAOrEU+WhenSubscriptionIsFound+WhenSubscriptionIsNotAccessible.AnHttpForbiddenStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3Mzc5LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjE4MzNiOThkLWJkYzktNGViMy04MDRjLWU5OTFlMWVhMmFkMnxTVSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiOTc5YTQ5NDctZWE4NS00ZWMwLWI1ODgtNzdiMTRkY2QxMWNhIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.1693987" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingTheUsersOfASingleSubscriptionUsingTheIdOverload.WhenTokenHasPermissionsOfEAOrSAOrFAOrEU.WhenSubscriptionIsFound.WhenSubscriptionIsNotAccessible.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 2475
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingTheUsersOfASingleSubscriptionUsingTheIdOverload.WhenTokenHasPermissionsOfEAOrSAOrFAOrEU.WhenSubscriptionIsFound.WhenSubscriptionIsNotAccessible.AnHttpForbiddenStatusCodeIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 2459
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When the token has no permissions. Returns 403HttpForbidden." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionsIntegrationTests+WhenFetchingTheUsersOfASingleSubscriptionUsingTheIdOverload+WhenTokenHasPermissionsOfEAOrSAOrFAOrEU+WhenSubscriptionIsFound+WhenSubscriptionIsNotAccessible.AnHttpForbiddenStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3Mzc5LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjE4MzNiOThkLWJkYzktNGViMy04MDRjLWU5OTFlMWVhMmFkMnxTVSIsIjY4ZDNmOWUwLTJmMWMtNGRhZC1hMDQ2LTJiYmM1MjIxNDhkZHxFQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiOTc5YTQ5NDctZWE4NS00ZWMwLWI1ODgtNzdiMTRkY2QxMWNhIiwiM2UyMjFjYmQtNTI1OC00NDExLTlmYjQtNWI5NjJiOGRlNGU5Il0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.1727100" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingTheUsersOfASingleSubscriptionUsingTheIdOverload.WhenTokenHasPermissionsOfEAOrSAOrFAOrEU.WhenSubscriptionIsFound.WhenSubscriptionIsNotAccessible.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 2475
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingTheUsersOfASingleSubscriptionUsingTheIdOverload.WhenTokenHasPermissionsOfEAOrSAOrFAOrEU.WhenSubscriptionIsFound.WhenSubscriptionIsNotAccessible.AnHttpForbiddenStatusCodeIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 2459
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="Accessible users are returned to SA, FA, EA, EU. Returns 200HttpOK" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionsIntegrationTests+WhenFetchingTheUsersOfASingleSubscription+WhenTokenHasPermissionsOfEAOrSAOrFAOrEU+WhenSubscriptionIsFound+WhenSubscriptionIsAccessible.SubscriptionUsersAreReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3Mzc5LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjE4MzNiOThkLWJkYzktNGViMy04MDRjLWU5OTFlMWVhMmFkMnxFVSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiOTc5YTQ5NDctZWE4NS00ZWMwLWI1ODgtNzdiMTRkY2QxMWNhIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., expectedContent: &quot;[{\&quot;id\&quot;:\&quot;subscriptionAdministrator\&quot;,\&quot;email\&quot;:\&quot;...)" time="0.1717947" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingTheUsersOfASingleSubscription.WhenTokenHasPermissionsOfEAOrSAOrFAOrEU.WhenSubscriptionIsFound.WhenSubscriptionIsAccessible.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 2603
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingTheUsersOfASingleSubscription.WhenTokenHasPermissionsOfEAOrSAOrFAOrEU.WhenSubscriptionIsFound.WhenSubscriptionIsAccessible.SubscriptionUsersAreReturned(Jwt jwt, String expectedContent) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 2574
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="Accessible users are returned to SA, FA, EA, EU. Returns 200HttpOK" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionsIntegrationTests+WhenFetchingTheUsersOfASingleSubscription+WhenTokenHasPermissionsOfEAOrSAOrFAOrEU+WhenSubscriptionIsFound+WhenSubscriptionIsAccessible.SubscriptionUsersAreReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3Mzc5LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjE4MzNiOThkLWJkYzktNGViMy04MDRjLWU5OTFlMWVhMmFkMnxFQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiOTc5YTQ5NDctZWE4NS00ZWMwLWI1ODgtNzdiMTRkY2QxMWNhIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., expectedContent: &quot;[{\&quot;id\&quot;:\&quot;subscriptionAdministrator\&quot;,\&quot;email\&quot;:\&quot;...)" time="0.1636771" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingTheUsersOfASingleSubscription.WhenTokenHasPermissionsOfEAOrSAOrFAOrEU.WhenSubscriptionIsFound.WhenSubscriptionIsAccessible.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 2603
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingTheUsersOfASingleSubscription.WhenTokenHasPermissionsOfEAOrSAOrFAOrEU.WhenSubscriptionIsFound.WhenSubscriptionIsAccessible.SubscriptionUsersAreReturned(Jwt jwt, String expectedContent) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 2574
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="Accessible users are returned to SA, FA, EA, EU. Returns 200HttpOK" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionsIntegrationTests+WhenFetchingTheUsersOfASingleSubscription+WhenTokenHasPermissionsOfEAOrSAOrFAOrEU+WhenSubscriptionIsFound+WhenSubscriptionIsAccessible.SubscriptionUsersAreReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3Mzc5LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIkZBIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vc3Vic2NyaXB0aW9ucyI6W10sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., expectedContent: &quot;[{\&quot;id\&quot;:\&quot;subscriptionAdministrator\&quot;,\&quot;email\&quot;:\&quot;...)" time="0.1898912" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingTheUsersOfASingleSubscription.WhenTokenHasPermissionsOfEAOrSAOrFAOrEU.WhenSubscriptionIsFound.WhenSubscriptionIsAccessible.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 2603
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingTheUsersOfASingleSubscription.WhenTokenHasPermissionsOfEAOrSAOrFAOrEU.WhenSubscriptionIsFound.WhenSubscriptionIsAccessible.SubscriptionUsersAreReturned(Jwt jwt, String expectedContent) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 2574
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="Accessible users are returned to SA, FA, EA, EU. Returns 200HttpOK" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionsIntegrationTests+WhenFetchingTheUsersOfASingleSubscription+WhenTokenHasPermissionsOfEAOrSAOrFAOrEU+WhenSubscriptionIsFound+WhenSubscriptionIsAccessible.SubscriptionUsersAreReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3Mzc5LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjE4MzNiOThkLWJkYzktNGViMy04MDRjLWU5OTFlMWVhMmFkMnxFQSIsImJlNDc1YmVjLTlkNDEtNDFmNS1hMWQxLTk4YzFhZmZiMzBkNHxFVSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiOTc5YTQ5NDctZWE4NS00ZWMwLWI1ODgtNzdiMTRkY2QxMWNhIiwiOTc5YTQ5NDctZWE4NS00ZWMwLWI1ODgtNzdiMTRkY2QxMWNhIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., expectedContent: &quot;[{\&quot;id\&quot;:\&quot;subscriptionAdministrator\&quot;,\&quot;email\&quot;:\&quot;...)" time="0.1940463" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingTheUsersOfASingleSubscription.WhenTokenHasPermissionsOfEAOrSAOrFAOrEU.WhenSubscriptionIsFound.WhenSubscriptionIsAccessible.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 2603
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingTheUsersOfASingleSubscription.WhenTokenHasPermissionsOfEAOrSAOrFAOrEU.WhenSubscriptionIsFound.WhenSubscriptionIsAccessible.SubscriptionUsersAreReturned(Jwt jwt, String expectedContent) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 2574
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="Accessible users are returned to SA, FA, EA, EU. Returns 200HttpOK" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionsIntegrationTests+WhenFetchingTheUsersOfASingleSubscription+WhenTokenHasPermissionsOfEAOrSAOrFAOrEU+WhenSubscriptionIsFound+WhenSubscriptionIsAccessible.SubscriptionUsersAreReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3Mzc5LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjk3OWE0OTQ3LWVhODUtNGVjMC1iNTg4LTc3YjE0ZGNkMTFjYXxTQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiOTc5YTQ5NDctZWE4NS00ZWMwLWI1ODgtNzdiMTRkY2QxMWNhIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., expectedContent: &quot;[{\&quot;id\&quot;:\&quot;subscriptionAdministrator\&quot;,\&quot;email\&quot;:\&quot;...)" time="0.1668232" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingTheUsersOfASingleSubscription.WhenTokenHasPermissionsOfEAOrSAOrFAOrEU.WhenSubscriptionIsFound.WhenSubscriptionIsAccessible.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 2603
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingTheUsersOfASingleSubscription.WhenTokenHasPermissionsOfEAOrSAOrFAOrEU.WhenSubscriptionIsFound.WhenSubscriptionIsAccessible.SubscriptionUsersAreReturned(Jwt jwt, String expectedContent) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 2574
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When the token has no permissions. Returns 403HttpForbidden." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionsIntegrationTests+WhenFetchingTheUsersOfASingleSubscription+WhenTokenHasPermissionsOfEAOrSAOrFAOrEU+WhenSubscriptionIsFound+WhenSubscriptionIsNotAccessible.AnHttpForbiddenStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MzgwLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjk3OWE0OTQ3LWVhODUtNGVjMC1iNTg4LTc3YjE0ZGNkMTFjYXxURCJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiOTc5YTQ5NDctZWE4NS00ZWMwLWI1ODgtNzdiMTRkY2QxMWNhIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.2139155" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingTheUsersOfASingleSubscription.WhenTokenHasPermissionsOfEAOrSAOrFAOrEU.WhenSubscriptionIsFound.WhenSubscriptionIsNotAccessible.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 2643
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingTheUsersOfASingleSubscription.WhenTokenHasPermissionsOfEAOrSAOrFAOrEU.WhenSubscriptionIsFound.WhenSubscriptionIsNotAccessible.AnHttpForbiddenStatusCodeIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 2621
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When the token has no permissions. Returns 403HttpForbidden." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionsIntegrationTests+WhenFetchingTheUsersOfASingleSubscription+WhenTokenHasPermissionsOfEAOrSAOrFAOrEU+WhenSubscriptionIsFound+WhenSubscriptionIsNotAccessible.AnHttpForbiddenStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MzgwLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjE4MzNiOThkLWJkYzktNGViMy04MDRjLWU5OTFlMWVhMmFkMnxTVSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiOTc5YTQ5NDctZWE4NS00ZWMwLWI1ODgtNzdiMTRkY2QxMWNhIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.1731312" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingTheUsersOfASingleSubscription.WhenTokenHasPermissionsOfEAOrSAOrFAOrEU.WhenSubscriptionIsFound.WhenSubscriptionIsNotAccessible.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 2643
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingTheUsersOfASingleSubscription.WhenTokenHasPermissionsOfEAOrSAOrFAOrEU.WhenSubscriptionIsFound.WhenSubscriptionIsNotAccessible.AnHttpForbiddenStatusCodeIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 2621
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When the token has no permissions. Returns 403HttpForbidden." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionsIntegrationTests+WhenFetchingTheUsersOfASingleSubscription+WhenTokenHasPermissionsOfEAOrSAOrFAOrEU+WhenSubscriptionIsFound+WhenSubscriptionIsNotAccessible.AnHttpForbiddenStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MzgwLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjE4MzNiOThkLWJkYzktNGViMy04MDRjLWU5OTFlMWVhMmFkMnxTVSIsIjYyMTFlOGU5LTA2NGQtNGZlZi04MTRkLTQ1YjJmNTE3ZGE1OXxFQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiOTc5YTQ5NDctZWE4NS00ZWMwLWI1ODgtNzdiMTRkY2QxMWNhIiwiYjk0YzQzYWUtZjgzNC00YmQ5LWFjYzItNjNjZmQzMDcyNGZjIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.1797347" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingTheUsersOfASingleSubscription.WhenTokenHasPermissionsOfEAOrSAOrFAOrEU.WhenSubscriptionIsFound.WhenSubscriptionIsNotAccessible.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 2643
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingTheUsersOfASingleSubscription.WhenTokenHasPermissionsOfEAOrSAOrFAOrEU.WhenSubscriptionIsFound.WhenSubscriptionIsNotAccessible.AnHttpForbiddenStatusCodeIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 2621
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="Accessible user is returned to SA, FA, EA. Returns 200HttpOK." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionsIntegrationTests+WhenFetchingTheUserOfASingleSubscription+WhenTheTokenHasPermissionsOfEAOrSAOrFA+WhenSubscriptionIsFound+WhenUserAccessible.SubscriptionUserIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MzgxLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjE4MzNiOThkLWJkYzktNGViMy04MDRjLWU5OTFlMWVhMmFkMnxFQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiOTc5YTQ5NDctZWE4NS00ZWMwLWI1ODgtNzdiMTRkY2QxMWNhIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., userId: &quot;subscriptionAdministrator&quot;, expectedContent: &quot;{\&quot;id\&quot;:\&quot;subscriptionAdministrator\&quot;,\&quot;email\&quot;:\&quot;&quot;...)" time="0.1756497" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingTheUserOfASingleSubscription.WhenTheTokenHasPermissionsOfEAOrSAOrFA.WhenSubscriptionIsFound.WhenUserAccessible.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 2781
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingTheUserOfASingleSubscription.WhenTheTokenHasPermissionsOfEAOrSAOrFA.WhenSubscriptionIsFound.WhenUserAccessible.SubscriptionUserIsReturned(Jwt jwt, String userId, String expectedContent) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 2752
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="Accessible user is returned to SA, FA, EA. Returns 200HttpOK." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionsIntegrationTests+WhenFetchingTheUserOfASingleSubscription+WhenTheTokenHasPermissionsOfEAOrSAOrFA+WhenSubscriptionIsFound+WhenUserAccessible.SubscriptionUserIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MzgxLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIkZBIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vc3Vic2NyaXB0aW9ucyI6W10sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., userId: &quot;environmentUserEnv2&quot;, expectedContent: &quot;{\&quot;id\&quot;:\&quot;environmentUserEnv2\&quot;,\&quot;email\&quot;:\&quot;userEu&quot;...)" time="0.1676960" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingTheUserOfASingleSubscription.WhenTheTokenHasPermissionsOfEAOrSAOrFA.WhenSubscriptionIsFound.WhenUserAccessible.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 2781
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingTheUserOfASingleSubscription.WhenTheTokenHasPermissionsOfEAOrSAOrFA.WhenSubscriptionIsFound.WhenUserAccessible.SubscriptionUserIsReturned(Jwt jwt, String userId, String expectedContent) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 2752
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="Accessible user is returned to SA, FA, EA. Returns 200HttpOK." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionsIntegrationTests+WhenFetchingTheUserOfASingleSubscription+WhenTheTokenHasPermissionsOfEAOrSAOrFA+WhenSubscriptionIsFound+WhenUserAccessible.SubscriptionUserIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MzgxLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjk3OWE0OTQ3LWVhODUtNGVjMC1iNTg4LTc3YjE0ZGNkMTFjYXxTQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiOTc5YTQ5NDctZWE4NS00ZWMwLWI1ODgtNzdiMTRkY2QxMWNhIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., userId: &quot;environmentUserEnv1&quot;, expectedContent: &quot;{\&quot;id\&quot;:\&quot;environmentUserEnv1\&quot;,\&quot;email\&quot;:\&quot;userEu&quot;...)" time="0.1667934" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingTheUserOfASingleSubscription.WhenTheTokenHasPermissionsOfEAOrSAOrFA.WhenSubscriptionIsFound.WhenUserAccessible.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 2781
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingTheUserOfASingleSubscription.WhenTheTokenHasPermissionsOfEAOrSAOrFA.WhenSubscriptionIsFound.WhenUserAccessible.SubscriptionUserIsReturned(Jwt jwt, String userId, String expectedContent) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 2752
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="Accessible user is returned to SA, FA, EA. Returns 200HttpOK." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionsIntegrationTests+WhenFetchingTheUserOfASingleSubscription+WhenTheTokenHasPermissionsOfEAOrSAOrFA+WhenSubscriptionIsFound+WhenUserAccessible.SubscriptionUserIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MzgxLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjk3OWE0OTQ3LWVhODUtNGVjMC1iNTg4LTc3YjE0ZGNkMTFjYXxTQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiOTc5YTQ5NDctZWE4NS00ZWMwLWI1ODgtNzdiMTRkY2QxMWNhIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., userId: &quot;userWithNoRolesInSubscription&quot;, expectedContent: &quot;{\&quot;id\&quot;:\&quot;userWithNoRolesInSubscription\&quot;,\&quot;email\&quot;...)" time="0.1753766" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingTheUserOfASingleSubscription.WhenTheTokenHasPermissionsOfEAOrSAOrFA.WhenSubscriptionIsFound.WhenUserAccessible.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 2781
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingTheUserOfASingleSubscription.WhenTheTokenHasPermissionsOfEAOrSAOrFA.WhenSubscriptionIsFound.WhenUserAccessible.SubscriptionUserIsReturned(Jwt jwt, String userId, String expectedContent) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 2752
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="Accessible user is returned to SA, FA, EA. Returns 200HttpOK." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionsIntegrationTests+WhenFetchingTheUserOfASingleSubscription+WhenTheTokenHasPermissionsOfEAOrSAOrFA+WhenSubscriptionIsFound+WhenUserAccessible.SubscriptionUserIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MzgxLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIkZBIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vc3Vic2NyaXB0aW9ucyI6W10sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., userId: &quot;userWithNoRolesInSubscription&quot;, expectedContent: &quot;{\&quot;id\&quot;:\&quot;userWithNoRolesInSubscription\&quot;,\&quot;email\&quot;...)" time="0.2128278" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingTheUserOfASingleSubscription.WhenTheTokenHasPermissionsOfEAOrSAOrFA.WhenSubscriptionIsFound.WhenUserAccessible.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 2781
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingTheUserOfASingleSubscription.WhenTheTokenHasPermissionsOfEAOrSAOrFA.WhenSubscriptionIsFound.WhenUserAccessible.SubscriptionUserIsReturned(Jwt jwt, String userId, String expectedContent) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 2752
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="Accessible user is returned to SA, FA, EA. Returns 200HttpOK." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionsIntegrationTests+WhenFetchingTheUserOfASingleSubscription+WhenTheTokenHasPermissionsOfEAOrSAOrFA+WhenSubscriptionIsFound+WhenUserAccessible.SubscriptionUserIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MzgxLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIkZBIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vc3Vic2NyaXB0aW9ucyI6W10sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., userId: &quot;environmentUserEnv2UserEnv1&quot;, expectedContent: &quot;{\&quot;id\&quot;:\&quot;environmentUserEnv2UserEnv1\&quot;,\&quot;email\&quot;:&quot;...)" time="0.2425368" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingTheUserOfASingleSubscription.WhenTheTokenHasPermissionsOfEAOrSAOrFA.WhenSubscriptionIsFound.WhenUserAccessible.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 2781
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingTheUserOfASingleSubscription.WhenTheTokenHasPermissionsOfEAOrSAOrFA.WhenSubscriptionIsFound.WhenUserAccessible.SubscriptionUserIsReturned(Jwt jwt, String userId, String expectedContent) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 2752
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="Accessible user is returned to SA, FA, EA. Returns 200HttpOK." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionsIntegrationTests+WhenFetchingTheUserOfASingleSubscription+WhenTheTokenHasPermissionsOfEAOrSAOrFA+WhenSubscriptionIsFound+WhenUserAccessible.SubscriptionUserIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MzgxLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjk3OWE0OTQ3LWVhODUtNGVjMC1iNTg4LTc3YjE0ZGNkMTFjYXxTQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiOTc5YTQ5NDctZWE4NS00ZWMwLWI1ODgtNzdiMTRkY2QxMWNhIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., userId: &quot;environmentUserEnv2UserEnv1&quot;, expectedContent: &quot;{\&quot;id\&quot;:\&quot;environmentUserEnv2UserEnv1\&quot;,\&quot;email\&quot;:&quot;...)" time="0.2320905" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingTheUserOfASingleSubscription.WhenTheTokenHasPermissionsOfEAOrSAOrFA.WhenSubscriptionIsFound.WhenUserAccessible.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 2781
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingTheUserOfASingleSubscription.WhenTheTokenHasPermissionsOfEAOrSAOrFA.WhenSubscriptionIsFound.WhenUserAccessible.SubscriptionUserIsReturned(Jwt jwt, String userId, String expectedContent) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 2752
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="Accessible user is returned to SA, FA, EA. Returns 200HttpOK." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionsIntegrationTests+WhenFetchingTheUserOfASingleSubscription+WhenTheTokenHasPermissionsOfEAOrSAOrFA+WhenSubscriptionIsFound+WhenUserAccessible.SubscriptionUserIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MzgxLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjE4MzNiOThkLWJkYzktNGViMy04MDRjLWU5OTFlMWVhMmFkMnxFQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiOTc5YTQ5NDctZWE4NS00ZWMwLWI1ODgtNzdiMTRkY2QxMWNhIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., userId: &quot;environmentUserEnv2UserEnv1&quot;, expectedContent: &quot;{\&quot;id\&quot;:\&quot;environmentUserEnv2UserEnv1\&quot;,\&quot;email\&quot;:&quot;...)" time="0.2382226" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingTheUserOfASingleSubscription.WhenTheTokenHasPermissionsOfEAOrSAOrFA.WhenSubscriptionIsFound.WhenUserAccessible.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 2781
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingTheUserOfASingleSubscription.WhenTheTokenHasPermissionsOfEAOrSAOrFA.WhenSubscriptionIsFound.WhenUserAccessible.SubscriptionUserIsReturned(Jwt jwt, String userId, String expectedContent) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 2752
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="Accessible user is returned to SA, FA, EA. Returns 200HttpOK." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionsIntegrationTests+WhenFetchingTheUserOfASingleSubscription+WhenTheTokenHasPermissionsOfEAOrSAOrFA+WhenSubscriptionIsFound+WhenUserAccessible.SubscriptionUserIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MzgxLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjE4MzNiOThkLWJkYzktNGViMy04MDRjLWU5OTFlMWVhMmFkMnxFQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiOTc5YTQ5NDctZWE4NS00ZWMwLWI1ODgtNzdiMTRkY2QxMWNhIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., userId: &quot;environmentUserEnv2UserEnv1&quot;, expectedContent: &quot;{\&quot;id\&quot;:\&quot;environmentUserEnv2UserEnv1\&quot;,\&quot;email\&quot;:&quot;...)" time="0.2079092" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingTheUserOfASingleSubscription.WhenTheTokenHasPermissionsOfEAOrSAOrFA.WhenSubscriptionIsFound.WhenUserAccessible.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 2781
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingTheUserOfASingleSubscription.WhenTheTokenHasPermissionsOfEAOrSAOrFA.WhenSubscriptionIsFound.WhenUserAccessible.SubscriptionUserIsReturned(Jwt jwt, String userId, String expectedContent) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 2752
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="Accessible user is returned to SA, FA, EA. Returns 200HttpOK." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionsIntegrationTests+WhenFetchingTheUserOfASingleSubscription+WhenTheTokenHasPermissionsOfEAOrSAOrFA+WhenSubscriptionIsFound+WhenUserAccessible.SubscriptionUserIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MzgxLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjE4MzNiOThkLWJkYzktNGViMy04MDRjLWU5OTFlMWVhMmFkMnxFQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiOTc5YTQ5NDctZWE4NS00ZWMwLWI1ODgtNzdiMTRkY2QxMWNhIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., userId: &quot;subscriptionAdministratorDeactivated&quot;, expectedContent: &quot;{\&quot;id\&quot;:\&quot;subscriptionAdministratorDeactivated\&quot;,\&quot;...)" time="0.2679430" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingTheUserOfASingleSubscription.WhenTheTokenHasPermissionsOfEAOrSAOrFA.WhenSubscriptionIsFound.WhenUserAccessible.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 2781
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingTheUserOfASingleSubscription.WhenTheTokenHasPermissionsOfEAOrSAOrFA.WhenSubscriptionIsFound.WhenUserAccessible.SubscriptionUserIsReturned(Jwt jwt, String userId, String expectedContent) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 2752
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="User wasn't found by EA, SA, FA. Returns 404HttpNotFound." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionsIntegrationTests+WhenFetchingTheUserOfASingleSubscription+WhenTheTokenHasPermissionsOfEAOrSAOrFA+WhenSubscriptionIsFound+WhenUserIsNotFound.AnHttpNotFoundStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MzgzLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjE4MzNiOThkLWJkYzktNGViMy04MDRjLWU5OTFlMWVhMmFkMnxFQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiOTc5YTQ5NDctZWE4NS00ZWMwLWI1ODgtNzdiMTRkY2QxMWNhIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., userId: &quot;userId2b565164-fcf0-4f86-897d-4676a9cfda39&quot;)" time="0.2202639" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingTheUserOfASingleSubscription.WhenTheTokenHasPermissionsOfEAOrSAOrFA.WhenSubscriptionIsFound.WhenUserIsNotFound.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 2821
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingTheUserOfASingleSubscription.WhenTheTokenHasPermissionsOfEAOrSAOrFA.WhenSubscriptionIsFound.WhenUserIsNotFound.AnHttpNotFoundStatusCodeIsReturned(Jwt jwt, String userId) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 2799
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="User wasn't found by EA, SA, FA. Returns 404HttpNotFound." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionsIntegrationTests+WhenFetchingTheUserOfASingleSubscription+WhenTheTokenHasPermissionsOfEAOrSAOrFA+WhenSubscriptionIsFound+WhenUserIsNotFound.AnHttpNotFoundStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MzgzLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIkZBIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vc3Vic2NyaXB0aW9ucyI6W10sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., userId: &quot;userId2b565164-fcf0-4f86-897d-4676a9cfda39&quot;)" time="0.1749612" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingTheUserOfASingleSubscription.WhenTheTokenHasPermissionsOfEAOrSAOrFA.WhenSubscriptionIsFound.WhenUserIsNotFound.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 2821
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingTheUserOfASingleSubscription.WhenTheTokenHasPermissionsOfEAOrSAOrFA.WhenSubscriptionIsFound.WhenUserIsNotFound.AnHttpNotFoundStatusCodeIsReturned(Jwt jwt, String userId) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 2799
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="User wasn't found by EA, SA, FA. Returns 404HttpNotFound." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionsIntegrationTests+WhenFetchingTheUserOfASingleSubscription+WhenTheTokenHasPermissionsOfEAOrSAOrFA+WhenSubscriptionIsFound+WhenUserIsNotFound.AnHttpNotFoundStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MzgzLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjk3OWE0OTQ3LWVhODUtNGVjMC1iNTg4LTc3YjE0ZGNkMTFjYXxTQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiOTc5YTQ5NDctZWE4NS00ZWMwLWI1ODgtNzdiMTRkY2QxMWNhIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., userId: &quot;userId2b565164-fcf0-4f86-897d-4676a9cfda39&quot;)" time="0.1919587" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingTheUserOfASingleSubscription.WhenTheTokenHasPermissionsOfEAOrSAOrFA.WhenSubscriptionIsFound.WhenUserIsNotFound.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 2821
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingTheUserOfASingleSubscription.WhenTheTokenHasPermissionsOfEAOrSAOrFA.WhenSubscriptionIsFound.WhenUserIsNotFound.AnHttpNotFoundStatusCodeIsReturned(Jwt jwt, String userId) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 2799
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When fetching renders of a subscription with top parameter by SA, FA. Returns 200OK." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionsIntegrationTests+WhenFetchingASingleSubscriptionWithRenders+WhenTokenIsLinkedToFAOrSA+WhenSubscriptionIsFound+WhenSubscriptionIsAccessible+WhenTopParameterIsProvided.TheSubscriptionRendersAreReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3NzA2LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIkZBIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vc3Vic2NyaXB0aW9ucyI6W10sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., grouping: &quot;year&quot;, startDate: &quot;2021-06-03&quot;, endDate: &quot;2021-12-13&quot;, top: 4, expectedContent: &quot;[{\&quot;date\&quot;:\&quot;2021-06-01T00:00:00\&quot;,\&quot;totalRenders\&quot;...)" time="22.2590971" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingASingleSubscriptionWithRenders.WhenTokenIsLinkedToFAOrSA.WhenSubscriptionIsFound.WhenSubscriptionIsAccessible.WhenTopParameterIsProvided.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 1549
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingASingleSubscriptionWithRenders.WhenTokenIsLinkedToFAOrSA.WhenSubscriptionIsFound.WhenSubscriptionIsAccessible.WhenTopParameterIsProvided.TheSubscriptionRendersAreReturned(Jwt jwt, String grouping, String startDate, String endDate, Int32 top, String expectedContent) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 1527
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When fetching renders of a subscription with top parameter by SA, FA. Returns 200OK." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionsIntegrationTests+WhenFetchingASingleSubscriptionWithRenders+WhenTokenIsLinkedToFAOrSA+WhenSubscriptionIsFound+WhenSubscriptionIsAccessible+WhenTopParameterIsProvided.TheSubscriptionRendersAreReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3NzA2LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMHxTQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., grouping: &quot;year&quot;, startDate: null, endDate: null, top: 2, expectedContent: &quot;[{\&quot;date\&quot;:\&quot;2020-12-01T00:00:00\&quot;,\&quot;totalRenders\&quot;...)" time="14.0404175" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingASingleSubscriptionWithRenders.WhenTokenIsLinkedToFAOrSA.WhenSubscriptionIsFound.WhenSubscriptionIsAccessible.WhenTopParameterIsProvided.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 1549
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingASingleSubscriptionWithRenders.WhenTokenIsLinkedToFAOrSA.WhenSubscriptionIsFound.WhenSubscriptionIsAccessible.WhenTopParameterIsProvided.TheSubscriptionRendersAreReturned(Jwt jwt, String grouping, String startDate, String endDate, Int32 top, String expectedContent) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 1527
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When fetching renders of a subscription with top parameter by SA, FA. Returns 200OK." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionsIntegrationTests+WhenFetchingASingleSubscriptionWithRenders+WhenTokenIsLinkedToFAOrSA+WhenSubscriptionIsFound+WhenSubscriptionIsAccessible+WhenTopParameterIsProvided.TheSubscriptionRendersAreReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3NzA2LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMHxTQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., grouping: &quot;month&quot;, startDate: &quot;2021-11-03&quot;, endDate: &quot;2021-11-13&quot;, top: 1, expectedContent: &quot;[{\&quot;date\&quot;:\&quot;2021-11-03T00:00:00\&quot;,\&quot;totalRenders\&quot;...)" time="8.7132114" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingASingleSubscriptionWithRenders.WhenTokenIsLinkedToFAOrSA.WhenSubscriptionIsFound.WhenSubscriptionIsAccessible.WhenTopParameterIsProvided.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 1549
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingASingleSubscriptionWithRenders.WhenTokenIsLinkedToFAOrSA.WhenSubscriptionIsFound.WhenSubscriptionIsAccessible.WhenTopParameterIsProvided.TheSubscriptionRendersAreReturned(Jwt jwt, String grouping, String startDate, String endDate, Int32 top, String expectedContent) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 1527
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When fetching renders of a subscription with top parameter by SA, FA. Returns 200OK." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionsIntegrationTests+WhenFetchingASingleSubscriptionWithRenders+WhenTokenIsLinkedToFAOrSA+WhenSubscriptionIsFound+WhenSubscriptionIsAccessible+WhenTopParameterIsProvided.TheSubscriptionRendersAreReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3NzA2LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIkZBIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vc3Vic2NyaXB0aW9ucyI6W10sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., grouping: &quot;month&quot;, startDate: null, endDate: null, top: 10, expectedContent: &quot;[{\&quot;date\&quot;:\&quot;2021-11-03T00:00:00\&quot;,\&quot;totalRenders\&quot;...)" time="5.7298904" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingASingleSubscriptionWithRenders.WhenTokenIsLinkedToFAOrSA.WhenSubscriptionIsFound.WhenSubscriptionIsAccessible.WhenTopParameterIsProvided.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 1549
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingASingleSubscriptionWithRenders.WhenTokenIsLinkedToFAOrSA.WhenSubscriptionIsFound.WhenSubscriptionIsAccessible.WhenTopParameterIsProvided.TheSubscriptionRendersAreReturned(Jwt jwt, String grouping, String startDate, String endDate, Int32 top, String expectedContent) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 1527
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When fetching renders of a subscription with top parameter by SA, FA. Returns 200OK." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionsIntegrationTests+WhenFetchingASingleSubscriptionWithRenders+WhenTokenIsLinkedToFAOrSA+WhenSubscriptionIsFound+WhenSubscriptionIsAccessible+WhenTopParameterIsNotProvided.TheSubscriptionRendersAreReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3NzU3LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMHxTQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., grouping: &quot;year&quot;, startDate: null, endDate: null, expectedContent: &quot;[{\&quot;date\&quot;:\&quot;2020-12-01T00:00:00\&quot;,\&quot;totalRenders\&quot;...)" time="3.6768172" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingASingleSubscriptionWithRenders.WhenTokenIsLinkedToFAOrSA.WhenSubscriptionIsFound.WhenSubscriptionIsAccessible.WhenTopParameterIsNotProvided.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 2190
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingASingleSubscriptionWithRenders.WhenTokenIsLinkedToFAOrSA.WhenSubscriptionIsFound.WhenSubscriptionIsAccessible.WhenTopParameterIsNotProvided.TheSubscriptionRendersAreReturned(Jwt jwt, String grouping, String startDate, String endDate, String expectedContent) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 2168
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When fetching renders of a subscription with top parameter by SA, FA. Returns 200OK." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionsIntegrationTests+WhenFetchingASingleSubscriptionWithRenders+WhenTokenIsLinkedToFAOrSA+WhenSubscriptionIsFound+WhenSubscriptionIsAccessible+WhenTopParameterIsNotProvided.TheSubscriptionRendersAreReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3NzU3LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIkZBIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vc3Vic2NyaXB0aW9ucyI6W10sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., grouping: &quot;year&quot;, startDate: &quot;2021-06-03&quot;, endDate: &quot;2021-12-13&quot;, expectedContent: &quot;[{\&quot;date\&quot;:\&quot;2021-06-01T00:00:00\&quot;,\&quot;totalRenders\&quot;...)" time="5.4432264" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingASingleSubscriptionWithRenders.WhenTokenIsLinkedToFAOrSA.WhenSubscriptionIsFound.WhenSubscriptionIsAccessible.WhenTopParameterIsNotProvided.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 2190
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingASingleSubscriptionWithRenders.WhenTokenIsLinkedToFAOrSA.WhenSubscriptionIsFound.WhenSubscriptionIsAccessible.WhenTopParameterIsNotProvided.TheSubscriptionRendersAreReturned(Jwt jwt, String grouping, String startDate, String endDate, String expectedContent) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 2168
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When fetching renders of a subscription with top parameter by SA, FA. Returns 200OK." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionsIntegrationTests+WhenFetchingASingleSubscriptionWithRenders+WhenTokenIsLinkedToFAOrSA+WhenSubscriptionIsFound+WhenSubscriptionIsAccessible+WhenTopParameterIsNotProvided.TheSubscriptionRendersAreReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3NzU3LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIkZBIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vc3Vic2NyaXB0aW9ucyI6W10sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., grouping: &quot;month&quot;, startDate: null, endDate: null, expectedContent: &quot;[{\&quot;date\&quot;:\&quot;2021-11-03T00:00:00\&quot;,\&quot;totalRenders\&quot;...)" time="1.9574648" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingASingleSubscriptionWithRenders.WhenTokenIsLinkedToFAOrSA.WhenSubscriptionIsFound.WhenSubscriptionIsAccessible.WhenTopParameterIsNotProvided.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 2190
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingASingleSubscriptionWithRenders.WhenTokenIsLinkedToFAOrSA.WhenSubscriptionIsFound.WhenSubscriptionIsAccessible.WhenTopParameterIsNotProvided.TheSubscriptionRendersAreReturned(Jwt jwt, String grouping, String startDate, String endDate, String expectedContent) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 2168
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When fetching renders of a subscription with top parameter by SA, FA. Returns 200OK." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionsIntegrationTests+WhenFetchingASingleSubscriptionWithRenders+WhenTokenIsLinkedToFAOrSA+WhenSubscriptionIsFound+WhenSubscriptionIsAccessible+WhenTopParameterIsNotProvided.TheSubscriptionRendersAreReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3NzU3LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMHxTQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., grouping: &quot;month&quot;, startDate: &quot;2021-11-03&quot;, endDate: &quot;2021-11-13&quot;, expectedContent: &quot;[{\&quot;date\&quot;:\&quot;2021-11-03T00:00:00\&quot;,\&quot;totalRenders\&quot;...)" time="2.5582478" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingASingleSubscriptionWithRenders.WhenTokenIsLinkedToFAOrSA.WhenSubscriptionIsFound.WhenSubscriptionIsAccessible.WhenTopParameterIsNotProvided.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 2190
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingASingleSubscriptionWithRenders.WhenTokenIsLinkedToFAOrSA.WhenSubscriptionIsFound.WhenSubscriptionIsAccessible.WhenTopParameterIsNotProvided.TheSubscriptionRendersAreReturned(Jwt jwt, String grouping, String startDate, String endDate, String expectedContent) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 2168
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="User isn't available to EA. Returns 404HttpNotFound." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription" method="SubscriptionsIntegrationTests+WhenFetchingTheUserOfASingleSubscription+WhenTheTokenHasPermissionsOfEAOrSAOrFA+WhenSubscriptionIsFound+WhenUserIsNotAccessible+WhenTheTokenIsLinkedToTheEnvironmentAdministratorRole.AnHttpNotFoundStatusCodeIsReturned" time="1.2030572" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingTheUserOfASingleSubscription.WhenTheTokenHasPermissionsOfEAOrSAOrFA.WhenSubscriptionIsFound.WhenUserIsNotAccessible.WhenTheTokenIsLinkedToTheEnvironmentAdministratorRole.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 2861
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.Subscription.SubscriptionsIntegrationTests.WhenFetchingTheUserOfASingleSubscription.WhenTheTokenHasPermissionsOfEAOrSAOrFA.WhenSubscriptionIsFound.WhenUserIsNotAccessible.WhenTheTokenIsLinkedToTheEnvironmentAdministratorRole.AnHttpNotFoundStatusCodeIsReturned() in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\Subscription\Subscription.Integration.Tests.cs:line 2838
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
    </collection>
    <collection total="1" passed="0" failed="1" skipped="0" name="Test collection for CHILI.GraFx.Platform.API.Integration.Tests.Modules.Swagger" time="1.920">
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Swagger.SwaggerIntegrationTests+WhenRequestingTheSwaggerUserInterface.AnHttpOkStatusCodeIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.Swagger" method="SwaggerIntegrationTests+WhenRequestingTheSwaggerUserInterface.AnHttpOkStatusCodeIsReturned" time="1.9196659" result="Fail">
        <failure>
          <message>System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 79</stack-trace>
        </failure>
        <traits />
      </test>
    </collection>
    <collection total="278" passed="0" failed="278" skipped="0" name="Test collection for CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" time="471.384">
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests+ApiV1UsersManageAddPostEndpoint+WhenReturnsStatusCodeBadRequest.ProblemDetailsContentIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementContractTests+ApiV1UsersManageAddPostEndpoint+WhenReturnsStatusCodeBadRequest.ProblemDetailsContentIsReturned(model: AddUserModel { CustomerGuid = 66fb1e11-accd-4ed7-90fa-7962e198b46b, Email = null, FirstName = &quot;FirstName01a306ac-29a7-4425-80ea-4ac4efcc3c11&quot;, LastName = &quot;LastNameb088fb70-b75b-4861-9942-ae1e5225cef3&quot;, SubscriptionIds = [3af3119d-e5f5-400e-9f68-a43fbd6bfdde, 6e7e1c82-7f8a-4c16-a365-db5a46d2a08a, 41efd75a-ee71-431f-8c89-36be5fac745d] })" time="0.3852186" result="Fail">
        <failure>
          <message>System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 79</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests+ApiV1UsersManageAddPostEndpoint+WhenReturnsStatusCodeConflict.ProblemDetailsContentIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementContractTests+ApiV1UsersManageAddPostEndpoint+WhenReturnsStatusCodeConflict.ProblemDetailsContentIsReturned(model: AddUserModel { CustomerGuid = d60b52d8-0445-4f52-9cd3-bce44e8cf07a, Email = &quot;1fae7ec2-dda9-41e3-bd1c-d667c99b7b5b@example.com&quot;, FirstName = &quot;FirstName484b9cf3-00f7-45d0-a5ef-1a110a96e4fa&quot;, LastName = &quot;LastName139977dc-d2e1-4881-9f41-061b15ba6a31&quot;, SubscriptionIds = [3417c370-a814-4913-97d2-247e7fa75c0f, 60f92ecc-162b-46df-96de-1eda57a3d919, 1a1507dd-2630-4789-ab2b-816b221372cb] })" time="0.2243980" result="Fail">
        <failure>
          <message>System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 79</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests+ApiV1UsersManageUpdatePutEndpoint+WhenReturnsStatusCodeUnauthorized.ProblemDetailsContentIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementContractTests+ApiV1UsersManageUpdatePutEndpoint+WhenReturnsStatusCodeUnauthorized.ProblemDetailsContentIsReturned(userId: &quot;userIdbeadbf0e-858b-44c4-a94e-0e6c90115406&quot;, nameModel: UpdateUserNameModel { FirstName = &quot;FirstName3081d556-7e0f-4abb-b5c5-7a4a8b10a076&quot;, LastName = &quot;LastName97ad7929-29e1-4c26-b5e8-fef268c8c0a5&quot; })" time="0.2028677" result="Fail">
        <failure>
          <message>System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 79</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests+ApiV1UsersManageUpdatePutEndpoint+WhenReturnsStatusCodeBadRequest.ProblemDetailsContentIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementContractTests+ApiV1UsersManageUpdatePutEndpoint+WhenReturnsStatusCodeBadRequest.ProblemDetailsContentIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjk2MDc5MTU2LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIlREIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vc3Vic2NyaXB0aW9ucyI6W10sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., userId: &quot;userId56fabf6e-771b-4bb6-beb2-fd257c2972f1&quot;, nameModel: UpdateUserNameModel { FirstName = null, LastName = &quot;LastNameab2945db-2099-47c4-8a0e-53175dc0b0b8&quot; })" time="0.9063028" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected HttpStatusCode to be HttpStatusCode.BadRequest {value: 400}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected HttpStatusCode to be HttpStatusCode.BadRequest {value: 400}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.TestFrameworkProvider.Throw(String message)
   at FluentAssertions.Execution.DefaultAssertionStrategy.HandleFailure(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Execution.AssertionScope.FailWith(String message, Object[] args)
   at FluentAssertions.Primitives.HttpResponseMessageAssertions`1.HaveStatusCode(HttpStatusCode expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests.ApiV1UsersManageUpdatePutEndpoint.WhenReturnsStatusCodeBadRequest.ProblemDetailsContentIsReturned(Jwt jwt, String userId, UpdateUserNameModel nameModel) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Contract.Tests.cs:line 200
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 79</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests+ApiV1UsersManageUpdatePutEndpoint+WhenReturnsStatusCodeNotFound.ProblemDetailsContentIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementContractTests+ApiV1UsersManageUpdatePutEndpoint+WhenReturnsStatusCodeNotFound.ProblemDetailsContentIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNzA5ODE2NzU3LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIlNVIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vc3Vic2NyaXB0aW9ucyI6W10sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., userId: &quot;userIdab305538-90e1-4d8a-90fc-253562f2e9d1&quot;, nameModel: UpdateUserNameModel { FirstName = &quot;FirstName6b863033-636f-40c5-8176-2a732be7101b&quot;, LastName = &quot;LastNamef4f00c27-e748-4c4d-b1d6-8527eaf9cea3&quot; })" time="0.2952368" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected HttpStatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected HttpStatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.TestFrameworkProvider.Throw(String message)
   at FluentAssertions.Execution.DefaultAssertionStrategy.HandleFailure(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Execution.AssertionScope.FailWith(String message, Object[] args)
   at FluentAssertions.Primitives.HttpResponseMessageAssertions`1.HaveStatusCode(HttpStatusCode expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests.ApiV1UsersManageUpdatePutEndpoint.WhenReturnsStatusCodeNotFound.ProblemDetailsContentIsReturned(Jwt jwt, String userId, UpdateUserNameModel nameModel) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Contract.Tests.cs:line 229
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 79</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests+ApiV1UsersManageUpdatePutEndpoint+WhenReturnsStatusCodeInternalServerError.ProblemDetailsContentIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementContractTests+ApiV1UsersManageUpdatePutEndpoint+WhenReturnsStatusCodeInternalServerError.ProblemDetailsContentIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjkxMjQwNzU3LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIkVBIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vc3Vic2NyaXB0aW9ucyI6W10sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., userId: &quot;userId4aae9711-cd3f-455d-89b8-8f944b4ed612&quot;, nameModel: UpdateUserNameModel { FirstName = &quot;FirstNamefeb27355-83e3-4e98-80f1-2f5021fc3baa&quot;, LastName = &quot;LastName6ed7d956-a76f-43ee-8489-0556948238fa&quot; })" time="0.2586356" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected HttpStatusCode to be HttpStatusCode.InternalServerError {value: 500}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected HttpStatusCode to be HttpStatusCode.InternalServerError {value: 500}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.TestFrameworkProvider.Throw(String message)
   at FluentAssertions.Execution.DefaultAssertionStrategy.HandleFailure(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Execution.AssertionScope.FailWith(String message, Object[] args)
   at FluentAssertions.Primitives.HttpResponseMessageAssertions`1.HaveStatusCode(HttpStatusCode expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests.ApiV1UsersManageUpdatePutEndpoint.WhenReturnsStatusCodeInternalServerError.ProblemDetailsContentIsReturned(Jwt jwt, String userId, UpdateUserNameModel nameModel) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Contract.Tests.cs:line 273
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 79</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests+ApiV1UsersManageEmailStatusGetEndpoint+WhenReturnsStatusCodeBadRequest.ProblemDetailsContentIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementContractTests+ApiV1UsersManageEmailStatusGetEndpoint+WhenReturnsStatusCodeBadRequest.ProblemDetailsContentIsReturned" time="0.1593700" result="Fail">
        <failure>
          <message>System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 79</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests+ApiV1UsersManageEmailStatusGetEndpoint+WhenReturnsStatusCodeNotFound.ProblemDetailsContentIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementContractTests+ApiV1UsersManageEmailStatusGetEndpoint+WhenReturnsStatusCodeNotFound.ProblemDetailsContentIsReturned" time="0.1916637" result="Fail">
        <failure>
          <message>System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 79</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests+ApiV1UsersManageEmailStatusGetEndpoint+WhenReturnsStatusCodeInternalServerError.ProblemDetailsContentIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementContractTests+ApiV1UsersManageEmailStatusGetEndpoint+WhenReturnsStatusCodeInternalServerError.ProblemDetailsContentIsReturned" time="0.1838086" result="Fail">
        <failure>
          <message>System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 79</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests+ApiV1UsersManageMigratePutEndpoint+WhenReturnsStatusCodeBadRequest.ProblemDetailsContentIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementContractTests+ApiV1UsersManageMigratePutEndpoint+WhenReturnsStatusCodeBadRequest.ProblemDetailsContentIsReturned(model: MarkUserMigratedModel { UserEmail = null })" time="0.1685670" result="Fail">
        <failure>
          <message>System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 79</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests+ApiV1UsersManageMigratePutEndpoint+WhenReturnsStatusCodeNotFound.ProblemDetailsContentIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementContractTests+ApiV1UsersManageMigratePutEndpoint+WhenReturnsStatusCodeNotFound.ProblemDetailsContentIsReturned(model: MarkUserMigratedModel { UserEmail = &quot;c43fc847-7eff-4cd9-b1d3-79c7f3f29607@example.net&quot; })" time="0.1862675" result="Fail">
        <failure>
          <message>System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 79</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests+ApiV1UsersManageMigratePutEndpoint+WhenReturnsStatusInternalServerError.ProblemDetailsContentIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementContractTests+ApiV1UsersManageMigratePutEndpoint+WhenReturnsStatusInternalServerError.ProblemDetailsContentIsReturned(model: MarkUserMigratedModel { UserEmail = &quot;dc17a95d-5151-4eb9-9425-5c3f28abc668@example.com&quot; })" time="0.1709370" result="Fail">
        <failure>
          <message>System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 79</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests+ApiV1UsersManageMigrateSubscriptionsPostEndpoint+WhenReturnsStatusCodeBadRequest.ProblemDetailsContentIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementContractTests+ApiV1UsersManageMigrateSubscriptionsPostEndpoint+WhenReturnsStatusCodeBadRequest.ProblemDetailsContentIsReturned(model: UserAccessibleSubscriptionsModel { UserEmail = null })" time="0.1755149" result="Fail">
        <failure>
          <message>System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 79</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests+ApiV1UsersManageMigrateSubscriptionsPostEndpoint+WhenReturnsStatusCodeNotFound.ProblemDetailsContentIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementContractTests+ApiV1UsersManageMigrateSubscriptionsPostEndpoint+WhenReturnsStatusCodeNotFound.ProblemDetailsContentIsReturned(model: UserAccessibleSubscriptionsModel { UserEmail = &quot;97e43225-ec6b-45f2-b03a-397a04b4700e@example.org&quot; })" time="0.1748750" result="Fail">
        <failure>
          <message>System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 79</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests+ApiV1UsersManageMigrateSubscriptionsPostEndpoint+WhenReturnsStatusInternalServerError.ProblemDetailsContentIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementContractTests+ApiV1UsersManageMigrateSubscriptionsPostEndpoint+WhenReturnsStatusInternalServerError.ProblemDetailsContentIsReturned(model: UserAccessibleSubscriptionsModel { UserEmail = &quot;dc55d735-399a-4e5c-9930-11949c1b8fac@example.net&quot; })" time="0.1666796" result="Fail">
        <failure>
          <message>System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 79</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests+ApiV1UsersManageInvitationPostEndpoint+WhenReturnsStatusCodeUnauthorized.ProblemDetailsContentIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementContractTests+ApiV1UsersManageInvitationPostEndpoint+WhenReturnsStatusCodeUnauthorized.ProblemDetailsContentIsReturned(inviteUsersModel: InviteUsersModel { Environments = [EnvironmentRoleModel { ... }, EnvironmentRoleModel { ... }, EnvironmentRoleModel { ... }], SubscriptionIds = [0cc4e24c-79a1-4913-b671-37bc6445e9a2, 293523dc-9bc3-4281-81be-be492ee1acc6, 468eecac-093c-45bd-ae1c-9e37026ecadd], UserEmails = [&quot;095b8cd0-86f2-4c8c-8587-fc3ed6ad3831&quot;, &quot;9e477828-8032-43a2-a993-b44f44bb8c98&quot;, &quot;7f14ee12-964d-423d-bb41-d787cd3264fb&quot;] })" time="0.1690218" result="Fail">
        <failure>
          <message>System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 79</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests+ApiV1UsersManageInvitationPostEndpoint+WhenReturnsStatusCodeUnauthorized.ProblemDetailsContentIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementContractTests+ApiV1UsersManageInvitationPostEndpoint+WhenReturnsStatusCodeUnauthorized.ProblemDetailsContentIsReturned(inviteUsersModel: InviteUsersModel { Environments = [EnvironmentRoleModel { ... }, EnvironmentRoleModel { ... }, EnvironmentRoleModel { ... }], SubscriptionIds = [1b7b9a2c-b4f4-4d06-be30-fa2ddce5a1c4, cbd6b491-8ff1-42d1-b5a3-4bb79b8e2b0f, ddeefe85-ac33-437a-855a-825a298c3bda], UserEmails = [&quot;b185394b-4fad-49a3-a641-60bb3847597f@example.org&quot;, &quot;622b8ca3-496f-4e4e-bf60-054fe19992bd@example.com&quot;, &quot;0ef82dfa-92e8-46af-9186-de5b7fc5f56e@example.net&quot;] })" time="0.1767041" result="Fail">
        <failure>
          <message>System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 79</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests+ApiV1UsersManageInvitationPostEndpoint+WhenReturnsStatusCodeForbidden.ProblemDetailsContentIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementContractTests+ApiV1UsersManageInvitationPostEndpoint+WhenReturnsStatusCodeForbidden.ProblemDetailsContentIsReturned" time="0.1405672" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests.ApiV1UsersManageInvitationPostEndpoint.WhenReturnsStatusCodeForbidden.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Contract.Tests.cs:line 741
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests.ApiV1UsersManageInvitationPostEndpoint.WhenReturnsStatusCodeForbidden.ProblemDetailsContentIsReturned() in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Contract.Tests.cs:line 718
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 79</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests+ApiV1UsersManageInvitationPostEndpoint+WhenReturnsStatusCodeBadRequest.ProblemDetailsContentIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementContractTests+ApiV1UsersManageInvitationPostEndpoint+WhenReturnsStatusCodeBadRequest.ProblemDetailsContentIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjkzMjI3OTYwLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMHxTQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., inviteUsersModel: InviteUsersModel { Environments = [EnvironmentRoleModel { ... }, EnvironmentRoleModel { ... }, EnvironmentRoleModel { ... }], SubscriptionIds = [89bb6bc6-4c0a-4dbb-9da3-a6c1546603c6, 893aa1a8-a7ef-40fe-b1e1-7660d24a1237, 5c1223e9-dc3c-4cd4-b1d8-93a6ac44fc5b], UserEmails = [&quot; &quot;] })" time="0.2597899" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected HttpStatusCode to be HttpStatusCode.BadRequest {value: 400}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected HttpStatusCode to be HttpStatusCode.BadRequest {value: 400}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.TestFrameworkProvider.Throw(String message)
   at FluentAssertions.Execution.DefaultAssertionStrategy.HandleFailure(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Execution.AssertionScope.FailWith(String message, Object[] args)
   at FluentAssertions.Primitives.HttpResponseMessageAssertions`1.HaveStatusCode(HttpStatusCode expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests.ApiV1UsersManageInvitationPostEndpoint.WhenReturnsStatusCodeBadRequest.ProblemDetailsContentIsReturned(Jwt jwt, InviteUsersModel inviteUsersModel) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Contract.Tests.cs:line 776
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 79</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests+ApiV1UsersManageInvitationPostEndpoint+WhenReturnsStatusCodeNotFound.ProblemDetailsContentIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementContractTests+ApiV1UsersManageInvitationPostEndpoint+WhenReturnsStatusCodeNotFound.ProblemDetailsContentIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNzAyOTkxMTYwLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIkZBIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vc3Vic2NyaXB0aW9ucyI6W10sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., inviteUsersModel: InviteUsersModel { Environments = [EnvironmentRoleModel { ... }, EnvironmentRoleModel { ... }, EnvironmentRoleModel { ... }], SubscriptionIds = [41e0e748-3917-4a8e-8896-0a47a6eda3d7, d2c33ed7-03c1-4c0a-b673-d2291bab9a58, 22cd3845-22c0-4517-8cbc-011207f2a2f3], UserEmails = [&quot;150571b8-a091-447f-973a-c3144e7c2b66@example.net&quot;, &quot;4db62283-272b-4dfa-9f7e-95abe08fb435@example.org&quot;, &quot;b82c3f33-4386-45aa-b2ff-71eaf3f0e3c5@example.com&quot;] })" time="0.2202654" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected HttpStatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected HttpStatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.TestFrameworkProvider.Throw(String message)
   at FluentAssertions.Execution.DefaultAssertionStrategy.HandleFailure(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Execution.AssertionScope.FailWith(String message, Object[] args)
   at FluentAssertions.Primitives.HttpResponseMessageAssertions`1.HaveStatusCode(HttpStatusCode expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests.ApiV1UsersManageInvitationPostEndpoint.WhenReturnsStatusCodeNotFound.ProblemDetailsContentIsReturned(Jwt jwt, InviteUsersModel inviteUsersModel) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Contract.Tests.cs:line 805
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 79</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests+ApiV1UsersMeGetEndpoint+WhenReturnsStatusCodeUnauthorized.ProblemDetailsContentIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementContractTests+ApiV1UsersMeGetEndpoint+WhenReturnsStatusCodeUnauthorized.ProblemDetailsContentIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJJc3N1ZXJmZjRlYzgxNi0xZmYyLTQwYmItYmM5Yi1iNzE3MzdmNDdiODUiLCJhdWQiOiJBdWRpZW5jZTQ1MDYyNmNlLTA3MjYtNDQ3Mi05YWQwLTFlYWM4ZGMzZTJkNSIsImF6cCI6IkNsaWVudElkOGRhNjMwMzUtZDVjOS00NjZiLTg3YjctMWIzNDFlYjZjMmUzIiwiZXhwIjoxNjk4NTk3OTI4LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIlNBIiwiRUEiLCJURCJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiNDI4MTU1YmEtYjgwNS00ZTFkLTgyNTYtODJkNDdhOWQ4ZmE0IiwiZmU4MGZhN2UtODRhMy00Y2EyLWI2NGYtN2FiMmNlNWUzNDViIiwiYTNmOTg1NmItY2NkNS00NzI4LWExMTctM2FkZTFkZjkzMjM0Il0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6ImQ1NDQ5YjhkLWNlOTUtNDQ2Yi05MWQ5LTdlZTQxNDZmMmJhNyIsInN1YiI6IlVzZXJJZDY4ODJkYmFhLTQ5ZWQtNDMwMC04M2Y5LWJhNDk0ZTAxZGExYSIsImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vZW52aXJvbm1lbnRJZCI6IkVudmlyb25tZW50MDNmZGFiYzUtMzNkOS00MWNkLTllMWYtMzYzM2FiYWMwY2ZlIiwic2NvcGUiOiI2NTdlMDk4Yy1iODUxLTQ5NzItYWQyMS1lNjBlY2ZjNjg4Y2YgMWNlZTRkZTQtMzM3Mi00ZTdhLThkMTktZDM0OTQzZTE2NWJkIGIzMGQ1NzdjLWRhNzUtNDM5ZS05Y2Y1LWJkM2E0ZjI0MGNiYyJ9.)" time="0.2637603" result="Fail">
        <failure>
          <message>System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 79</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests+ApiV1UsersMeGetEndpoint+WhenReturnsStatusCodeUnauthorized.ProblemDetailsContentIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementContractTests+ApiV1UsersMeGetEndpoint+WhenReturnsStatusCodeUnauthorized.ProblemDetailsContentIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNzAyMjEzNTYwLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIkZBIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vc3Vic2NyaXB0aW9ucyI6W10sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6Im5vbl9leGlzdGluZ191c2VyaWQiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.2535867" result="Fail">
        <failure>
          <message>System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 79</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests+ApiV1UsersManageEnvironmentsPatchEndpoint+WhenReturnsStatusCodeUnauthorized.ProblemDetailsContentIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementContractTests+ApiV1UsersManageEnvironmentsPatchEndpoint+WhenReturnsStatusCodeUnauthorized.ProblemDetailsContentIsReturned(model: UserEnvironmentsModel { EnvironmentRoles = [[a8ea759b-3d51-4fb9-9bf0-12115c25c0ae] = [EA, EU, CA], [57a222e1-0c86-42c9-bdee-db438323d504] = [EA, EU, CA], [d52890e8-fb01-4e63-9664-ffaf4cad0680] = [EA, EU, CA]] })" time="0.1904376" result="Fail">
        <failure>
          <message>System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 79</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests+ApiV1UsersManageEnvironmentsPatchEndpoint+WhenReturnsStatusCodeForbidden.ProblemDetailsContentIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementContractTests+ApiV1UsersManageEnvironmentsPatchEndpoint+WhenReturnsStatusCodeForbidden.ProblemDetailsContentIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNzE0NDgyMzYxLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbImJjMWY3MGRmLTUxNzktNGU0Yy1iMmViLTM1OTdhNjUwMGM2MXxFVSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiNGVjNWIyMDAtNDIwNi00OGJjLThiMGYtMDVhMGNlNDJlYzRiIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.2137507" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected HttpStatusCode to be HttpStatusCode.Forbidden {value: 403}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected HttpStatusCode to be HttpStatusCode.Forbidden {value: 403}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.TestFrameworkProvider.Throw(String message)
   at FluentAssertions.Execution.DefaultAssertionStrategy.HandleFailure(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Execution.AssertionScope.FailWith(String message, Object[] args)
   at FluentAssertions.Primitives.HttpResponseMessageAssertions`1.HaveStatusCode(HttpStatusCode expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests.ApiV1UsersManageEnvironmentsPatchEndpoint.WhenReturnsStatusCodeForbidden.ProblemDetailsContentIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Contract.Tests.cs:line 924
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 79</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests+ApiV1UsersManageEnvironmentsPatchEndpoint+WhenReturnsStatusCodeBadRequest.ProblemDetailsContentIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementContractTests+ApiV1UsersManageEnvironmentsPatchEndpoint+WhenReturnsStatusCodeBadRequest.ProblemDetailsContentIsReturned()" time="0.2579800" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected HttpStatusCode to be HttpStatusCode.BadRequest {value: 400}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected HttpStatusCode to be HttpStatusCode.BadRequest {value: 400}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.TestFrameworkProvider.Throw(String message)
   at FluentAssertions.Execution.DefaultAssertionStrategy.HandleFailure(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Execution.AssertionScope.FailWith(String message, Object[] args)
   at FluentAssertions.Primitives.HttpResponseMessageAssertions`1.HaveStatusCode(HttpStatusCode expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests.ApiV1UsersManageEnvironmentsPatchEndpoint.WhenReturnsStatusCodeBadRequest.ProblemDetailsContentIsReturned() in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Contract.Tests.cs:line 970
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 79</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests+ApiV1UsersManageEnvironmentsPatchEndpoint+WhenReturnsStatusCodeNotFound.ProblemDetailsContentIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementContractTests+ApiV1UsersManageEnvironmentsPatchEndpoint+WhenReturnsStatusCodeNotFound.ProblemDetailsContentIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNzA4OTUyNzYxLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMHxTQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., model: UserEnvironmentsModel { EnvironmentRoles = [[ab18598f-1a70-4e72-a26b-1263453a3c78] = [EA], [913514ee-63ff-4fba-bccd-b8a3c39fad1b] = [EU]] })" time="0.1963297" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected HttpStatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected HttpStatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.TestFrameworkProvider.Throw(String message)
   at FluentAssertions.Execution.DefaultAssertionStrategy.HandleFailure(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Execution.AssertionScope.FailWith(String message, Object[] args)
   at FluentAssertions.Primitives.HttpResponseMessageAssertions`1.HaveStatusCode(HttpStatusCode expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests.ApiV1UsersManageEnvironmentsPatchEndpoint.WhenReturnsStatusCodeNotFound.ProblemDetailsContentIsReturned(Jwt jwt, UserEnvironmentsModel model) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Contract.Tests.cs:line 999
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 79</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When request is invalid. Returns 401Unauthorized/403Forbid/404NotFound/400BadRequest" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementContractTests+ApiV1UsersManageSubscriptionsPatchEndpoint+WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.ProblemDetailsContentIsReturned(jwtCustomization: SubscriptionAdministratorRoleJwtCustomization { }, expectedStatusCode: NotFound, subscriptionId: 00000000-0000-0000-0000-000000000001, userSubscriptionRolesCustomization: WithOneSaAndTdRoleCustomization { }, userId: &quot;userIde53d5aae-35d8-444c-b77e-ebf501b1df7f&quot;)" time="0.2104595" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected HttpStatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected HttpStatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.TestFrameworkProvider.Throw(String message)
   at FluentAssertions.Execution.DefaultAssertionStrategy.HandleFailure(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Execution.AssertionScope.FailWith(String message, Object[] args)
   at FluentAssertions.Primitives.HttpResponseMessageAssertions`1.HaveStatusCode(HttpStatusCode expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests.ApiV1UsersManageSubscriptionsPatchEndpoint.WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.ProblemDetailsContentIsReturned(ICustomization jwtCustomization, HttpStatusCode expectedStatusCode, Guid subscriptionId, ICustomization userSubscriptionRolesCustomization, String userId) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Contract.Tests.cs:line 1107
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 79</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When request is invalid. Returns 401Unauthorized/403Forbid/404NotFound/400BadRequest" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementContractTests+ApiV1UsersManageSubscriptionsPatchEndpoint+WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.ProblemDetailsContentIsReturned(jwtCustomization: SubscriptionAdministratorRoleJwtCustomization { }, expectedStatusCode: BadRequest, subscriptionId: 00000000-0000-0000-0000-000000000001, userSubscriptionRolesCustomization: WithDuplicatedSaRoleCustomization { }, userId: &quot;userIde53d5aae-35d8-444c-b77e-ebf501b1df7f&quot;)" time="0.2120801" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected HttpStatusCode to be HttpStatusCode.BadRequest {value: 400}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected HttpStatusCode to be HttpStatusCode.BadRequest {value: 400}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.TestFrameworkProvider.Throw(String message)
   at FluentAssertions.Execution.DefaultAssertionStrategy.HandleFailure(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Execution.AssertionScope.FailWith(String message, Object[] args)
   at FluentAssertions.Primitives.HttpResponseMessageAssertions`1.HaveStatusCode(HttpStatusCode expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests.ApiV1UsersManageSubscriptionsPatchEndpoint.WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.ProblemDetailsContentIsReturned(ICustomization jwtCustomization, HttpStatusCode expectedStatusCode, Guid subscriptionId, ICustomization userSubscriptionRolesCustomization, String userId) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Contract.Tests.cs:line 1107
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 79</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When request is invalid. Returns 401Unauthorized/403Forbid/404NotFound/400BadRequest" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementContractTests+ApiV1UsersManageSubscriptionsPatchEndpoint+WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.ProblemDetailsContentIsReturned(jwtCustomization: SubscriptionAdministratorRoleJwtCustomization { }, expectedStatusCode: BadRequest, subscriptionId: 00000000-0000-0000-0000-000000000001, userSubscriptionRolesCustomization: WithEmptyRolesListCustomization { }, userId: &quot;userIde53d5aae-35d8-444c-b77e-ebf501b1df7f&quot;)" time="0.2082310" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected HttpStatusCode to be HttpStatusCode.BadRequest {value: 400}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected HttpStatusCode to be HttpStatusCode.BadRequest {value: 400}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.TestFrameworkProvider.Throw(String message)
   at FluentAssertions.Execution.DefaultAssertionStrategy.HandleFailure(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Execution.AssertionScope.FailWith(String message, Object[] args)
   at FluentAssertions.Primitives.HttpResponseMessageAssertions`1.HaveStatusCode(HttpStatusCode expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests.ApiV1UsersManageSubscriptionsPatchEndpoint.WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.ProblemDetailsContentIsReturned(ICustomization jwtCustomization, HttpStatusCode expectedStatusCode, Guid subscriptionId, ICustomization userSubscriptionRolesCustomization, String userId) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Contract.Tests.cs:line 1107
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 79</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When request is invalid. Returns 401Unauthorized/403Forbid/404NotFound/400BadRequest" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementContractTests+ApiV1UsersManageSubscriptionsPatchEndpoint+WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.ProblemDetailsContentIsReturned(jwtCustomization: SubscriptionAdministratorRoleJwtCustomization { }, expectedStatusCode: BadRequest, subscriptionId: 00000000-0000-0000-0000-000000000001, userSubscriptionRolesCustomization: WithOneSaAndTdRoleCustomization { }, userId: &quot; &quot;)" time="0.1919490" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected HttpStatusCode to be HttpStatusCode.BadRequest {value: 400}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected HttpStatusCode to be HttpStatusCode.BadRequest {value: 400}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.TestFrameworkProvider.Throw(String message)
   at FluentAssertions.Execution.DefaultAssertionStrategy.HandleFailure(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Execution.AssertionScope.FailWith(String message, Object[] args)
   at FluentAssertions.Primitives.HttpResponseMessageAssertions`1.HaveStatusCode(HttpStatusCode expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests.ApiV1UsersManageSubscriptionsPatchEndpoint.WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.ProblemDetailsContentIsReturned(ICustomization jwtCustomization, HttpStatusCode expectedStatusCode, Guid subscriptionId, ICustomization userSubscriptionRolesCustomization, String userId) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Contract.Tests.cs:line 1107
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 79</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When request is invalid. Returns 401Unauthorized/403Forbid/404NotFound/400BadRequest" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementContractTests+ApiV1UsersManageSubscriptionsPatchEndpoint+WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.ProblemDetailsContentIsReturned(jwtCustomization: EnvironmentUserRoleJwtCustomization { }, expectedStatusCode: Forbidden, subscriptionId: 00000000-0000-0000-0000-000000000001, userSubscriptionRolesCustomization: WithOneSaAndTdRoleCustomization { }, userId: &quot;userIde53d5aae-35d8-444c-b77e-ebf501b1df7f&quot;)" time="0.2258571" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected HttpStatusCode to be HttpStatusCode.Forbidden {value: 403}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected HttpStatusCode to be HttpStatusCode.Forbidden {value: 403}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.TestFrameworkProvider.Throw(String message)
   at FluentAssertions.Execution.DefaultAssertionStrategy.HandleFailure(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Execution.AssertionScope.FailWith(String message, Object[] args)
   at FluentAssertions.Primitives.HttpResponseMessageAssertions`1.HaveStatusCode(HttpStatusCode expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests.ApiV1UsersManageSubscriptionsPatchEndpoint.WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.ProblemDetailsContentIsReturned(ICustomization jwtCustomization, HttpStatusCode expectedStatusCode, Guid subscriptionId, ICustomization userSubscriptionRolesCustomization, String userId) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Contract.Tests.cs:line 1107
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 79</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When request is invalid. Returns 401Unauthorized/403Forbid/404NotFound/400BadRequest" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementContractTests+ApiV1UsersManageSubscriptionsPatchEndpoint+WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.ProblemDetailsContentIsReturned(jwtCustomization: SupportUserRoleJwtCustomization { }, expectedStatusCode: Forbidden, subscriptionId: 00000000-0000-0000-0000-000000000001, userSubscriptionRolesCustomization: WithOneSaAndTdRoleCustomization { }, userId: &quot;userIde53d5aae-35d8-444c-b77e-ebf501b1df7f&quot;)" time="0.2480577" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected HttpStatusCode to be HttpStatusCode.Forbidden {value: 403}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected HttpStatusCode to be HttpStatusCode.Forbidden {value: 403}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.TestFrameworkProvider.Throw(String message)
   at FluentAssertions.Execution.DefaultAssertionStrategy.HandleFailure(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Execution.AssertionScope.FailWith(String message, Object[] args)
   at FluentAssertions.Primitives.HttpResponseMessageAssertions`1.HaveStatusCode(HttpStatusCode expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests.ApiV1UsersManageSubscriptionsPatchEndpoint.WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.ProblemDetailsContentIsReturned(ICustomization jwtCustomization, HttpStatusCode expectedStatusCode, Guid subscriptionId, ICustomization userSubscriptionRolesCustomization, String userId) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Contract.Tests.cs:line 1107
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 79</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When request is invalid. Returns 401Unauthorized/403Forbid/404NotFound/400BadRequest" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementContractTests+ApiV1UsersManageSubscriptionsPatchEndpoint+WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.ProblemDetailsContentIsReturned(jwtCustomization: TemplateDesignerRoleJwtCustomization { }, expectedStatusCode: Forbidden, subscriptionId: 00000000-0000-0000-0000-000000000001, userSubscriptionRolesCustomization: WithOneSaAndTdRoleCustomization { }, userId: &quot;userIde53d5aae-35d8-444c-b77e-ebf501b1df7f&quot;)" time="0.2312888" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected HttpStatusCode to be HttpStatusCode.Forbidden {value: 403}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected HttpStatusCode to be HttpStatusCode.Forbidden {value: 403}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.TestFrameworkProvider.Throw(String message)
   at FluentAssertions.Execution.DefaultAssertionStrategy.HandleFailure(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Execution.AssertionScope.FailWith(String message, Object[] args)
   at FluentAssertions.Primitives.HttpResponseMessageAssertions`1.HaveStatusCode(HttpStatusCode expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests.ApiV1UsersManageSubscriptionsPatchEndpoint.WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.ProblemDetailsContentIsReturned(ICustomization jwtCustomization, HttpStatusCode expectedStatusCode, Guid subscriptionId, ICustomization userSubscriptionRolesCustomization, String userId) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Contract.Tests.cs:line 1107
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 79</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When request is invalid. Returns 401Unauthorized/403Forbid/404NotFound/400BadRequest" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementContractTests+ApiV1UsersManageSubscriptionsPatchEndpoint+WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.ProblemDetailsContentIsReturned(jwtCustomization: EnvironmentAdministratorRoleJwtCustomization { }, expectedStatusCode: Forbidden, subscriptionId: 00000000-0000-0000-0000-000000000001, userSubscriptionRolesCustomization: WithOneSaAndTdRoleCustomization { }, userId: &quot;userIde53d5aae-35d8-444c-b77e-ebf501b1df7f&quot;)" time="0.2134028" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected HttpStatusCode to be HttpStatusCode.Forbidden {value: 403}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected HttpStatusCode to be HttpStatusCode.Forbidden {value: 403}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.TestFrameworkProvider.Throw(String message)
   at FluentAssertions.Execution.DefaultAssertionStrategy.HandleFailure(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Execution.AssertionScope.FailWith(String message, Object[] args)
   at FluentAssertions.Primitives.HttpResponseMessageAssertions`1.HaveStatusCode(HttpStatusCode expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests.ApiV1UsersManageSubscriptionsPatchEndpoint.WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.ProblemDetailsContentIsReturned(ICustomization jwtCustomization, HttpStatusCode expectedStatusCode, Guid subscriptionId, ICustomization userSubscriptionRolesCustomization, String userId) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Contract.Tests.cs:line 1107
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 79</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When request is invalid. Returns 401Unauthorized/403Forbid/404NotFound/400BadRequest" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementContractTests+ApiV1UsersManageSubscriptionsPatchEndpoint+WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.ProblemDetailsContentIsReturned(jwtCustomization: UnsupportedIssuerJwtCustomization { }, expectedStatusCode: Unauthorized, subscriptionId: 00000000-0000-0000-0000-000000000001, userSubscriptionRolesCustomization: WithOneSaAndTdRoleCustomization { }, userId: &quot;userIde53d5aae-35d8-444c-b77e-ebf501b1df7f&quot;)" time="0.2113009" result="Fail">
        <failure>
          <message>System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 79</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When request is invalid. Returns 401Unauthorized/403Forbid/404NotFound/400BadRequest" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementContractTests+ApiV1UsersManageSubscriptionsPatchEndpoint+WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.ProblemDetailsContentIsReturned(jwtCustomization: ExpiredJwtCustomization { }, expectedStatusCode: Unauthorized, subscriptionId: 00000000-0000-0000-0000-000000000001, userSubscriptionRolesCustomization: WithOneSaAndTdRoleCustomization { }, userId: &quot;userIde53d5aae-35d8-444c-b77e-ebf501b1df7f&quot;)" time="0.1973731" result="Fail">
        <failure>
          <message>System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 79</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When request is invalid. Returns 401Unauthorized/403Forbid/404NotFound/400BadRequest" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementContractTests+ApiV1UsersManageSubscriptionsPatchEndpoint+WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.ProblemDetailsContentIsReturned(jwtCustomization: UnsupportedAudienceJwtCustomization { }, expectedStatusCode: Unauthorized, subscriptionId: 00000000-0000-0000-0000-000000000001, userSubscriptionRolesCustomization: WithOneSaAndTdRoleCustomization { }, userId: &quot;userIde53d5aae-35d8-444c-b77e-ebf501b1df7f&quot;)" time="0.2232936" result="Fail">
        <failure>
          <message>System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 79</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When request is invalid. Returns 401Unauthorized/403Forbid/404NotFound/400BadRequest" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementContractTests+ApiV1UsersManageSubscriptionsDeleteEndpoint+WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.ProblemDetailsContentIsReturned(expectedStatusCode: Unauthorized, subscriptionId: &quot;00000000-0000-0000-0000-000000000001&quot;, userId: &quot;userIdbceb370a-82e8-4de8-9937-6fc0d00a0d4d&quot;, subscriptionRole: SA, jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjY1MzIwNzY0LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbXSwiaHR0cHM6Ly9jaGlsaS1wdWJsaXNoLmNvbS9zdWJzY3JpcHRpb25zIjpbXSwiaHR0cHM6Ly9jaGlsaS1wdWJsaXNoLmNvbS9jdXN0b21lcl9ndWlkIjoiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIiwic3ViIjoiMSIsImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vZW52aXJvbm1lbnRJZCI6IiIsInNjb3BlIjoiIn0.)" time="0.1177428" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests.ApiV1UsersManageSubscriptionsDeleteEndpoint.WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Contract.Tests.cs:line 1209
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests.ApiV1UsersManageSubscriptionsDeleteEndpoint.WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.ProblemDetailsContentIsReturned(HttpStatusCode expectedStatusCode, String subscriptionId, String userId, Nullable`1 subscriptionRole, Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Contract.Tests.cs:line 1186
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 79</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When request is invalid. Returns 401Unauthorized/403Forbid/404NotFound/400BadRequest" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementContractTests+ApiV1UsersManageSubscriptionsDeleteEndpoint+WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.ProblemDetailsContentIsReturned(expectedStatusCode: Unauthorized, subscriptionId: &quot;00000000-0000-0000-0000-000000000001&quot;, userId: &quot;userId8e83d931-ccdb-42c9-9258-2bc8c6e19218&quot;, subscriptionRole: SA, jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJmY2E2OGIyYS1lNTFiLTRmMTAtYTExYS00YmRiYTk5YzRjNTIiLCJhenAiOiIiLCJleHAiOjE2ODkxNjcxNjQsImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vcm9sZXMiOltdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOltdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2N1c3RvbWVyX2d1aWQiOiIwMDAwMDAwMC0wMDAwLTAwMDAtMDAwMC0wMDAwMDAwMDAwMDAiLCJzdWIiOiIxIiwiaHR0cHM6Ly9jaGlsaS1wdWJsaXNoLmNvbS9lbnZpcm9ubWVudElkIjoiIiwic2NvcGUiOiIifQ.)" time="0.1082479" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests.ApiV1UsersManageSubscriptionsDeleteEndpoint.WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Contract.Tests.cs:line 1209
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests.ApiV1UsersManageSubscriptionsDeleteEndpoint.WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.ProblemDetailsContentIsReturned(HttpStatusCode expectedStatusCode, String subscriptionId, String userId, Nullable`1 subscriptionRole, Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Contract.Tests.cs:line 1186
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 79</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When request is invalid. Returns 401Unauthorized/403Forbid/404NotFound/400BadRequest" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementContractTests+ApiV1UsersManageSubscriptionsDeleteEndpoint+WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.ProblemDetailsContentIsReturned(expectedStatusCode: Unauthorized, subscriptionId: &quot;00000000-0000-0000-0000-000000000001&quot;, userId: &quot;userIde5a108ba-cc3d-4156-a7f7-bffaf38b4b35&quot;, subscriptionRole: SA, jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJlNzdmZGI0Ni0yYmViLTRlNTktOTVhMi0yOTU2ODI0OWJmYjgiLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MTY0LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbXSwiaHR0cHM6Ly9jaGlsaS1wdWJsaXNoLmNvbS9zdWJzY3JpcHRpb25zIjpbXSwiaHR0cHM6Ly9jaGlsaS1wdWJsaXNoLmNvbS9jdXN0b21lcl9ndWlkIjoiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIiwic3ViIjoiMSIsImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vZW52aXJvbm1lbnRJZCI6IiIsInNjb3BlIjoiIn0.)" time="0.1169407" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests.ApiV1UsersManageSubscriptionsDeleteEndpoint.WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Contract.Tests.cs:line 1209
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests.ApiV1UsersManageSubscriptionsDeleteEndpoint.WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.ProblemDetailsContentIsReturned(HttpStatusCode expectedStatusCode, String subscriptionId, String userId, Nullable`1 subscriptionRole, Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Contract.Tests.cs:line 1186
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 79</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When request is invalid. Returns 401Unauthorized/403Forbid/404NotFound/400BadRequest" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementContractTests+ApiV1UsersManageSubscriptionsDeleteEndpoint+WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.ProblemDetailsContentIsReturned(expectedStatusCode: Forbidden, subscriptionId: &quot;00000000-0000-0000-0000-000000000001&quot;, userId: &quot;userIde2d5a651-695d-493c-a08e-aee7f4c94e82&quot;, subscriptionRole: SA, jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNzEwOTM5OTY0LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjdhNDA4ZDBhLTNlMGYtNDI1NS05MmNlLWMxZjRlZjkxMGRkMnxFVSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiZDE0OTZiNTYtNzkxYi00NGUwLWE3NWYtODhkODA4MzdlZTA1Il0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.1345164" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests.ApiV1UsersManageSubscriptionsDeleteEndpoint.WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Contract.Tests.cs:line 1209
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests.ApiV1UsersManageSubscriptionsDeleteEndpoint.WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.ProblemDetailsContentIsReturned(HttpStatusCode expectedStatusCode, String subscriptionId, String userId, Nullable`1 subscriptionRole, Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Contract.Tests.cs:line 1186
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 79</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When request is invalid. Returns 401Unauthorized/403Forbid/404NotFound/400BadRequest" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementContractTests+ApiV1UsersManageSubscriptionsDeleteEndpoint+WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.ProblemDetailsContentIsReturned(expectedStatusCode: Forbidden, subscriptionId: &quot;00000000-0000-0000-0000-000000000001&quot;, userId: &quot;userId8e75bd74-de7e-4fa4-80aa-5db37b62b28f&quot;, subscriptionRole: SA, jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNzA5NzMwMzY0LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjc1MGIyNGE5LTUwYzktNGRmOS1iZmQxLTAxZTg2ZDUzYWIwMnxURCJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOltdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2N1c3RvbWVyX2d1aWQiOiIwMDAwMDAwMC0wMDAwLTAwMDAtMDAwMC0wMDAwMDAwMDAwMDAiLCJzdWIiOiIxIiwiaHR0cHM6Ly9jaGlsaS1wdWJsaXNoLmNvbS9lbnZpcm9ubWVudElkIjoiIiwic2NvcGUiOiIifQ.)" time="0.1351796" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests.ApiV1UsersManageSubscriptionsDeleteEndpoint.WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Contract.Tests.cs:line 1209
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests.ApiV1UsersManageSubscriptionsDeleteEndpoint.WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.ProblemDetailsContentIsReturned(HttpStatusCode expectedStatusCode, String subscriptionId, String userId, Nullable`1 subscriptionRole, Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Contract.Tests.cs:line 1186
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 79</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When request is invalid. Returns 401Unauthorized/403Forbid/404NotFound/400BadRequest" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementContractTests+ApiV1UsersManageSubscriptionsDeleteEndpoint+WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.ProblemDetailsContentIsReturned(expectedStatusCode: Forbidden, subscriptionId: &quot;00000000-0000-0000-0000-000000000001&quot;, userId: &quot;userIded8291fd-b9e2-4857-a67f-c88a9dc82c8a&quot;, subscriptionRole: SA, jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNzAxODY3OTY0LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbImIzZDdiMzUwLWYxYTYtNGFjZi05YjgxLWNmNGU1MDJhODYyOXxTVSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOltdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2N1c3RvbWVyX2d1aWQiOiIwMDAwMDAwMC0wMDAwLTAwMDAtMDAwMC0wMDAwMDAwMDAwMDAiLCJzdWIiOiIxIiwiaHR0cHM6Ly9jaGlsaS1wdWJsaXNoLmNvbS9lbnZpcm9ubWVudElkIjoiIiwic2NvcGUiOiIifQ.)" time="0.1181572" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests.ApiV1UsersManageSubscriptionsDeleteEndpoint.WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Contract.Tests.cs:line 1209
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests.ApiV1UsersManageSubscriptionsDeleteEndpoint.WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.ProblemDetailsContentIsReturned(HttpStatusCode expectedStatusCode, String subscriptionId, String userId, Nullable`1 subscriptionRole, Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Contract.Tests.cs:line 1186
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 79</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When request is invalid. Returns 401Unauthorized/403Forbid/404NotFound/400BadRequest" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementContractTests+ApiV1UsersManageSubscriptionsDeleteEndpoint+WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.ProblemDetailsContentIsReturned(expectedStatusCode: Forbidden, subscriptionId: &quot;00000000-0000-0000-0000-000000000001&quot;, userId: &quot;userId2c2841a2-8d6c-4ad8-84c5-cb8c54d17b91&quot;, subscriptionRole: SA, jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNzIzNDY3OTY0LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbImQyNWY3MTMyLTJmZmItNGYwOC1hOTUxLTljMDQxNTVkNjdkMHxDQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiYjkyNTE0M2MtODhlZi00Y2VhLWI2M2YtMTViMWQ4ZmQ2OTNmIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.1476532" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests.ApiV1UsersManageSubscriptionsDeleteEndpoint.WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Contract.Tests.cs:line 1209
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests.ApiV1UsersManageSubscriptionsDeleteEndpoint.WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.ProblemDetailsContentIsReturned(HttpStatusCode expectedStatusCode, String subscriptionId, String userId, Nullable`1 subscriptionRole, Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Contract.Tests.cs:line 1186
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 79</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When request is invalid. Returns 401Unauthorized/403Forbid/404NotFound/400BadRequest" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementContractTests+ApiV1UsersManageSubscriptionsDeleteEndpoint+WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.ProblemDetailsContentIsReturned(expectedStatusCode: Forbidden, subscriptionId: &quot;00000000-0000-0000-0000-000000000001&quot;, userId: &quot;userIdbe59ccf3-3857-48ee-a261-b7840db2976d&quot;, subscriptionRole: SA, jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNzE3Njc5MTY0LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjgxNTZhNWRiLTU0NDYtNDM0Ny1hYzUwLWU1ZDhmZDgzY2I1N3xFQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDQ3ODIzODQtMDAzZS00YTQ5LWI0NmItMzI4YzBmYTEyN2JhIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.1168998" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests.ApiV1UsersManageSubscriptionsDeleteEndpoint.WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Contract.Tests.cs:line 1209
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests.ApiV1UsersManageSubscriptionsDeleteEndpoint.WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.ProblemDetailsContentIsReturned(HttpStatusCode expectedStatusCode, String subscriptionId, String userId, Nullable`1 subscriptionRole, Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Contract.Tests.cs:line 1186
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 79</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When request is invalid. Returns 401Unauthorized/403Forbid/404NotFound/400BadRequest" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementContractTests+ApiV1UsersManageSubscriptionsDeleteEndpoint+WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.ProblemDetailsContentIsReturned(expectedStatusCode: BadRequest, subscriptionId: &quot;00000000-0000-0000-0000-000000000001&quot;, userId: &quot;userid&quot;, subscriptionRole: 100, jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNzI2MzE5MTY0LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIkZBIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vc3Vic2NyaXB0aW9ucyI6W10sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.1141791" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests.ApiV1UsersManageSubscriptionsDeleteEndpoint.WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Contract.Tests.cs:line 1209
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests.ApiV1UsersManageSubscriptionsDeleteEndpoint.WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.ProblemDetailsContentIsReturned(HttpStatusCode expectedStatusCode, String subscriptionId, String userId, Nullable`1 subscriptionRole, Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Contract.Tests.cs:line 1186
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 79</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When request is invalid. Returns 401Unauthorized/403Forbid/404NotFound/400BadRequest" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementContractTests+ApiV1UsersManageSubscriptionsDeleteEndpoint+WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.ProblemDetailsContentIsReturned(expectedStatusCode: Forbidden, subscriptionId: &quot;00000000-0000-0000-0000-000000000002&quot;, userId: &quot;userId90cead80-b428-498e-94d9-12d1a7545149&quot;, subscriptionRole: SA, jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNzEzMTg2MzY0LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMHxTQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.1476459" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests.ApiV1UsersManageSubscriptionsDeleteEndpoint.WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Contract.Tests.cs:line 1209
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests.ApiV1UsersManageSubscriptionsDeleteEndpoint.WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.ProblemDetailsContentIsReturned(HttpStatusCode expectedStatusCode, String subscriptionId, String userId, Nullable`1 subscriptionRole, Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Contract.Tests.cs:line 1186
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 79</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When request is invalid. Returns 401Unauthorized/403Forbid/404NotFound/400BadRequest" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementContractTests+ApiV1UsersManageSubscriptionsDeleteEndpoint+WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.ProblemDetailsContentIsReturned(expectedStatusCode: NotFound, subscriptionId: &quot;00000000-0000-0000-0000-000000000003&quot;, userId: &quot;userId372bafbc-ee8c-4284-b838-9eb6d378d97c&quot;, subscriptionRole: SA, jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNzIxMzA3OTY0LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIkZBIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vc3Vic2NyaXB0aW9ucyI6W10sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.1537056" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests.ApiV1UsersManageSubscriptionsDeleteEndpoint.WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Contract.Tests.cs:line 1209
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests.ApiV1UsersManageSubscriptionsDeleteEndpoint.WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.ProblemDetailsContentIsReturned(HttpStatusCode expectedStatusCode, String subscriptionId, String userId, Nullable`1 subscriptionRole, Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Contract.Tests.cs:line 1186
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 79</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When request is valid. Returns 200OK" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementContractTests+ApiV1UsersManageSubscriptionsDeleteEndpoint+WhenReturnsStatusCodeOk.ProblemDetailsContentIsReturned(subscriptionId: &quot;00000000-0000-0000-0000-000000000001&quot;, userId: &quot;1&quot;, subscriptionRole: SA, jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNzE0ODI3OTY1LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMXxTQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAxIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6Im5vbl9leGlzdGluZ191c2VyaWQiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.1158378" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests.ApiV1UsersManageSubscriptionsDeleteEndpoint.WhenReturnsStatusCodeOk.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Contract.Tests.cs:line 1238
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests.ApiV1UsersManageSubscriptionsDeleteEndpoint.WhenReturnsStatusCodeOk.ProblemDetailsContentIsReturned(String subscriptionId, String userId, Nullable`1 subscriptionRole, Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Contract.Tests.cs:line 1222
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 79</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When request is valid. Returns 200OK" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementContractTests+ApiV1UsersManageSubscriptionsDeleteEndpoint+WhenReturnsStatusCodeOk.ProblemDetailsContentIsReturned(subscriptionId: &quot;00000000-0000-0000-0000-000000000001&quot;, userId: &quot;1&quot;, subscriptionRole: null, jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNzAyMDQwNzY1LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIkZBIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vc3Vic2NyaXB0aW9ucyI6W10sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.1386467" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests.ApiV1UsersManageSubscriptionsDeleteEndpoint.WhenReturnsStatusCodeOk.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Contract.Tests.cs:line 1238
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests.ApiV1UsersManageSubscriptionsDeleteEndpoint.WhenReturnsStatusCodeOk.ProblemDetailsContentIsReturned(String subscriptionId, String userId, Nullable`1 subscriptionRole, Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Contract.Tests.cs:line 1222
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 79</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When request is invalid. Returns 401Unauthorized/403Forbid/404NotFound/400BadRequest" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementContractTests+ApiV1UsersIdPatchEndPoint+WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.ProblemDetailsContentIsReturned(jwtCustomization: SubscriptionAdministratorRoleJwtCustomization { }, expectedStatusCode: NotFound, updateUserModelCustomization: Mock&lt;ICustomization:23&gt;.Object, userId: &quot;userId983902e4-f8a0-4507-bb49-5f05af5fa332&quot;)" time="0.1981500" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected HttpStatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected HttpStatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.TestFrameworkProvider.Throw(String message)
   at FluentAssertions.Execution.DefaultAssertionStrategy.HandleFailure(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Execution.AssertionScope.FailWith(String message, Object[] args)
   at FluentAssertions.Primitives.HttpResponseMessageAssertions`1.HaveStatusCode(HttpStatusCode expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests.ApiV1UsersIdPatchEndPoint.WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.ProblemDetailsContentIsReturned(ICustomization jwtCustomization, HttpStatusCode expectedStatusCode, ICustomization updateUserModelCustomization, String userId) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Contract.Tests.cs:line 1298
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 79</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When request is invalid. Returns 401Unauthorized/403Forbid/404NotFound/400BadRequest" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementContractTests+ApiV1UsersIdPatchEndPoint+WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.ProblemDetailsContentIsReturned(jwtCustomization: FullAccessRoleJwtCustomization { }, expectedStatusCode: BadRequest, updateUserModelCustomization: ModelCustomization { }, userId: &quot;userId983902e4-f8a0-4507-bb49-5f05af5fa332&quot;)" time="0.1949534" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected HttpStatusCode to be HttpStatusCode.BadRequest {value: 400}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected HttpStatusCode to be HttpStatusCode.BadRequest {value: 400}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.TestFrameworkProvider.Throw(String message)
   at FluentAssertions.Execution.DefaultAssertionStrategy.HandleFailure(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.HttpResponseMessageAssertions`1.HaveStatusCode(HttpStatusCode expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests.ApiV1UsersIdPatchEndPoint.WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.ProblemDetailsContentIsReturned(ICustomization jwtCustomization, HttpStatusCode expectedStatusCode, ICustomization updateUserModelCustomization, String userId) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Contract.Tests.cs:line 1298
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 79</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When request is invalid. Returns 401Unauthorized/403Forbid/404NotFound/400BadRequest" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementContractTests+ApiV1UsersIdPatchEndPoint+WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.ProblemDetailsContentIsReturned(jwtCustomization: FullAccessRoleJwtCustomization { }, expectedStatusCode: BadRequest, updateUserModelCustomization: ModelCustomization { }, userId: &quot;userId983902e4-f8a0-4507-bb49-5f05af5fa332&quot;)" time="0.2075517" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected HttpStatusCode to be HttpStatusCode.BadRequest {value: 400}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected HttpStatusCode to be HttpStatusCode.BadRequest {value: 400}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.TestFrameworkProvider.Throw(String message)
   at FluentAssertions.Execution.DefaultAssertionStrategy.HandleFailure(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.HttpResponseMessageAssertions`1.HaveStatusCode(HttpStatusCode expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests.ApiV1UsersIdPatchEndPoint.WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.ProblemDetailsContentIsReturned(ICustomization jwtCustomization, HttpStatusCode expectedStatusCode, ICustomization updateUserModelCustomization, String userId) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Contract.Tests.cs:line 1298
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 79</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When request is invalid. Returns 401Unauthorized/403Forbid/404NotFound/400BadRequest" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementContractTests+ApiV1UsersIdPatchEndPoint+WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.ProblemDetailsContentIsReturned(jwtCustomization: FullAccessRoleJwtCustomization { }, expectedStatusCode: BadRequest, updateUserModelCustomization: ModelCustomization { }, userId: &quot;userId983902e4-f8a0-4507-bb49-5f05af5fa332&quot;)" time="0.2672024" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected HttpStatusCode to be HttpStatusCode.BadRequest {value: 400}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected HttpStatusCode to be HttpStatusCode.BadRequest {value: 400}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.TestFrameworkProvider.Throw(String message)
   at FluentAssertions.Execution.DefaultAssertionStrategy.HandleFailure(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.HttpResponseMessageAssertions`1.HaveStatusCode(HttpStatusCode expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests.ApiV1UsersIdPatchEndPoint.WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.ProblemDetailsContentIsReturned(ICustomization jwtCustomization, HttpStatusCode expectedStatusCode, ICustomization updateUserModelCustomization, String userId) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Contract.Tests.cs:line 1298
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 79</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When request is invalid. Returns 401Unauthorized/403Forbid/404NotFound/400BadRequest" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementContractTests+ApiV1UsersIdPatchEndPoint+WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.ProblemDetailsContentIsReturned(jwtCustomization: EnvironmentUserRoleJwtCustomization { }, expectedStatusCode: Forbidden, updateUserModelCustomization: Mock&lt;ICustomization:23&gt;.Object, userId: &quot;userId983902e4-f8a0-4507-bb49-5f05af5fa332&quot;)" time="0.1984518" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected HttpStatusCode to be HttpStatusCode.Forbidden {value: 403}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected HttpStatusCode to be HttpStatusCode.Forbidden {value: 403}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.TestFrameworkProvider.Throw(String message)
   at FluentAssertions.Execution.DefaultAssertionStrategy.HandleFailure(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.HttpResponseMessageAssertions`1.HaveStatusCode(HttpStatusCode expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests.ApiV1UsersIdPatchEndPoint.WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.ProblemDetailsContentIsReturned(ICustomization jwtCustomization, HttpStatusCode expectedStatusCode, ICustomization updateUserModelCustomization, String userId) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Contract.Tests.cs:line 1298
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 79</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When request is invalid. Returns 401Unauthorized/403Forbid/404NotFound/400BadRequest" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementContractTests+ApiV1UsersIdPatchEndPoint+WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.ProblemDetailsContentIsReturned(jwtCustomization: SupportUserRoleJwtCustomization { }, expectedStatusCode: Forbidden, updateUserModelCustomization: Mock&lt;ICustomization:23&gt;.Object, userId: &quot;userId983902e4-f8a0-4507-bb49-5f05af5fa332&quot;)" time="0.1906348" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected HttpStatusCode to be HttpStatusCode.Forbidden {value: 403}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected HttpStatusCode to be HttpStatusCode.Forbidden {value: 403}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.TestFrameworkProvider.Throw(String message)
   at FluentAssertions.Execution.DefaultAssertionStrategy.HandleFailure(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.HttpResponseMessageAssertions`1.HaveStatusCode(HttpStatusCode expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests.ApiV1UsersIdPatchEndPoint.WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.ProblemDetailsContentIsReturned(ICustomization jwtCustomization, HttpStatusCode expectedStatusCode, ICustomization updateUserModelCustomization, String userId) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Contract.Tests.cs:line 1298
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 79</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When request is invalid. Returns 401Unauthorized/403Forbid/404NotFound/400BadRequest" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementContractTests+ApiV1UsersIdPatchEndPoint+WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.ProblemDetailsContentIsReturned(jwtCustomization: TemplateDesignerRoleJwtCustomization { }, expectedStatusCode: Forbidden, updateUserModelCustomization: Mock&lt;ICustomization:23&gt;.Object, userId: &quot;userId983902e4-f8a0-4507-bb49-5f05af5fa332&quot;)" time="0.2297769" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected HttpStatusCode to be HttpStatusCode.Forbidden {value: 403}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected HttpStatusCode to be HttpStatusCode.Forbidden {value: 403}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.TestFrameworkProvider.Throw(String message)
   at FluentAssertions.Execution.DefaultAssertionStrategy.HandleFailure(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.HttpResponseMessageAssertions`1.HaveStatusCode(HttpStatusCode expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests.ApiV1UsersIdPatchEndPoint.WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.ProblemDetailsContentIsReturned(ICustomization jwtCustomization, HttpStatusCode expectedStatusCode, ICustomization updateUserModelCustomization, String userId) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Contract.Tests.cs:line 1298
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 79</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When request is invalid. Returns 401Unauthorized/403Forbid/404NotFound/400BadRequest" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementContractTests+ApiV1UsersIdPatchEndPoint+WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.ProblemDetailsContentIsReturned(jwtCustomization: EnvironmentAdministratorRoleJwtCustomization { }, expectedStatusCode: Forbidden, updateUserModelCustomization: Mock&lt;ICustomization:23&gt;.Object, userId: &quot;userId983902e4-f8a0-4507-bb49-5f05af5fa332&quot;)" time="0.1836872" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected HttpStatusCode to be HttpStatusCode.Forbidden {value: 403}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected HttpStatusCode to be HttpStatusCode.Forbidden {value: 403}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.TestFrameworkProvider.Throw(String message)
   at FluentAssertions.Execution.DefaultAssertionStrategy.HandleFailure(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.HttpResponseMessageAssertions`1.HaveStatusCode(HttpStatusCode expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests.ApiV1UsersIdPatchEndPoint.WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.ProblemDetailsContentIsReturned(ICustomization jwtCustomization, HttpStatusCode expectedStatusCode, ICustomization updateUserModelCustomization, String userId) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Contract.Tests.cs:line 1298
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 79</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When request is invalid. Returns 401Unauthorized/403Forbid/404NotFound/400BadRequest" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementContractTests+ApiV1UsersIdPatchEndPoint+WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.ProblemDetailsContentIsReturned(jwtCustomization: UnsupportedIssuerJwtCustomization { }, expectedStatusCode: Unauthorized, updateUserModelCustomization: Mock&lt;ICustomization:23&gt;.Object, userId: &quot;userId983902e4-f8a0-4507-bb49-5f05af5fa332&quot;)" time="0.2053072" result="Fail">
        <failure>
          <message>System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When request is invalid. Returns 401Unauthorized/403Forbid/404NotFound/400BadRequest" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementContractTests+ApiV1UsersIdPatchEndPoint+WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.ProblemDetailsContentIsReturned(jwtCustomization: ExpiredJwtCustomization { }, expectedStatusCode: Unauthorized, updateUserModelCustomization: Mock&lt;ICustomization:23&gt;.Object, userId: &quot;userId983902e4-f8a0-4507-bb49-5f05af5fa332&quot;)" time="0.1876553" result="Fail">
        <failure>
          <message>System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When request is invalid. Returns 401Unauthorized/403Forbid/404NotFound/400BadRequest" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementContractTests+ApiV1UsersIdPatchEndPoint+WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.ProblemDetailsContentIsReturned(jwtCustomization: UnsupportedAudienceJwtCustomization { }, expectedStatusCode: Unauthorized, updateUserModelCustomization: Mock&lt;ICustomization:23&gt;.Object, userId: &quot;userId983902e4-f8a0-4507-bb49-5f05af5fa332&quot;)" time="0.2012497" result="Fail">
        <failure>
          <message>System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When request is invalid. Returns 401Unauthorized/403Forbid/404NotFound/400BadRequest" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementContractTests+ApiV1UsersManageDeleteUserFromSubscriptionEndpoint+WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.ProblemDetailsContentIsReturned(expectedStatusCode: Unauthorized, subscriptionId: &quot;00000000-0000-0000-0000-000000000000&quot;, userId: &quot;userIda06cfb6c-c51b-4d2a-8fb2-f91f0a2cfe86&quot;, jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg4MzAzMTY4LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbXSwiaHR0cHM6Ly9jaGlsaS1wdWJsaXNoLmNvbS9zdWJzY3JpcHRpb25zIjpbXSwiaHR0cHM6Ly9jaGlsaS1wdWJsaXNoLmNvbS9jdXN0b21lcl9ndWlkIjoiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIiwic3ViIjoiMSIsImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vZW52aXJvbm1lbnRJZCI6IiIsInNjb3BlIjoiIn0.)" time="0.1564811" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests.ApiV1UsersManageDeleteUserFromSubscriptionEndpoint.WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Contract.Tests.cs:line 1378
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests.ApiV1UsersManageDeleteUserFromSubscriptionEndpoint.WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.ProblemDetailsContentIsReturned(HttpStatusCode expectedStatusCode, String subscriptionId, String userId, Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Contract.Tests.cs:line 1355
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When request is invalid. Returns 401Unauthorized/403Forbid/404NotFound/400BadRequest" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementContractTests+ApiV1UsersManageDeleteUserFromSubscriptionEndpoint+WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.ProblemDetailsContentIsReturned(expectedStatusCode: Unauthorized, subscriptionId: &quot;00000000-0000-0000-0000-000000000000&quot;, userId: &quot;userIdd2837416-be67-4c92-818f-d9eef7268ecb&quot;, jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiIzNTZhNWU1Ny1hMTY4LTRlMjAtOTVjZS04YjFlOGUyZDk1YjQiLCJhenAiOiIiLCJleHAiOjE2ODkxNjcxNjgsImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vcm9sZXMiOltdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOltdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2N1c3RvbWVyX2d1aWQiOiIwMDAwMDAwMC0wMDAwLTAwMDAtMDAwMC0wMDAwMDAwMDAwMDAiLCJzdWIiOiIxIiwiaHR0cHM6Ly9jaGlsaS1wdWJsaXNoLmNvbS9lbnZpcm9ubWVudElkIjoiIiwic2NvcGUiOiIifQ.)" time="0.1487820" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests.ApiV1UsersManageDeleteUserFromSubscriptionEndpoint.WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Contract.Tests.cs:line 1378
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests.ApiV1UsersManageDeleteUserFromSubscriptionEndpoint.WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.ProblemDetailsContentIsReturned(HttpStatusCode expectedStatusCode, String subscriptionId, String userId, Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Contract.Tests.cs:line 1355
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When request is invalid. Returns 401Unauthorized/403Forbid/404NotFound/400BadRequest" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementContractTests+ApiV1UsersManageDeleteUserFromSubscriptionEndpoint+WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.ProblemDetailsContentIsReturned(expectedStatusCode: Unauthorized, subscriptionId: &quot;00000000-0000-0000-0000-000000000000&quot;, userId: &quot;userId71ef6775-a8bc-4de5-a827-8f3cc10ebc93&quot;, jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiI0NDNhMjYwZC04MmYzLTRiZjgtYTg5OS03ZWNlMTE1YjA0OGEiLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MTY4LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbXSwiaHR0cHM6Ly9jaGlsaS1wdWJsaXNoLmNvbS9zdWJzY3JpcHRpb25zIjpbXSwiaHR0cHM6Ly9jaGlsaS1wdWJsaXNoLmNvbS9jdXN0b21lcl9ndWlkIjoiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIiwic3ViIjoiMSIsImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vZW52aXJvbm1lbnRJZCI6IiIsInNjb3BlIjoiIn0.)" time="0.1414362" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests.ApiV1UsersManageDeleteUserFromSubscriptionEndpoint.WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Contract.Tests.cs:line 1378
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests.ApiV1UsersManageDeleteUserFromSubscriptionEndpoint.WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.ProblemDetailsContentIsReturned(HttpStatusCode expectedStatusCode, String subscriptionId, String userId, Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Contract.Tests.cs:line 1355
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When request is invalid. Returns 401Unauthorized/403Forbid/404NotFound/400BadRequest" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementContractTests+ApiV1UsersManageDeleteUserFromSubscriptionEndpoint+WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.ProblemDetailsContentIsReturned(expectedStatusCode: Forbidden, subscriptionId: &quot;00000000-0000-0000-0000-000000000000&quot;, userId: &quot;userId37daa59c-8134-44df-865b-4e3aef9db289&quot;, jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNzA3OTE1OTY4LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjVkNGJjNzBhLTgwOTMtNDk2Ni04YWVkLWRiMmFiMTI4NTM0ZnxFVSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiZmE0ZGIzNGQtNGY0Yi00ZGRiLThkM2ItZWI1OWI0ZWQxMDBlIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.1437333" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests.ApiV1UsersManageDeleteUserFromSubscriptionEndpoint.WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Contract.Tests.cs:line 1378
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests.ApiV1UsersManageDeleteUserFromSubscriptionEndpoint.WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.ProblemDetailsContentIsReturned(HttpStatusCode expectedStatusCode, String subscriptionId, String userId, Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Contract.Tests.cs:line 1355
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When request is invalid. Returns 401Unauthorized/403Forbid/404NotFound/400BadRequest" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementContractTests+ApiV1UsersManageDeleteUserFromSubscriptionEndpoint+WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.ProblemDetailsContentIsReturned(expectedStatusCode: Forbidden, subscriptionId: &quot;00000000-0000-0000-0000-000000000000&quot;, userId: &quot;userId030d7e8e-a53c-4b31-8948-00ef6c37015c&quot;, jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNzI5MDgzOTY4LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbImFhZDgxZTFkLWJlZGQtNGE4NC04OTFkLWJjNjJjZjQzZmM5YXxURCJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOltdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2N1c3RvbWVyX2d1aWQiOiIwMDAwMDAwMC0wMDAwLTAwMDAtMDAwMC0wMDAwMDAwMDAwMDAiLCJzdWIiOiIxIiwiaHR0cHM6Ly9jaGlsaS1wdWJsaXNoLmNvbS9lbnZpcm9ubWVudElkIjoiIiwic2NvcGUiOiIifQ.)" time="0.1414621" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests.ApiV1UsersManageDeleteUserFromSubscriptionEndpoint.WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Contract.Tests.cs:line 1378
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests.ApiV1UsersManageDeleteUserFromSubscriptionEndpoint.WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.ProblemDetailsContentIsReturned(HttpStatusCode expectedStatusCode, String subscriptionId, String userId, Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Contract.Tests.cs:line 1355
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When request is invalid. Returns 401Unauthorized/403Forbid/404NotFound/400BadRequest" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementContractTests+ApiV1UsersManageDeleteUserFromSubscriptionEndpoint+WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.ProblemDetailsContentIsReturned(expectedStatusCode: Forbidden, subscriptionId: &quot;00000000-0000-0000-0000-000000000000&quot;, userId: &quot;userId76f449d6-4cdb-4566-9d00-3eb642bf407f&quot;, jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjk1MzAxNTY4LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjczNjA3MDc4LWMxN2MtNDMwNy1hOTM0LWZmNjIzZmQ0YTNjN3xTVSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOltdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2N1c3RvbWVyX2d1aWQiOiIwMDAwMDAwMC0wMDAwLTAwMDAtMDAwMC0wMDAwMDAwMDAwMDAiLCJzdWIiOiIxIiwiaHR0cHM6Ly9jaGlsaS1wdWJsaXNoLmNvbS9lbnZpcm9ubWVudElkIjoiIiwic2NvcGUiOiIifQ.)" time="0.1378730" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests.ApiV1UsersManageDeleteUserFromSubscriptionEndpoint.WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Contract.Tests.cs:line 1378
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests.ApiV1UsersManageDeleteUserFromSubscriptionEndpoint.WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.ProblemDetailsContentIsReturned(HttpStatusCode expectedStatusCode, String subscriptionId, String userId, Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Contract.Tests.cs:line 1355
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When request is invalid. Returns 401Unauthorized/403Forbid/404NotFound/400BadRequest" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementContractTests+ApiV1UsersManageDeleteUserFromSubscriptionEndpoint+WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.ProblemDetailsContentIsReturned(expectedStatusCode: Forbidden, subscriptionId: &quot;00000000-0000-0000-0000-000000000000&quot;, userId: &quot;userId3efae481-6929-4c03-99ab-7016158a841f&quot;, jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNzA4MDg4NzY4LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjFlZDQ1NTNjLWEyYWQtNGU1Zi1iNWFiLTFkMjdhNzNkNmU5N3xDQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiZTNjM2NiNTctZjE3Ny00NTQ0LWI4YTYtY2QwZTRiODRiOGYxIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.1509962" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests.ApiV1UsersManageDeleteUserFromSubscriptionEndpoint.WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Contract.Tests.cs:line 1378
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests.ApiV1UsersManageDeleteUserFromSubscriptionEndpoint.WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.ProblemDetailsContentIsReturned(HttpStatusCode expectedStatusCode, String subscriptionId, String userId, Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Contract.Tests.cs:line 1355
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When request is invalid. Returns 401Unauthorized/403Forbid/404NotFound/400BadRequest" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementContractTests+ApiV1UsersManageDeleteUserFromSubscriptionEndpoint+WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.ProblemDetailsContentIsReturned(expectedStatusCode: Forbidden, subscriptionId: &quot;00000000-0000-0000-0000-000000000000&quot;, userId: &quot;userId27f94b37-8048-4579-9b5d-36fdb2463587&quot;, jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNzEwNTk0MzY4LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjZiNGFjNjVjLTA4MzctNDAzMS04MzQ3LTIzNjJhZWNkOGMzMXxFQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiNGFhMDU5NmMtMWIzZS00OWQzLWIzZGEtYTFhMTZhNmExYzk1Il0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.1344098" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests.ApiV1UsersManageDeleteUserFromSubscriptionEndpoint.WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Contract.Tests.cs:line 1378
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests.ApiV1UsersManageDeleteUserFromSubscriptionEndpoint.WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.ProblemDetailsContentIsReturned(HttpStatusCode expectedStatusCode, String subscriptionId, String userId, Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Contract.Tests.cs:line 1355
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When request is invalid. Returns 401Unauthorized/403Forbid/404NotFound/400BadRequest" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementContractTests+ApiV1UsersManageDeleteUserFromSubscriptionEndpoint+WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.ProblemDetailsContentIsReturned(expectedStatusCode: NotFound, subscriptionId: &quot;00000000-0000-0000-0000-000000000002&quot;, userId: &quot;userIdf3b3cb3e-5e88-40a2-af46-589f7cd0db25&quot;, jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNzE0NzQxNTY4LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIkZBIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vc3Vic2NyaXB0aW9ucyI6W10sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.1210104" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests.ApiV1UsersManageDeleteUserFromSubscriptionEndpoint.WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Contract.Tests.cs:line 1378
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests.ApiV1UsersManageDeleteUserFromSubscriptionEndpoint.WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.ProblemDetailsContentIsReturned(HttpStatusCode expectedStatusCode, String subscriptionId, String userId, Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Contract.Tests.cs:line 1355
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When request is invalid. Returns 401Unauthorized/403Forbid/404NotFound/400BadRequest" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementContractTests+ApiV1UsersManageDeleteUserFromSubscriptionEndpoint+WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.ProblemDetailsContentIsReturned(expectedStatusCode: NotFound, subscriptionId: &quot;00000000-0000-0000-0000-000000000000&quot;, userId: &quot;userId6e55e2c0-afe4-4858-8a0f-5a1c2454c2b8&quot;, jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNzAyMDQwNzY4LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMHxTQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.1186208" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests.ApiV1UsersManageDeleteUserFromSubscriptionEndpoint.WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Contract.Tests.cs:line 1378
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests.ApiV1UsersManageDeleteUserFromSubscriptionEndpoint.WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.ProblemDetailsContentIsReturned(HttpStatusCode expectedStatusCode, String subscriptionId, String userId, Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Contract.Tests.cs:line 1355
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When request is valid. Returns 200OK" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementContractTests+ApiV1UsersManageDeleteUserFromSubscriptionEndpoint+WhenReturnsStatusCodeOk.ProblemDetailsContentIsReturned(subscriptionId: &quot;00000000-0000-0000-0000-000000000000&quot;, userId: &quot;2&quot;, jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNzMyMDIxNTY5LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMHxTQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.1309863" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests.ApiV1UsersManageDeleteUserFromSubscriptionEndpoint.WhenReturnsStatusCodeOk.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Contract.Tests.cs:line 1407
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests.ApiV1UsersManageDeleteUserFromSubscriptionEndpoint.WhenReturnsStatusCodeOk.ProblemDetailsContentIsReturned(String subscriptionId, String userId, Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Contract.Tests.cs:line 1391
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When request is valid. Returns 200OK" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementContractTests+ApiV1UsersManageDeleteUserFromSubscriptionEndpoint+WhenReturnsStatusCodeOk.ProblemDetailsContentIsReturned(subscriptionId: &quot;00000000-0000-0000-0000-000000000000&quot;, userId: &quot;2&quot;, jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNzIxMzA3OTY5LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIkZBIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vc3Vic2NyaXB0aW9ucyI6W10sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.1334189" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests.ApiV1UsersManageDeleteUserFromSubscriptionEndpoint.WhenReturnsStatusCodeOk.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Contract.Tests.cs:line 1407
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests.ApiV1UsersManageDeleteUserFromSubscriptionEndpoint.WhenReturnsStatusCodeOk.ProblemDetailsContentIsReturned(String subscriptionId, String userId, Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Contract.Tests.cs:line 1391
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When request is invalid. Returns 401Unauthorized/403Forbid/404NotFound/400BadRequest" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementContractTests+ApiV1UsersManageActivateUserEndpoint+WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.ProblemDetailsContentIsReturned(expectedStatusCode: Unauthorized, subscriptionId: &quot;00000000-0000-0000-0000-000000000001&quot;, userId: &quot;userId8bc358f1-d91f-413f-ae9c-9030493bae2d&quot;, jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg3Nzg0NzY5LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbXSwiaHR0cHM6Ly9jaGlsaS1wdWJsaXNoLmNvbS9zdWJzY3JpcHRpb25zIjpbXSwiaHR0cHM6Ly9jaGlsaS1wdWJsaXNoLmNvbS9jdXN0b21lcl9ndWlkIjoiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIiwic3ViIjoiMSIsImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vZW52aXJvbm1lbnRJZCI6IiIsInNjb3BlIjoiIn0.)" time="0.1261566" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests.ApiV1UsersManageActivateUserEndpoint.WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Contract.Tests.cs:line 1512
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests.ApiV1UsersManageActivateUserEndpoint.WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.ProblemDetailsContentIsReturned(HttpStatusCode expectedStatusCode, String subscriptionId, String userId, Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Contract.Tests.cs:line 1489
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When request is invalid. Returns 401Unauthorized/403Forbid/404NotFound/400BadRequest" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementContractTests+ApiV1UsersManageActivateUserEndpoint+WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.ProblemDetailsContentIsReturned(expectedStatusCode: Unauthorized, subscriptionId: &quot;00000000-0000-0000-0000-000000000001&quot;, userId: &quot;userId6e4f94d6-251e-4d98-b41f-e33815c93830&quot;, jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiIyZDZkMWE4Zi1mOTI2LTRjZDktOGJjNC05NDNmODNmZDRjY2EiLCJhenAiOiIiLCJleHAiOjE2ODkxNjcxNjksImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vcm9sZXMiOltdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOltdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2N1c3RvbWVyX2d1aWQiOiIwMDAwMDAwMC0wMDAwLTAwMDAtMDAwMC0wMDAwMDAwMDAwMDAiLCJzdWIiOiIxIiwiaHR0cHM6Ly9jaGlsaS1wdWJsaXNoLmNvbS9lbnZpcm9ubWVudElkIjoiIiwic2NvcGUiOiIifQ.)" time="0.1230695" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests.ApiV1UsersManageActivateUserEndpoint.WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Contract.Tests.cs:line 1512
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests.ApiV1UsersManageActivateUserEndpoint.WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.ProblemDetailsContentIsReturned(HttpStatusCode expectedStatusCode, String subscriptionId, String userId, Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Contract.Tests.cs:line 1489
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When request is invalid. Returns 401Unauthorized/403Forbid/404NotFound/400BadRequest" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementContractTests+ApiV1UsersManageActivateUserEndpoint+WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.ProblemDetailsContentIsReturned(expectedStatusCode: Unauthorized, subscriptionId: &quot;00000000-0000-0000-0000-000000000001&quot;, userId: &quot;userIddfcd1949-cb23-4790-80b2-17b4175bd9dd&quot;, jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJmMmE4MDQ5MS0xZTEzLTQzZWEtOWRhNC01MzUzYWM4NWRmODAiLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MTY5LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbXSwiaHR0cHM6Ly9jaGlsaS1wdWJsaXNoLmNvbS9zdWJzY3JpcHRpb25zIjpbXSwiaHR0cHM6Ly9jaGlsaS1wdWJsaXNoLmNvbS9jdXN0b21lcl9ndWlkIjoiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIiwic3ViIjoiMSIsImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vZW52aXJvbm1lbnRJZCI6IiIsInNjb3BlIjoiIn0.)" time="0.1473301" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests.ApiV1UsersManageActivateUserEndpoint.WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Contract.Tests.cs:line 1512
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests.ApiV1UsersManageActivateUserEndpoint.WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.ProblemDetailsContentIsReturned(HttpStatusCode expectedStatusCode, String subscriptionId, String userId, Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Contract.Tests.cs:line 1489
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When request is invalid. Returns 401Unauthorized/403Forbid/404NotFound/400BadRequest" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementContractTests+ApiV1UsersManageActivateUserEndpoint+WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.ProblemDetailsContentIsReturned(expectedStatusCode: Forbidden, subscriptionId: &quot;00000000-0000-0000-0000-000000000001&quot;, userId: &quot;userIdef83e9ff-ffcf-4d91-a7f3-0ba2e6d6e581&quot;, jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjk2NjgzOTY5LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjg2YjQ2ODQ5LWVmY2YtNDU5NS1iNTY4LTRkNDUxMWExMjllY3xFVSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiNDc5NTg1NzYtMzdiZS00NmE1LWIwOTUtMDE0OTc0Mjk2ZjQ0Il0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.1418569" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests.ApiV1UsersManageActivateUserEndpoint.WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Contract.Tests.cs:line 1512
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests.ApiV1UsersManageActivateUserEndpoint.WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.ProblemDetailsContentIsReturned(HttpStatusCode expectedStatusCode, String subscriptionId, String userId, Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Contract.Tests.cs:line 1489
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When request is invalid. Returns 401Unauthorized/403Forbid/404NotFound/400BadRequest" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementContractTests+ApiV1UsersManageActivateUserEndpoint+WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.ProblemDetailsContentIsReturned(expectedStatusCode: Forbidden, subscriptionId: &quot;00000000-0000-0000-0000-000000000001&quot;, userId: &quot;userId50b8c250-f055-4dc6-9edd-613464eefac5&quot;, jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNzEyMDYzMTY5LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbImRmODhhZGNhLWViOTQtNDQ1MC04ZWIwLTEyNDNhODI0YWE4ZXxURCJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOltdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2N1c3RvbWVyX2d1aWQiOiIwMDAwMDAwMC0wMDAwLTAwMDAtMDAwMC0wMDAwMDAwMDAwMDAiLCJzdWIiOiIxIiwiaHR0cHM6Ly9jaGlsaS1wdWJsaXNoLmNvbS9lbnZpcm9ubWVudElkIjoiIiwic2NvcGUiOiIifQ.)" time="0.1172980" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests.ApiV1UsersManageActivateUserEndpoint.WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Contract.Tests.cs:line 1512
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests.ApiV1UsersManageActivateUserEndpoint.WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.ProblemDetailsContentIsReturned(HttpStatusCode expectedStatusCode, String subscriptionId, String userId, Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Contract.Tests.cs:line 1489
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When request is invalid. Returns 401Unauthorized/403Forbid/404NotFound/400BadRequest" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementContractTests+ApiV1UsersManageActivateUserEndpoint+WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.ProblemDetailsContentIsReturned(expectedStatusCode: Forbidden, subscriptionId: &quot;00000000-0000-0000-0000-000000000001&quot;, userId: &quot;userId46e365c7-875f-4afd-83cb-e579ece768b9&quot;, jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNzE3MDc0MzY5LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjVkMDY4NzY1LWNkNWEtNDEwNy1hMTk5LTI0NWNjOTgxM2E1OHxTVSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOltdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2N1c3RvbWVyX2d1aWQiOiIwMDAwMDAwMC0wMDAwLTAwMDAtMDAwMC0wMDAwMDAwMDAwMDAiLCJzdWIiOiIxIiwiaHR0cHM6Ly9jaGlsaS1wdWJsaXNoLmNvbS9lbnZpcm9ubWVudElkIjoiIiwic2NvcGUiOiIifQ.)" time="0.1249735" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests.ApiV1UsersManageActivateUserEndpoint.WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Contract.Tests.cs:line 1512
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests.ApiV1UsersManageActivateUserEndpoint.WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.ProblemDetailsContentIsReturned(HttpStatusCode expectedStatusCode, String subscriptionId, String userId, Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Contract.Tests.cs:line 1489
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When request is invalid. Returns 401Unauthorized/403Forbid/404NotFound/400BadRequest" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementContractTests+ApiV1UsersManageActivateUserEndpoint+WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.ProblemDetailsContentIsReturned(expectedStatusCode: Forbidden, subscriptionId: &quot;00000000-0000-0000-0000-000000000001&quot;, userId: &quot;userIdaff8f9fa-2695-4a75-ad18-ccba707932dc&quot;, jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNzIzMjk1MTY5LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjMxMjlmOTI5LWYzMGMtNDQ3Yi04OTliLTJlMmFhNjBlYTFhMnxDQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiYWUzMzdiNGQtOGZmYi00ZDBiLWI5NmEtMWQ5ZmI1MGMxOTQzIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.1225738" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests.ApiV1UsersManageActivateUserEndpoint.WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Contract.Tests.cs:line 1512
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests.ApiV1UsersManageActivateUserEndpoint.WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.ProblemDetailsContentIsReturned(HttpStatusCode expectedStatusCode, String subscriptionId, String userId, Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Contract.Tests.cs:line 1489
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When request is invalid. Returns 401Unauthorized/403Forbid/404NotFound/400BadRequest" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementContractTests+ApiV1UsersManageActivateUserEndpoint+WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.ProblemDetailsContentIsReturned(expectedStatusCode: Forbidden, subscriptionId: &quot;00000000-0000-0000-0000-000000000001&quot;, userId: &quot;userId866bd19c-fb2e-4a56-b1ed-eb622d23b928&quot;, jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNzAzNzY4NzY5LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbImRmMWNiZGNlLTcwZmEtNDBhOS1hZmU4LTgzNmVmN2JjZmZhZXxFQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiOGU2NjEzZWMtMGM1OS00NDZmLWFiNjgtMTY0NmZhOTA4NjBiIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.1284906" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests.ApiV1UsersManageActivateUserEndpoint.WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Contract.Tests.cs:line 1512
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests.ApiV1UsersManageActivateUserEndpoint.WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.ProblemDetailsContentIsReturned(HttpStatusCode expectedStatusCode, String subscriptionId, String userId, Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Contract.Tests.cs:line 1489
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When request is invalid. Returns 401Unauthorized/403Forbid/404NotFound/400BadRequest" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementContractTests+ApiV1UsersManageActivateUserEndpoint+WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.ProblemDetailsContentIsReturned(expectedStatusCode: Forbidden, subscriptionId: &quot;00000000-0000-0000-0000-000000000001&quot;, userId: &quot;userId1a0e6cb1-49c7-43c6-a3fa-87762b58a2ca&quot;, jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNzI4OTk3NTY5LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMHxTQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOltdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2N1c3RvbWVyX2d1aWQiOiIwMDAwMDAwMC0wMDAwLTAwMDAtMDAwMC0wMDAwMDAwMDAwMDAiLCJzdWIiOiIxIiwiaHR0cHM6Ly9jaGlsaS1wdWJsaXNoLmNvbS9lbnZpcm9ubWVudElkIjoiIiwic2NvcGUiOiIifQ.)" time="0.1215884" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests.ApiV1UsersManageActivateUserEndpoint.WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Contract.Tests.cs:line 1512
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests.ApiV1UsersManageActivateUserEndpoint.WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.ProblemDetailsContentIsReturned(HttpStatusCode expectedStatusCode, String subscriptionId, String userId, Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Contract.Tests.cs:line 1489
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When request is invalid. Returns 401Unauthorized/403Forbid/404NotFound/400BadRequest" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementContractTests+ApiV1UsersManageActivateUserEndpoint+WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.ProblemDetailsContentIsReturned(expectedStatusCode: BadRequest, subscriptionId: &quot;00000000-0000-0000-0000-000000000001&quot;, userId: &quot; &quot;, jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNzA4MjYxNTY5LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIkZBIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vc3Vic2NyaXB0aW9ucyI6W10sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.1252751" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests.ApiV1UsersManageActivateUserEndpoint.WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Contract.Tests.cs:line 1512
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests.ApiV1UsersManageActivateUserEndpoint.WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.ProblemDetailsContentIsReturned(HttpStatusCode expectedStatusCode, String subscriptionId, String userId, Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Contract.Tests.cs:line 1489
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When request is invalid. Returns 401Unauthorized/403Forbid/404NotFound/400BadRequest" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementContractTests+ApiV1UsersManageActivateUserEndpoint+WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.ProblemDetailsContentIsReturned(expectedStatusCode: Forbidden, subscriptionId: &quot;00000000-0000-0000-0000-000000000002&quot;, userId: &quot;userId6f4dfe01-63d8-4251-9ee9-fe9c276d286e&quot;, jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNzI3MjY5NTY5LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMHxTQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.1224605" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests.ApiV1UsersManageActivateUserEndpoint.WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Contract.Tests.cs:line 1512
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests.ApiV1UsersManageActivateUserEndpoint.WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.ProblemDetailsContentIsReturned(HttpStatusCode expectedStatusCode, String subscriptionId, String userId, Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Contract.Tests.cs:line 1489
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When request is invalid. Returns 401Unauthorized/403Forbid/404NotFound/400BadRequest" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementContractTests+ApiV1UsersManageActivateUserEndpoint+WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.ProblemDetailsContentIsReturned(expectedStatusCode: NotFound, subscriptionId: &quot;00000000-0000-0000-0000-000000000003&quot;, userId: &quot;userId21dba563-910a-4605-9e3e-828d98beedc2&quot;, jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjkwNzIyMzY5LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIkZBIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vc3Vic2NyaXB0aW9ucyI6W10sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.1150003" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests.ApiV1UsersManageActivateUserEndpoint.WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Contract.Tests.cs:line 1512
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests.ApiV1UsersManageActivateUserEndpoint.WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.ProblemDetailsContentIsReturned(HttpStatusCode expectedStatusCode, String subscriptionId, String userId, Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Contract.Tests.cs:line 1489
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When request is invalid. Returns 401Unauthorized/403Forbid/404NotFound/400BadRequest" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementContractTests+ApiV1UsersManageDeactivateUserEndpoint+WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.ProblemDetailsContentIsReturned(expectedStatusCode: Unauthorized, subscriptionId: &quot;00000000-0000-0000-0000-000000000001&quot;, userId: &quot;userId8687a24e-fc32-4da6-bb7f-1ff805e526ba&quot;, jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjQ2NTcxOTcxLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbXSwiaHR0cHM6Ly9jaGlsaS1wdWJsaXNoLmNvbS9zdWJzY3JpcHRpb25zIjpbXSwiaHR0cHM6Ly9jaGlsaS1wdWJsaXNoLmNvbS9jdXN0b21lcl9ndWlkIjoiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIiwic3ViIjoiMSIsImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vZW52aXJvbm1lbnRJZCI6IiIsInNjb3BlIjoiIn0.)" time="0.1645052" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests.ApiV1UsersManageDeactivateUserEndpoint.WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Contract.Tests.cs:line 1606
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests.ApiV1UsersManageDeactivateUserEndpoint.WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.ProblemDetailsContentIsReturned(HttpStatusCode expectedStatusCode, String subscriptionId, String userId, Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Contract.Tests.cs:line 1583
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When request is invalid. Returns 401Unauthorized/403Forbid/404NotFound/400BadRequest" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementContractTests+ApiV1UsersManageDeactivateUserEndpoint+WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.ProblemDetailsContentIsReturned(expectedStatusCode: Unauthorized, subscriptionId: &quot;00000000-0000-0000-0000-000000000001&quot;, userId: &quot;userId6796bf80-0375-49fd-94f9-aa3c4895efc3&quot;, jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJlMDQzNjhiZC1hMWIxLTRhNjctODY5MC03Y2JmMzUwMmY4OGQiLCJhenAiOiIiLCJleHAiOjE2ODkxNjcxNzEsImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vcm9sZXMiOltdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOltdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2N1c3RvbWVyX2d1aWQiOiIwMDAwMDAwMC0wMDAwLTAwMDAtMDAwMC0wMDAwMDAwMDAwMDAiLCJzdWIiOiIxIiwiaHR0cHM6Ly9jaGlsaS1wdWJsaXNoLmNvbS9lbnZpcm9ubWVudElkIjoiIiwic2NvcGUiOiIifQ.)" time="0.1178843" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests.ApiV1UsersManageDeactivateUserEndpoint.WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Contract.Tests.cs:line 1606
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests.ApiV1UsersManageDeactivateUserEndpoint.WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.ProblemDetailsContentIsReturned(HttpStatusCode expectedStatusCode, String subscriptionId, String userId, Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Contract.Tests.cs:line 1583
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When request is invalid. Returns 401Unauthorized/403Forbid/404NotFound/400BadRequest" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementContractTests+ApiV1UsersManageDeactivateUserEndpoint+WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.ProblemDetailsContentIsReturned(expectedStatusCode: Unauthorized, subscriptionId: &quot;00000000-0000-0000-0000-000000000001&quot;, userId: &quot;userIdaef7fc33-6023-42a7-9f3c-251517376b4d&quot;, jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJjZDU4Njk4Yi1iMzkxLTQ4Y2YtODdhYi01YmY1NjQxODE2ZGYiLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MTcxLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbXSwiaHR0cHM6Ly9jaGlsaS1wdWJsaXNoLmNvbS9zdWJzY3JpcHRpb25zIjpbXSwiaHR0cHM6Ly9jaGlsaS1wdWJsaXNoLmNvbS9jdXN0b21lcl9ndWlkIjoiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIiwic3ViIjoiMSIsImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vZW52aXJvbm1lbnRJZCI6IiIsInNjb3BlIjoiIn0.)" time="0.1196196" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests.ApiV1UsersManageDeactivateUserEndpoint.WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Contract.Tests.cs:line 1606
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests.ApiV1UsersManageDeactivateUserEndpoint.WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.ProblemDetailsContentIsReturned(HttpStatusCode expectedStatusCode, String subscriptionId, String userId, Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Contract.Tests.cs:line 1583
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When request is invalid. Returns 401Unauthorized/403Forbid/404NotFound/400BadRequest" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementContractTests+ApiV1UsersManageDeactivateUserEndpoint+WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.ProblemDetailsContentIsReturned(expectedStatusCode: Forbidden, subscriptionId: &quot;00000000-0000-0000-0000-000000000001&quot;, userId: &quot;userId93430fc0-cf4a-46b7-96ee-5e2f7fbd865a&quot;, jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjkxOTMxOTcxLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbImFiYjhhY2ZiLTYwMzItNDM4YS05M2E3LTExNzM4M2I0MzIyM3xFVSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiNDc4Mzg0NGUtOTQ3NC00Mzg4LTk2YTQtMjBlZTJjZmRkNTdjIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.1161634" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests.ApiV1UsersManageDeactivateUserEndpoint.WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Contract.Tests.cs:line 1606
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests.ApiV1UsersManageDeactivateUserEndpoint.WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.ProblemDetailsContentIsReturned(HttpStatusCode expectedStatusCode, String subscriptionId, String userId, Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Contract.Tests.cs:line 1583
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When request is invalid. Returns 401Unauthorized/403Forbid/404NotFound/400BadRequest" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementContractTests+ApiV1UsersManageDeactivateUserEndpoint+WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.ProblemDetailsContentIsReturned(expectedStatusCode: Forbidden, subscriptionId: &quot;00000000-0000-0000-0000-000000000001&quot;, userId: &quot;userId2a090983-8165-4d47-947b-9b9ab47f85a5&quot;, jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNzAyODE4MzcxLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjIzOTVhZWFhLTEyY2UtNDQyNy05NmEyLTY0YjM0MTk4OTc2M3xURCJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOltdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2N1c3RvbWVyX2d1aWQiOiIwMDAwMDAwMC0wMDAwLTAwMDAtMDAwMC0wMDAwMDAwMDAwMDAiLCJzdWIiOiIxIiwiaHR0cHM6Ly9jaGlsaS1wdWJsaXNoLmNvbS9lbnZpcm9ubWVudElkIjoiIiwic2NvcGUiOiIifQ.)" time="0.1209908" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests.ApiV1UsersManageDeactivateUserEndpoint.WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Contract.Tests.cs:line 1606
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests.ApiV1UsersManageDeactivateUserEndpoint.WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.ProblemDetailsContentIsReturned(HttpStatusCode expectedStatusCode, String subscriptionId, String userId, Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Contract.Tests.cs:line 1583
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When request is invalid. Returns 401Unauthorized/403Forbid/404NotFound/400BadRequest" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementContractTests+ApiV1UsersManageDeactivateUserEndpoint+WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.ProblemDetailsContentIsReturned(expectedStatusCode: Forbidden, subscriptionId: &quot;00000000-0000-0000-0000-000000000001&quot;, userId: &quot;userIdb84536eb-65d2-4c09-8842-ba95d98048dc&quot;, jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNzE0MzA5NTcxLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjc0ODgzMWE3LWM0YjgtNGYzZi1iMTM0LWM5ZjBiZTkzYTEyMnxTVSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOltdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2N1c3RvbWVyX2d1aWQiOiIwMDAwMDAwMC0wMDAwLTAwMDAtMDAwMC0wMDAwMDAwMDAwMDAiLCJzdWIiOiIxIiwiaHR0cHM6Ly9jaGlsaS1wdWJsaXNoLmNvbS9lbnZpcm9ubWVudElkIjoiIiwic2NvcGUiOiIifQ.)" time="0.1178482" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests.ApiV1UsersManageDeactivateUserEndpoint.WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Contract.Tests.cs:line 1606
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests.ApiV1UsersManageDeactivateUserEndpoint.WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.ProblemDetailsContentIsReturned(HttpStatusCode expectedStatusCode, String subscriptionId, String userId, Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Contract.Tests.cs:line 1583
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When request is invalid. Returns 401Unauthorized/403Forbid/404NotFound/400BadRequest" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementContractTests+ApiV1UsersManageDeactivateUserEndpoint+WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.ProblemDetailsContentIsReturned(expectedStatusCode: Forbidden, subscriptionId: &quot;00000000-0000-0000-0000-000000000001&quot;, userId: &quot;userId9cfa4fb7-8076-421f-9902-6a64814cca1d&quot;, jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjk0MDkxOTcxLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjE4OTFhOThmLTYxY2MtNDRkNy1iNjk1LTNmNzY0NTRiZmM2NnxDQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMzdmNjU1MWUtNjVkNC00ZWYxLWE3YmUtM2ZjMzVjNDdlMjFkIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.1263067" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests.ApiV1UsersManageDeactivateUserEndpoint.WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Contract.Tests.cs:line 1606
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests.ApiV1UsersManageDeactivateUserEndpoint.WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.ProblemDetailsContentIsReturned(HttpStatusCode expectedStatusCode, String subscriptionId, String userId, Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Contract.Tests.cs:line 1583
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When request is invalid. Returns 401Unauthorized/403Forbid/404NotFound/400BadRequest" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementContractTests+ApiV1UsersManageDeactivateUserEndpoint+WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.ProblemDetailsContentIsReturned(expectedStatusCode: Forbidden, subscriptionId: &quot;00000000-0000-0000-0000-000000000001&quot;, userId: &quot;userIdb12acad4-bcad-4da4-8d5d-92ea378737b1&quot;, jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNzMwNjM5MTcxLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjQzNjVkMTJlLTEyM2YtNDdlMC1iNGIwLWViZjA5YjY2OTY0YnxFQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMWMzZGIxM2YtY2RkZS00NGEzLTg5NzgtOGI4NWRkYjJjYTM1Il0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.1260984" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests.ApiV1UsersManageDeactivateUserEndpoint.WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Contract.Tests.cs:line 1606
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests.ApiV1UsersManageDeactivateUserEndpoint.WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.ProblemDetailsContentIsReturned(HttpStatusCode expectedStatusCode, String subscriptionId, String userId, Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Contract.Tests.cs:line 1583
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When request is invalid. Returns 401Unauthorized/403Forbid/404NotFound/400BadRequest" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementContractTests+ApiV1UsersManageDeactivateUserEndpoint+WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.ProblemDetailsContentIsReturned(expectedStatusCode: Forbidden, subscriptionId: &quot;00000000-0000-0000-0000-000000000001&quot;, userId: &quot;userId7a319c75-c7fb-41db-a648-ff06d09463eb&quot;, jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNzMxMDcxMTcxLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMHxTQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOltdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2N1c3RvbWVyX2d1aWQiOiIwMDAwMDAwMC0wMDAwLTAwMDAtMDAwMC0wMDAwMDAwMDAwMDAiLCJzdWIiOiIxIiwiaHR0cHM6Ly9jaGlsaS1wdWJsaXNoLmNvbS9lbnZpcm9ubWVudElkIjoiIiwic2NvcGUiOiIifQ.)" time="0.1203792" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests.ApiV1UsersManageDeactivateUserEndpoint.WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Contract.Tests.cs:line 1606
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests.ApiV1UsersManageDeactivateUserEndpoint.WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.ProblemDetailsContentIsReturned(HttpStatusCode expectedStatusCode, String subscriptionId, String userId, Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Contract.Tests.cs:line 1583
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When request is invalid. Returns 401Unauthorized/403Forbid/404NotFound/400BadRequest" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementContractTests+ApiV1UsersManageDeactivateUserEndpoint+WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.ProblemDetailsContentIsReturned(expectedStatusCode: BadRequest, subscriptionId: &quot;00000000-0000-0000-0000-000000000001&quot;, userId: &quot; &quot;, jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNzE1MjU5OTcxLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIkZBIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vc3Vic2NyaXB0aW9ucyI6W10sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.1269466" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests.ApiV1UsersManageDeactivateUserEndpoint.WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Contract.Tests.cs:line 1606
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests.ApiV1UsersManageDeactivateUserEndpoint.WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.ProblemDetailsContentIsReturned(HttpStatusCode expectedStatusCode, String subscriptionId, String userId, Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Contract.Tests.cs:line 1583
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When request is invalid. Returns 401Unauthorized/403Forbid/404NotFound/400BadRequest" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementContractTests+ApiV1UsersManageDeactivateUserEndpoint+WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.ProblemDetailsContentIsReturned(expectedStatusCode: Forbidden, subscriptionId: &quot;00000000-0000-0000-0000-000000000002&quot;, userId: &quot;userId9389544c-d01c-4270-9c35-a79e8426c03a&quot;, jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjk1ODE5OTcxLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMHxTQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.1126016" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests.ApiV1UsersManageDeactivateUserEndpoint.WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Contract.Tests.cs:line 1606
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests.ApiV1UsersManageDeactivateUserEndpoint.WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.ProblemDetailsContentIsReturned(HttpStatusCode expectedStatusCode, String subscriptionId, String userId, Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Contract.Tests.cs:line 1583
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When request is invalid. Returns 401Unauthorized/403Forbid/404NotFound/400BadRequest" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementContractTests+ApiV1UsersManageDeactivateUserEndpoint+WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.ProblemDetailsContentIsReturned(expectedStatusCode: NotFound, subscriptionId: &quot;00000000-0000-0000-0000-000000000003&quot;, userId: &quot;userIddbd085b1-9143-4e56-b6f1-f49cc70c7676&quot;, jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNzI5MjU2NzcxLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIkZBIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vc3Vic2NyaXB0aW9ucyI6W10sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.1297548" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests.ApiV1UsersManageDeactivateUserEndpoint.WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Contract.Tests.cs:line 1606
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementContractTests.ApiV1UsersManageDeactivateUserEndpoint.WhenReturnsStatusCodeUnauthorizedOrNotFoundOrForbidOrBadRequest.ProblemDetailsContentIsReturned(HttpStatusCode expectedStatusCode, String subscriptionId, String userId, Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Contract.Tests.cs:line 1583
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests+WhenAddingANewUser+WhenEmailIsNull.AnHttpBadRequestStatusCodeIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenAddingANewUser+WhenEmailIsNull.AnHttpBadRequestStatusCodeIsReturned(model: AddUserModel { CustomerGuid = cae45802-3433-4360-8d43-d0731366618f, Email = null, FirstName = &quot;FirstNamee77eaaca-8c67-498a-8a10-08799f3680ce&quot;, LastName = &quot;LastName28c1f0d0-1341-405b-a540-3ea79e2b1a1a&quot;, SubscriptionIds = [1afad2de-2f15-4a46-9cf5-616883160350, 20872655-a5ba-4f81-a650-828da042ad11, 2d94e10f-08ca-4a83-b7da-cacca545fb83] })" time="0.1945349" result="Fail">
        <failure>
          <message>System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests+WhenAddingANewUser+WhenEmailIsEmpty.AnHttpBadRequestStatusCodeIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenAddingANewUser+WhenEmailIsEmpty.AnHttpBadRequestStatusCodeIsReturned(model: AddUserModel { CustomerGuid = c8230bd2-dbf1-4b39-bf6a-33b7a2c013b5, Email = &quot;&quot;, FirstName = &quot;FirstName2c323a6f-1786-478d-b527-baf2eaf3834d&quot;, LastName = &quot;LastName0725f853-13ef-4561-879c-e834f5277eda&quot;, SubscriptionIds = [e70c9b87-2bbc-4e02-8e74-396bb4229319, 321d29f4-e156-45ac-a813-95b65ebceeba, 9f1aa878-27b9-438f-abc3-af6cddbe3e7e] })" time="0.1301296" result="Fail">
        <failure>
          <message>System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests+WhenAddingANewUser+WhenEmailIsWhiteSpace.AnHttpBadRequestStatusCodeIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenAddingANewUser+WhenEmailIsWhiteSpace.AnHttpBadRequestStatusCodeIsReturned(model: AddUserModel { CustomerGuid = 4ff99bd3-32e0-48da-a6bd-20fb429667a0, Email = &quot; &quot;, FirstName = &quot;FirstName7d98dce0-6489-44cc-804c-e6354bfe4c17&quot;, LastName = &quot;LastName7f649d8e-c804-43df-ac1e-fa161540b333&quot;, SubscriptionIds = [aff59057-7733-49f6-9d35-4b9a607a3d31, 6eba9a6c-3079-4a7c-9cb2-d47d6855fb74, 9c25a104-a4cd-4f19-b4f5-5369ce544c4b] })" time="0.1630250" result="Fail">
        <failure>
          <message>System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests+WhenAddingANewUser+WhenEmailIsInvalid.AnHttpBadRequestStatusCodeIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenAddingANewUser+WhenEmailIsInvalid.AnHttpBadRequestStatusCodeIsReturned(model: AddUserModel { CustomerGuid = 9598561e-8567-40df-9c76-e893e969a164, Email = &quot;Emailcce52db6-53ed-487a-a95d-3af2342615cb&quot;, FirstName = &quot;FirstName56030a64-359f-4bd0-a175-fcab00b2805a&quot;, LastName = &quot;LastNamea56aa197-5ccf-45f2-9d71-4b59cb834264&quot;, SubscriptionIds = [fa5d8314-52cb-4b1d-a7d4-22523f197ae7, 11e1ba9f-3b06-4dd7-a7e5-9eb462f28584, 3bbb42e8-aa6d-44f4-9452-600edfcb44c7] })" time="0.1415582" result="Fail">
        <failure>
          <message>System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests+WhenAddingANewUser+WhenNoFirstNameIsProvided.AnHttpBadRequestStatusCodeIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenAddingANewUser+WhenNoFirstNameIsProvided.AnHttpBadRequestStatusCodeIsReturned(model: AddUserModel { CustomerGuid = 0400d7a3-13f2-45ac-888a-83c3fe4a2f03, Email = &quot;5031b6d2-f2c2-4547-9fd4-2d452e69d074@example.net&quot;, FirstName = null, LastName = &quot;LastNamec6bb73ea-6bf2-427e-81ce-946de7619716&quot;, SubscriptionIds = [9b9c8f04-ceb0-4955-9a46-a8d0acde2e80, 382db7e8-d8e2-4b61-a557-e308ba6497fd, c62c3fe9-51ab-4f9b-b5a2-a09e5431c0a2] })" time="0.1400555" result="Fail">
        <failure>
          <message>System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests+WhenAddingANewUser+WhenNoLastNameIsProvided.AnHttpBadRequestStatusCodeIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenAddingANewUser+WhenNoLastNameIsProvided.AnHttpBadRequestStatusCodeIsReturned(model: AddUserModel { CustomerGuid = 6ff52b60-8bb9-4024-82c5-1ce234c5311b, Email = &quot;c3ee0648-a20e-4ce0-a8fa-ed1ab8925fe4@example.org&quot;, FirstName = &quot;FirstNamef6b86281-0bab-412e-b96c-2b4943779b74&quot;, LastName = null, SubscriptionIds = [8fab79e1-312e-4e72-a69a-2c0242e1a835, 553058c0-0bd0-45c6-896b-12fff3c8946e, a37238da-5e0a-4528-b30d-25be80f18d8e] })" time="0.1288225" result="Fail">
        <failure>
          <message>System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests+WhenAddingANewUser+WhenTheSignatureIsInvalid.AnHttpBadRequestStatusCodeIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenAddingANewUser+WhenTheSignatureIsInvalid.AnHttpBadRequestStatusCodeIsReturned(model: AddUserModel { CustomerGuid = 661beb32-b986-4431-971d-a11a5ebe5286, Email = &quot;b15e1acd-5047-4598-97ea-58c7eecc54e5@example.com&quot;, FirstName = &quot;FirstName3323d264-c751-4aee-a0d2-2dbbfd911f6a&quot;, LastName = &quot;LastName2d469495-8111-4e30-be76-916b7a1eb82c&quot;, SubscriptionIds = [39e95d14-90aa-45e6-8838-84a77c004425, dac0fe63-c40a-476e-880e-a4ae55f098d9, 29a83943-2f8c-47c6-a850-7c447f5bc034] })" time="0.1297628" result="Fail">
        <failure>
          <message>System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests+WhenUpdatingAUser+WhenNoTokenIsProvided.AnHttpUnauthorizedStatusCodeIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenUpdatingAUser+WhenNoTokenIsProvided.AnHttpUnauthorizedStatusCodeIsReturned(userId: &quot;userId9ecbf00f-0008-4460-a20b-03c00262cddb&quot;, nameModel: UpdateUserNameModel { FirstName = &quot;FirstNamed90a1940-c95f-42f8-b3df-c631c315ab9f&quot;, LastName = &quot;LastName2f4dc754-a85f-4e18-88aa-b325c226001a&quot; })" time="0.1361155" result="Fail">
        <failure>
          <message>System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests+WhenUpdatingAUser+WhenNoFirstNameIsProvided.AnHttpBadRequestStatusCodeIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenUpdatingAUser+WhenNoFirstNameIsProvided.AnHttpBadRequestStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNzA2MzYwNzc0LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIlNBIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vc3Vic2NyaXB0aW9ucyI6W10sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., userId: &quot;userIdfd1df948-b155-4ef6-a13f-70a764b41931&quot;, nameModel: UpdateUserNameModel { FirstName = null, LastName = &quot;LastName59f8b1a8-caf3-4b57-b9e8-3f9ce0f4ee97&quot; })" time="0.3305085" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected result.StatusCode to be HttpStatusCode.BadRequest {value: 400}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected result.StatusCode to be HttpStatusCode.BadRequest {value: 400}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.TestFrameworkProvider.Throw(String message)
   at FluentAssertions.Execution.DefaultAssertionStrategy.HandleFailure(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.EnumAssertions`2.Be(TEnum expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenUpdatingAUser.WhenNoFirstNameIsProvided.AnHttpBadRequestStatusCodeIsReturned(Jwt jwt, String userId, UpdateUserNameModel nameModel) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 466
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests+WhenUpdatingAUser+WhenNoLastNameIsProvided.AnHttpBadRequestStatusCodeIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenUpdatingAUser+WhenNoLastNameIsProvided.AnHttpBadRequestStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNzA3MDUxOTc0LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIlNBIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vc3Vic2NyaXB0aW9ucyI6W10sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., userId: &quot;userId6db22613-8ee4-48a9-acad-9ec0c8ce6090&quot;, nameModel: UpdateUserNameModel { FirstName = &quot;FirstName9e4376c8-6c38-4983-af23-e06402781d1e&quot;, LastName = null })" time="0.1988391" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected result.StatusCode to be HttpStatusCode.BadRequest {value: 400}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected result.StatusCode to be HttpStatusCode.BadRequest {value: 400}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.TestFrameworkProvider.Throw(String message)
   at FluentAssertions.Execution.DefaultAssertionStrategy.HandleFailure(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.EnumAssertions`2.Be(TEnum expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenUpdatingAUser.WhenNoLastNameIsProvided.AnHttpBadRequestStatusCodeIsReturned(Jwt jwt, String userId, UpdateUserNameModel nameModel) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 488
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests+WhenUpdatingAUser+WhenTheUserWasCreated.AnHttpOkStatusCodeIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenUpdatingAUser+WhenTheUserWasCreated.AnHttpOkStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjk0NDM3NTc0LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIkZBIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vc3Vic2NyaXB0aW9ucyI6W10sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., userId: &quot;userId51fdf369-0414-4908-b53f-6c53d4dbfb23&quot;, nameModel: UpdateUserNameModel { FirstName = &quot;FirstName3cbfd075-7504-4fe4-be1f-a337500d230a&quot;, LastName = &quot;LastNamee0b181a7-5a07-448f-82e0-cb04fa74278f&quot; })" time="0.1835211" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected result.StatusCode to be HttpStatusCode.OK {value: 200}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected result.StatusCode to be HttpStatusCode.OK {value: 200}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.TestFrameworkProvider.Throw(String message)
   at FluentAssertions.Execution.DefaultAssertionStrategy.HandleFailure(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.EnumAssertions`2.Be(TEnum expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenUpdatingAUser.WhenTheUserWasCreated.AnHttpOkStatusCodeIsReturned(Jwt jwt, String userId, UpdateUserNameModel nameModel) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 510
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests+WhenUpdatingAUser+WhenTheUserCreationFailed.AnHttpInternalServerErrorStatusCodeIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenUpdatingAUser+WhenTheUserCreationFailed.AnHttpInternalServerErrorStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNzA3MTM4Mzc0LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIldBIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vc3Vic2NyaXB0aW9ucyI6W10sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., userId: &quot;userId61f2d6ba-1937-4cfd-a268-b86475da615d&quot;, nameModel: UpdateUserNameModel { FirstName = &quot;FirstName57ed3341-379e-4ee1-a5f7-b80afcab7e63&quot;, LastName = &quot;LastNamee4d26449-c842-4ac8-8641-83582d205b95&quot; })" time="0.1883812" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected result.StatusCode to be HttpStatusCode.InternalServerError {value: 500}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected result.StatusCode to be HttpStatusCode.InternalServerError {value: 500}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.TestFrameworkProvider.Throw(String message)
   at FluentAssertions.Execution.DefaultAssertionStrategy.HandleFailure(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.EnumAssertions`2.Be(TEnum expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenUpdatingAUser.WhenTheUserCreationFailed.AnHttpInternalServerErrorStatusCodeIsReturned(Jwt jwt, String userId, UpdateUserNameModel nameModel) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 547
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests+WhenUpdatingAUser+WhenTheUserNotFound.AnHttpNotFoundStatusCodeIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenUpdatingAUser+WhenTheUserNotFound.AnHttpNotFoundStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNzExOTc2Nzc1LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIkVBIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vc3Vic2NyaXB0aW9ucyI6W10sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., userId: &quot;userIdabc0bba8-ea3c-4c57-b4f1-10d5545d03f7&quot;, nameModel: UpdateUserNameModel { FirstName = &quot;FirstName0976d5c3-80ba-4cdf-baa5-e9d47a5214eb&quot;, LastName = &quot;LastNameb3dc08e1-4600-4fdb-82f1-858d6286a261&quot; })" time="0.1949873" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected result.StatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected result.StatusCode to be HttpStatusCode.NotFound {value: 404}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.TestFrameworkProvider.Throw(String message)
   at FluentAssertions.Execution.DefaultAssertionStrategy.HandleFailure(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.EnumAssertions`2.Be(TEnum expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenUpdatingAUser.WhenTheUserNotFound.AnHttpNotFoundStatusCodeIsReturned(Jwt jwt, String userId, UpdateUserNameModel nameModel) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 584
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests+WhenRequestingTheUserEmailVerificationStatus+WhenNoUserIdIsProvided.AnHttpBadRequestStatusCodeIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenRequestingTheUserEmailVerificationStatus+WhenNoUserIdIsProvided.AnHttpBadRequestStatusCodeIsReturned" time="0.1264521" result="Fail">
        <failure>
          <message>System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests+WhenRequestingTheUserEmailVerificationStatus+WhenTheUserIsNotFound.AnHttpNotFoundStatusCodeIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenRequestingTheUserEmailVerificationStatus+WhenTheUserIsNotFound.AnHttpNotFoundStatusCodeIsReturned" time="0.1390520" result="Fail">
        <failure>
          <message>System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests+WhenRequestingTheUserEmailVerificationStatus+WhenAnIdentityServerErrorExceptionIsRaised.AnHttpInternalServerErrorStatusCodeIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenRequestingTheUserEmailVerificationStatus+WhenAnIdentityServerErrorExceptionIsRaised.AnHttpInternalServerErrorStatusCodeIsReturned" time="0.1469573" result="Fail">
        <failure>
          <message>System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests+WhenMarkingUserAsMigrated+WhenNoSignatureIsProvided.ReturnsBadRequest" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenMarkingUserAsMigrated+WhenNoSignatureIsProvided.ReturnsBadRequest(model: MarkUserMigratedModel { UserEmail = &quot;6c76da6d-958d-4ad5-81da-224ceae017bb@example.net&quot; })" time="0.1320060" result="Fail">
        <failure>
          <message>System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests+WhenMarkingUserAsMigrated+WhenSignatureIsNotValid.ReturnsBadRequest" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenMarkingUserAsMigrated+WhenSignatureIsNotValid.ReturnsBadRequest(model: MarkUserMigratedModel { UserEmail = &quot;10458b43-d8f3-4cd3-863d-c6aad6390928@example.org&quot; })" time="0.1324921" result="Fail">
        <failure>
          <message>System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests+WhenGettingUserAccessibleSubscriptions+WhenNoSignatureIsProvided.ReturnsBadRequest" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenGettingUserAccessibleSubscriptions+WhenNoSignatureIsProvided.ReturnsBadRequest(model: UserAccessibleSubscriptionsModel { UserEmail = &quot;6707abd4-6567-48c9-b48d-cde588028193@example.net&quot; })" time="0.1363642" result="Fail">
        <failure>
          <message>System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests+WhenGettingUserAccessibleSubscriptions+WhenSignatureIsNotValid.ReturnsBadRequest" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenGettingUserAccessibleSubscriptions+WhenSignatureIsNotValid.ReturnsBadRequest(model: UserAccessibleSubscriptionsModel { UserEmail = &quot;cb0ff810-6d24-43d1-af4f-c35fc41ded7a@example.org&quot; })" time="0.1279559" result="Fail">
        <failure>
          <message>System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When hide flag is enabled. Return 404 NotFound" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenInvitingUsers+WhenHideFeatureFlagEnabled.AnHttpMethodNotAllowedStatusCodeIsReturned(accessRole: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJJc3N1ZXI0Y2JkOWJhMi04MDNkLTRjYzAtOTI4Mi0xN2Y4ZDg1ZjhlNzUiLCJhdWQiOiJBdWRpZW5jZTA0MmQxZTRlLTkyY2QtNGY5ZC1iYzhiLWRmZmE2MjgyYWQxOCIsImF6cCI6IkNsaWVudElkY2NiZjY2MjEtZjgxNi00OWY1LWIyOTQtYjdjNmQ2MDBiYjZjIiwiZXhwIjoxNzM5NTQ3MDk1LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIlNBIiwiRUEiLCJURCJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiM2RhOWQ0ZTMtN2FmMi00OGIxLWFmMWItYTc4NWJkODBiOWQyIiwiMWZjNGY0MGMtZDU3OC00MTZiLWEwYWMtOGJiOGUzNmM4MWUxIiwiMGU1Y2M0ZDAtZmYyYi00MWYzLTg2MzQtYTMzNGYxMjY4OTNlIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjFjYjBhNTFhLTA4NzUtNGQ0Yy1iY2Y3LTA0YzIzYWFlMzM5OSIsInN1YiI6IlVzZXJJZDViYmYxNzFjLTc4MTAtNDNlMS05NmFjLTUxMDU5NDVkNmUyMSIsImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vZW52aXJvbm1lbnRJZCI6IkVudmlyb25tZW50ZTc4ZDhjYjAtNWQ4ZS00MzI0LWFhODEtZmU2MjkzYzdlMTgwIiwic2NvcGUiOiI1M2YxYjgwOS1iZGZmLTRjMmYtOTE1MC02YTBjZjAyNmMwODQgZTFmNTQzOTgtN2NiZi00YjgwLWFjMjctNWE3MDg3NWJhMTQxIGE4MGE2OTY5LWM4OTYtNDk3Ni04NDA5LTBjNDA2OTMwYWM3ZiJ9., model: InviteUsersModel { Environments = [EnvironmentRoleModel { ... }, EnvironmentRoleModel { ... }, EnvironmentRoleModel { ... }], SubscriptionIds = [9ffeebf3-c0b5-4e87-a1f2-4a440a37a8c5, d945acf7-5646-46e0-9308-fc6974531094, 4f10e0fb-7e73-4994-8954-d3f65615cae7], UserEmails = [&quot;d31d544f-009d-47d1-8aaa-6702846b45e5&quot;, &quot;14eae0e4-9fdd-434a-8dd0-e3744ef616e0&quot;, &quot;a8e8905c-5293-42af-b788-07fee3b5bb98&quot;] })" time="0.1444783" result="Fail">
        <failure>
          <message>System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When token is not provided. Return 401 Unauthorized" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenInvitingUsers+WhenNoTokenIsProvided.AnHttpUnauthorizedStatusCodeIsReturned(model: InviteUsersModel { Environments = [EnvironmentRoleModel { ... }, EnvironmentRoleModel { ... }, EnvironmentRoleModel { ... }], SubscriptionIds = [7f9aa53f-a7ff-4ed9-8c7a-64237155ed15, 8643dc78-940e-4335-b579-1116e00528e3, a12a39aa-ae76-49e8-9508-77010702de36], UserEmails = [&quot;a46f8951-6c1c-442d-9402-d22d1ba8f30c&quot;, &quot;21eb24f1-e586-4e47-a46e-d8cd37dcca9f&quot;, &quot;7d641b7c-d90e-49e4-9ea4-bb5f4e6e86f1&quot;] })" time="0.1222132" result="Fail">
        <failure>
          <message>System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When token is invalid: exireped/has unsupported audience/unsupported issuer. Return 401 Unauthorized" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenInvitingUsers+WhenTheTokenIsInvalid.AnHttpUnauthorizedStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiI0MDQ0ZmYzZi00ZGFlLTQwMDYtOGVjYi02NmEzN2JmNzg1NTMiLCJhenAiOiIiLCJleHAiOjE2ODkxNjcxNzYsImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vcm9sZXMiOltdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOltdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2N1c3RvbWVyX2d1aWQiOiIwMDAwMDAwMC0wMDAwLTAwMDAtMDAwMC0wMDAwMDAwMDAwMDAiLCJzdWIiOiIxIiwiaHR0cHM6Ly9jaGlsaS1wdWJsaXNoLmNvbS9lbnZpcm9ubWVudElkIjoiIiwic2NvcGUiOiIifQ., model: InviteUsersModel { Environments = [EnvironmentRoleModel { ... }, EnvironmentRoleModel { ... }, EnvironmentRoleModel { ... }], SubscriptionIds = [f80bc91f-f9f1-4481-ae94-4c9d14fd8c4d, b13384f7-0c6d-48bf-bac1-0c1234115e62, 0bd24401-f6c3-4b15-bc04-3501bba24e30], UserEmails = [&quot;3fbc97a1-b8af-4aaa-abf5-722629d02c0c&quot;, &quot;fd6092bf-3bd1-47ed-b29a-8c6aeed17dee&quot;, &quot;a233456c-76ac-447d-a74b-ce847c2b7026&quot;] })" time="0.1940747" result="Fail">
        <failure>
          <message>System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When token is invalid: exireped/has unsupported audience/unsupported issuer. Return 401 Unauthorized" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenInvitingUsers+WhenTheTokenIsInvalid.AnHttpUnauthorizedStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJmZTlkYWZkOS05N2I2LTQxNTktYWUzZS03NDU2N2Y0ZDcwNGIiLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MTc2LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbXSwiaHR0cHM6Ly9jaGlsaS1wdWJsaXNoLmNvbS9zdWJzY3JpcHRpb25zIjpbXSwiaHR0cHM6Ly9jaGlsaS1wdWJsaXNoLmNvbS9jdXN0b21lcl9ndWlkIjoiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIiwic3ViIjoiMSIsImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vZW52aXJvbm1lbnRJZCI6IiIsInNjb3BlIjoiIn0., model: InviteUsersModel { Environments = [EnvironmentRoleModel { ... }, EnvironmentRoleModel { ... }, EnvironmentRoleModel { ... }], SubscriptionIds = [58832eeb-d003-45c6-bdbb-da6013c9b27e, 75bf4327-e6af-4ecc-a79b-12283f197410, dfed8220-51d9-41e6-b225-8c014cbc41e3], UserEmails = [&quot;f6581dd0-d3ee-4de2-8918-d106d6e29095&quot;, &quot;ce2a639d-dc5e-4f44-a644-23cbad44ed16&quot;, &quot;81e92cab-5454-4bb9-aa03-e7e1af4c64b5&quot;] })" time="0.1934632" result="Fail">
        <failure>
          <message>System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When token is invalid: exireped/has unsupported audience/unsupported issuer. Return 401 Unauthorized" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenInvitingUsers+WhenTheTokenIsInvalid.AnHttpUnauthorizedStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjYzOTM4Mzc2LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbXSwiaHR0cHM6Ly9jaGlsaS1wdWJsaXNoLmNvbS9zdWJzY3JpcHRpb25zIjpbXSwiaHR0cHM6Ly9jaGlsaS1wdWJsaXNoLmNvbS9jdXN0b21lcl9ndWlkIjoiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIiwic3ViIjoiMSIsImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vZW52aXJvbm1lbnRJZCI6IiIsInNjb3BlIjoiIn0., model: InviteUsersModel { Environments = [EnvironmentRoleModel { ... }, EnvironmentRoleModel { ... }, EnvironmentRoleModel { ... }], SubscriptionIds = [7c272614-51be-491a-93ea-8d6baff55dec, 964db73a-579b-424f-8655-32559cd6fa35, 56e8f8e1-eaf3-43ee-839a-b4b24e45741b], UserEmails = [&quot;62f622b3-e086-4298-8250-753fe873bee9&quot;, &quot;4572d020-8391-464a-b428-7b76fcde468e&quot;, &quot;445c8e80-fa0d-42bc-b934-4d418c88c352&quot;] })" time="0.1895780" result="Fail">
        <failure>
          <message>System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests+WhenGettingUserAsync+WhenNoTokenIsProvided.AnHttpUnauthorizedStatusCodeIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenGettingUserAsync+WhenNoTokenIsProvided.AnHttpUnauthorizedStatusCodeIsReturned" time="0.1720924" result="Fail">
        <failure>
          <message>System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests+WhenGettingUserAsync+WhenTheTokenIsInvalid.AnHttpUnauthorizedStatusCodeIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenGettingUserAsync+WhenTheTokenIsInvalid.AnHttpUnauthorizedStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiIyMmJhZTFjNi03N2UyLTQxM2YtOTI0Yy1hYTExZTdiZDk3OGYiLCJhenAiOiIiLCJleHAiOjE2ODkxNjcxNzcsImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vcm9sZXMiOltdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOltdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2N1c3RvbWVyX2d1aWQiOiIwMDAwMDAwMC0wMDAwLTAwMDAtMDAwMC0wMDAwMDAwMDAwMDAiLCJzdWIiOiIxIiwiaHR0cHM6Ly9jaGlsaS1wdWJsaXNoLmNvbS9lbnZpcm9ubWVudElkIjoiIiwic2NvcGUiOiIifQ.)" time="0.1888643" result="Fail">
        <failure>
          <message>System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests+WhenGettingUserAsync+WhenTheTokenIsInvalid.AnHttpUnauthorizedStatusCodeIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenGettingUserAsync+WhenTheTokenIsInvalid.AnHttpUnauthorizedStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiIwY2IwMmZjNS0wNTgxLTQ5Y2EtODY3ZC1mOGVjOTQ4YzRiNDYiLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MTc3LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbXSwiaHR0cHM6Ly9jaGlsaS1wdWJsaXNoLmNvbS9zdWJzY3JpcHRpb25zIjpbXSwiaHR0cHM6Ly9jaGlsaS1wdWJsaXNoLmNvbS9jdXN0b21lcl9ndWlkIjoiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIiwic3ViIjoiMSIsImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vZW52aXJvbm1lbnRJZCI6IiIsInNjb3BlIjoiIn0.)" time="0.2284076" result="Fail">
        <failure>
          <message>System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests+WhenGettingUserAsync+WhenTheTokenIsInvalid.AnHttpUnauthorizedStatusCodeIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenGettingUserAsync+WhenTheTokenIsInvalid.AnHttpUnauthorizedStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjY5NDY3OTc3LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbXSwiaHR0cHM6Ly9jaGlsaS1wdWJsaXNoLmNvbS9zdWJzY3JpcHRpb25zIjpbXSwiaHR0cHM6Ly9jaGlsaS1wdWJsaXNoLmNvbS9jdXN0b21lcl9ndWlkIjoiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIiwic3ViIjoiMSIsImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vZW52aXJvbm1lbnRJZCI6IiIsInNjb3BlIjoiIn0.)" time="0.2306646" result="Fail">
        <failure>
          <message>System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When feature flag is enabled. Returns 404HttpNotFound." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenUpdatingUserEnvironments+WhenHideFeatureFlagEnabled.AnHttpNotFoundStatusCodeIsReturned(token: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNzMwNjM5MTc3LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIkZBIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vc3Vic2NyaXB0aW9ucyI6W10sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., model: UserEnvironmentsModel { EnvironmentRoles = [[bc48d3da-7dbc-4331-8bc0-2192b2ab24d8] = [EA, EU, CA], [13f2a9e2-ac03-4f53-807e-5b9684fa1ea3] = [EA, EU, CA], [33760c7f-7fa9-4629-82fc-45ce5855853f] = [EA, EU, CA]] })" time="0.3996795" result="Fail">
        <failure>
          <message>System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When token is not provided. Returns 401Unauthorized." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenUpdatingUserEnvironments+WhenNoTokenIsProvided.AnHttpUnauthorizedStatusCodeIsReturned(model: UserEnvironmentsModel { EnvironmentRoles = [[01b94433-86a0-4041-bda6-80de191e306d] = [EA, EU, CA], [3b2cd807-6291-4615-a0f0-78389f0e16c2] = [EA, EU, CA], [8711149a-a44a-46f4-996a-0c96e1590583] = [EA, EU, CA]] })" time="0.1316681" result="Fail">
        <failure>
          <message>System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When token is invalid. Returns 401Unauthorized." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenUpdatingUserEnvironments+WhenTheTokenIsInvalid.AnHttpUnauthorizedStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJhMmQ5NWY0ZS04NDI4LTQ1ZmQtYTk2MC00MTkwYWFiZmQ5MDciLCJhenAiOiIiLCJleHAiOjE2ODkxNjcxNzgsImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vcm9sZXMiOltdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOltdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2N1c3RvbWVyX2d1aWQiOiIwMDAwMDAwMC0wMDAwLTAwMDAtMDAwMC0wMDAwMDAwMDAwMDAiLCJzdWIiOiIxIiwiaHR0cHM6Ly9jaGlsaS1wdWJsaXNoLmNvbS9lbnZpcm9ubWVudElkIjoiIiwic2NvcGUiOiIifQ., model: UserEnvironmentsModel { EnvironmentRoles = [[9476e87e-4559-482d-a718-bdbc133ac0f4] = [EA, EU, CA], [be481b51-f54a-4dbf-8ec9-033dd14ed59b] = [EA, EU, CA], [b8031e04-3ddd-4b9c-bec4-ff6255f26fc6] = [EA, EU, CA]] })" time="0.2042801" result="Fail">
        <failure>
          <message>System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When token is invalid. Returns 401Unauthorized." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenUpdatingUserEnvironments+WhenTheTokenIsInvalid.AnHttpUnauthorizedStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJmMWRmNTNiMS1lYThmLTQ3YTQtYTJjYi0zZTkzMjg0YTczMzgiLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MTc4LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbXSwiaHR0cHM6Ly9jaGlsaS1wdWJsaXNoLmNvbS9zdWJzY3JpcHRpb25zIjpbXSwiaHR0cHM6Ly9jaGlsaS1wdWJsaXNoLmNvbS9jdXN0b21lcl9ndWlkIjoiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIiwic3ViIjoiMSIsImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vZW52aXJvbm1lbnRJZCI6IiIsInNjb3BlIjoiIn0., model: UserEnvironmentsModel { EnvironmentRoles = [[9d16e88b-2358-4c5c-9134-01084dd019cd] = [EA, EU, CA], [9d81556f-9303-4077-93dd-cad7d6632249] = [EA, EU, CA], [aabb63b7-9f42-42e7-93c0-db760383ba90] = [EA, EU, CA]] })" time="0.1886856" result="Fail">
        <failure>
          <message>System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When token is invalid. Returns 401Unauthorized." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenUpdatingUserEnvironments+WhenTheTokenIsInvalid.AnHttpUnauthorizedStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjU1NTU3NTc4LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbXSwiaHR0cHM6Ly9jaGlsaS1wdWJsaXNoLmNvbS9zdWJzY3JpcHRpb25zIjpbXSwiaHR0cHM6Ly9jaGlsaS1wdWJsaXNoLmNvbS9jdXN0b21lcl9ndWlkIjoiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIiwic3ViIjoiMSIsImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vZW52aXJvbm1lbnRJZCI6IiIsInNjb3BlIjoiIn0., model: UserEnvironmentsModel { EnvironmentRoles = [[f6128413-a8f3-45f6-81fb-7d5448365422] = [EA, EU, CA], [c01d21ee-8318-44c5-a097-d04c498a11b8] = [EA, EU, CA], [b9c6e788-4795-4839-9b4c-04a717b87e02] = [EA, EU, CA]] })" time="0.1890432" result="Fail">
        <failure>
          <message>System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When feature flag is enabled. Returns 404HttpNotFound." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenGrantingSubscriptionLevelRoles+WhenHideFeatureFlagEnabled.AnHttpNotFoundStatusCodeIsReturned(token: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNzE1NjkxOTc5LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIkZBIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vc3Vic2NyaXB0aW9ucyI6W10sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., model: UserSubscriptionRolesModel { SubscriptionRoles = [SA, TD, SA] })" time="0.2031245" result="Fail">
        <failure>
          <message>System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When authorized user updates himself. Returns 200OK." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenUpdatingUser+WhenUserUpdatesHisOwnProfile.AnHttpOkStatusCodeIsReturned(jwtCustomization: FullAccessRoleJwtCustomization { }, model: UpdateUserModel { FirstName = &quot;FirstNamed95a4591-82a5-43c2-9b84-a774704ee50f&quot;, LastName = &quot;LastName81795ed3-dd36-46bd-87d1-29f92ce39805&quot; })" time="0.1262544" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenUpdatingUser.WhenUserUpdatesHisOwnProfile.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 4295
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenUpdatingUser.WhenUserUpdatesHisOwnProfile.AnHttpOkStatusCodeIsReturned(ICustomization jwtCustomization, UpdateUserModel model) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 4279
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When authorized user updates himself. Returns 200OK." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenUpdatingUser+WhenUserUpdatesHisOwnProfile.AnHttpOkStatusCodeIsReturned(jwtCustomization: SubscriptionAdministratorRoleJwtCustomization { }, model: UpdateUserModel { FirstName = &quot;FirstNamed95a4591-82a5-43c2-9b84-a774704ee50f&quot;, LastName = &quot;LastName81795ed3-dd36-46bd-87d1-29f92ce39805&quot; })" time="0.1962796" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenUpdatingUser.WhenUserUpdatesHisOwnProfile.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 4295
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenUpdatingUser.WhenUserUpdatesHisOwnProfile.AnHttpOkStatusCodeIsReturned(ICustomization jwtCustomization, UpdateUserModel model) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 4279
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When authorized user updates himself. Returns 200OK." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenUpdatingUser+WhenUserUpdatesHisOwnProfile.AnHttpOkStatusCodeIsReturned(jwtCustomization: EnvironmentAdministratorRoleJwtCustomization { }, model: UpdateUserModel { FirstName = &quot;FirstNamed95a4591-82a5-43c2-9b84-a774704ee50f&quot;, LastName = &quot;LastName81795ed3-dd36-46bd-87d1-29f92ce39805&quot; })" time="0.1257601" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenUpdatingUser.WhenUserUpdatesHisOwnProfile.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 4295
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenUpdatingUser.WhenUserUpdatesHisOwnProfile.AnHttpOkStatusCodeIsReturned(ICustomization jwtCustomization, UpdateUserModel model) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 4279
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When authorized user updates himself. Returns 200OK." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenUpdatingUser+WhenUserUpdatesHisOwnProfile.AnHttpOkStatusCodeIsReturned(jwtCustomization: EnvironmentUserRoleJwtCustomization { }, model: UpdateUserModel { FirstName = &quot;FirstNamed95a4591-82a5-43c2-9b84-a774704ee50f&quot;, LastName = &quot;LastName81795ed3-dd36-46bd-87d1-29f92ce39805&quot; })" time="0.1230236" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenUpdatingUser.WhenUserUpdatesHisOwnProfile.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 4295
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenUpdatingUser.WhenUserUpdatesHisOwnProfile.AnHttpOkStatusCodeIsReturned(ICustomization jwtCustomization, UpdateUserModel model) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 4279
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When SA/FA user updates other user. Returns 200OK/404Forbid." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenUpdatingUser+WhenUserUpdatesOtherUserProfile.AnHttpBadRequestIsReturned(jwtCustomization: FullAccessRoleJwtCustomization { }, expectedStatus: OK, model: UpdateUserModel { FirstName = &quot;FirstName10ecbb2c-6c6c-48c7-96ae-45b8a8731d4f&quot;, LastName = &quot;LastName607b061e-38e2-4d39-a56e-9de420621795&quot; })" time="0.1242648" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenUpdatingUser.WhenUserUpdatesOtherUserProfile.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 4343
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenUpdatingUser.WhenUserUpdatesOtherUserProfile.AnHttpBadRequestIsReturned(ICustomization jwtCustomization, HttpStatusCode expectedStatus, UpdateUserModel model) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 4327
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When SA/FA user updates other user. Returns 200OK/404Forbid." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenUpdatingUser+WhenUserUpdatesOtherUserProfile.AnHttpBadRequestIsReturned(jwtCustomization: SubscriptionAdministratorRoleJwtCustomization { }, expectedStatus: OK, model: UpdateUserModel { FirstName = &quot;FirstName10ecbb2c-6c6c-48c7-96ae-45b8a8731d4f&quot;, LastName = &quot;LastName607b061e-38e2-4d39-a56e-9de420621795&quot; })" time="0.1117237" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenUpdatingUser.WhenUserUpdatesOtherUserProfile.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 4343
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenUpdatingUser.WhenUserUpdatesOtherUserProfile.AnHttpBadRequestIsReturned(ICustomization jwtCustomization, HttpStatusCode expectedStatus, UpdateUserModel model) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 4327
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When SA/FA user updates other user. Returns 200OK/404Forbid." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenUpdatingUser+WhenUserUpdatesOtherUserProfile.AnHttpBadRequestIsReturned(jwtCustomization: SubscriptionAdministratorRoleJwtCustomization { }, expectedStatus: Forbidden, model: UpdateUserModel { FirstName = &quot;FirstName10ecbb2c-6c6c-48c7-96ae-45b8a8731d4f&quot;, LastName = &quot;LastName607b061e-38e2-4d39-a56e-9de420621795&quot; })" time="0.1474192" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenUpdatingUser.WhenUserUpdatesOtherUserProfile.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 4343
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenUpdatingUser.WhenUserUpdatesOtherUserProfile.AnHttpBadRequestIsReturned(ICustomization jwtCustomization, HttpStatusCode expectedStatus, UpdateUserModel model) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 4327
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests+WhenAddingANewUser+WhenTheSignatureIsValid+WhenTheUserWasCreated.AnHttpCreatedStatusCodeIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenAddingANewUser+WhenTheSignatureIsValid+WhenTheUserWasCreated.AnHttpCreatedStatusCodeIsReturned(model: AddUserModel { CustomerGuid = edbe7c4a-b245-4c65-9f92-7a4c8571c24d, Email = &quot;1ce4d25d-ed76-4691-a02a-10554159eb12@example.com&quot;, FirstName = &quot;FirstName918ae9bf-2a3f-4947-94fa-dca83cf34f4f&quot;, LastName = &quot;LastName2b7f1043-dd54-4656-9203-306e16a22d57&quot;, SubscriptionIds = [2e817570-4bdc-4468-803b-6088b90265bb, 56c9a81a-4a58-4c0c-9681-bed34ea6484c, 23641796-f0fb-4bbc-aa58-a102fdfb40cd] })" time="0.2556279" result="Fail">
        <failure>
          <message>System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests+WhenAddingANewUser+WhenTheSignatureIsValid+WhenTheUserCreationFailed.AnHttpBadRequestStatusCodeIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenAddingANewUser+WhenTheSignatureIsValid+WhenTheUserCreationFailed.AnHttpBadRequestStatusCodeIsReturned(model: AddUserModel { CustomerGuid = d9805467-8168-49c2-855d-73319465feec, Email = &quot;dfa007a3-9b12-4629-800f-dc7c43f1f0a4@example.net&quot;, FirstName = &quot;FirstName64bd0090-b5cd-4c53-8f02-7ec5169eb184&quot;, LastName = &quot;LastName877cea21-c4c0-40aa-9073-2234433f0d02&quot;, SubscriptionIds = [138814cf-4bc4-42a0-ac5c-52e76411fd18, 3d379061-a3b9-4e8f-8fa4-bb05517d0723, e3754a47-f193-471f-83a2-77b5a5bb967d] })" time="0.1646573" result="Fail">
        <failure>
          <message>System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests+WhenAddingANewUser+WhenTheSignatureIsValid+WhenTheUserAlreadyExists.AnHttpConflictStatusCodeIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenAddingANewUser+WhenTheSignatureIsValid+WhenTheUserAlreadyExists.AnHttpConflictStatusCodeIsReturned(model: AddUserModel { CustomerGuid = f6eb7700-de88-490b-8ed7-9073d9f636ba, Email = &quot;e5cfa366-2f27-4c43-bc98-a9c43db77893@example.org&quot;, FirstName = &quot;FirstNamef1344cbd-3064-4eac-89a7-d473af6aedab&quot;, LastName = &quot;LastName261cb6da-bbf3-40b9-98c5-49b925a1702f&quot;, SubscriptionIds = [442090f6-696d-4d65-b88a-f5db19f55105, f86f0588-499c-4061-be97-d841e389dcb7, 4c2cd428-f5aa-467e-a1ca-022b5e184197] })" time="0.1507848" result="Fail">
        <failure>
          <message>System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests+WhenUpdatingAUser+WhenTheTokenIsInvalid+WhenTheTokenIsExpired.AnHttpUnauthorizedStatusCodeIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenUpdatingAUser+WhenTheTokenIsInvalid+WhenTheTokenIsExpired.AnHttpUnauthorizedStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjgwMTgxNjE0LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbXSwiaHR0cHM6Ly9jaGlsaS1wdWJsaXNoLmNvbS9zdWJzY3JpcHRpb25zIjpbXSwiaHR0cHM6Ly9jaGlsaS1wdWJsaXNoLmNvbS9jdXN0b21lcl9ndWlkIjoiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIiwic3ViIjoiMSIsImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vZW52aXJvbm1lbnRJZCI6IiIsInNjb3BlIjoiIn0., userId: &quot;userId7ec94dbd-0578-4e60-b688-7af343d24345&quot;, nameModel: UpdateUserNameModel { FirstName = &quot;FirstName9c1a12bc-a998-43a4-95fc-b72dfc593d7d&quot;, LastName = &quot;LastName82af6f30-7ce6-453b-bc0f-68cce74491ad&quot; })" time="0.2507245" result="Fail">
        <failure>
          <message>System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests+WhenUpdatingAUser+WhenTheTokenIsInvalid+WhenTheTokenHasAnUnsupportedIssuer.AnHttpUnauthorizedStatusCodeIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenUpdatingAUser+WhenTheTokenIsInvalid+WhenTheTokenHasAnUnsupportedIssuer.AnHttpUnauthorizedStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiI5NTFjODVmZC02ODMyLTRjMGUtODhlNy01MGViMTkzY2M3MmIiLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MjE0LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbXSwiaHR0cHM6Ly9jaGlsaS1wdWJsaXNoLmNvbS9zdWJzY3JpcHRpb25zIjpbXSwiaHR0cHM6Ly9jaGlsaS1wdWJsaXNoLmNvbS9jdXN0b21lcl9ndWlkIjoiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIiwic3ViIjoiMSIsImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vZW52aXJvbm1lbnRJZCI6IiIsInNjb3BlIjoiIn0., userId: &quot;userId7970494c-5674-482c-b81d-25e2229022a7&quot;, nameModel: UpdateUserNameModel { FirstName = &quot;FirstNameea2618aa-fb60-4335-b70a-756ebab85740&quot;, LastName = &quot;LastNameda518665-38b9-4ac0-b31c-ed810b69df5a&quot; })" time="0.2101731" result="Fail">
        <failure>
          <message>System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests+WhenUpdatingAUser+WhenTheTokenIsInvalid+WhenTheTokenHasAnUnsupportedAudience.AnHttpUnauthorizedStatusCodeIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenUpdatingAUser+WhenTheTokenIsInvalid+WhenTheTokenHasAnUnsupportedAudience.AnHttpUnauthorizedStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJjNTBkODI4ZS1mYWVkLTRmZjUtYmNiOC1iYTFkZDU2NjFkYmUiLCJhenAiOiIiLCJleHAiOjE2ODkxNjcyMTQsImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vcm9sZXMiOltdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOltdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2N1c3RvbWVyX2d1aWQiOiIwMDAwMDAwMC0wMDAwLTAwMDAtMDAwMC0wMDAwMDAwMDAwMDAiLCJzdWIiOiIxIiwiaHR0cHM6Ly9jaGlsaS1wdWJsaXNoLmNvbS9lbnZpcm9ubWVudElkIjoiIiwic2NvcGUiOiIifQ., userId: &quot;userId7df84f4d-cfcf-4cd7-9cd0-bdff41d82c3b&quot;, nameModel: UpdateUserNameModel { FirstName = &quot;FirstNamea07d24bb-d346-47e9-a798-6b080dd98916&quot;, LastName = &quot;LastNamed9485c57-5fce-4f9d-b165-60ead50bf052&quot; })" time="0.2588713" result="Fail">
        <failure>
          <message>System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests+WhenRequestingTheUserEmailVerificationStatus+WhenTheUserIsFound+WhenTheSignatureIsMissing.AnHttpBadRequestStatusCodeIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenRequestingTheUserEmailVerificationStatus+WhenTheUserIsFound+WhenTheSignatureIsMissing.AnHttpBadRequestStatusCodeIsReturned" time="0.1879721" result="Fail">
        <failure>
          <message>System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests+WhenRequestingTheUserEmailVerificationStatus+WhenTheUserIsFound+WhenTheSignatureIsInvalid.AnHttpBadRequestStatusCodeIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenRequestingTheUserEmailVerificationStatus+WhenTheUserIsFound+WhenTheSignatureIsInvalid.AnHttpBadRequestStatusCodeIsReturned" time="0.2470641" result="Fail">
        <failure>
          <message>System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests+WhenMarkingUserAsMigrated+WhenNoValidUserEmailIsProvided+WhenUserEmailIsNull.ReturnsBadRequest" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenMarkingUserAsMigrated+WhenNoValidUserEmailIsProvided+WhenUserEmailIsNull.ReturnsBadRequest(model: MarkUserMigratedModel { UserEmail = null })" time="0.1472888" result="Fail">
        <failure>
          <message>System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests+WhenMarkingUserAsMigrated+WhenNoValidUserEmailIsProvided+WhenUserEmailIsEmpty.ReturnsBadRequest" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenMarkingUserAsMigrated+WhenNoValidUserEmailIsProvided+WhenUserEmailIsEmpty.ReturnsBadRequest(model: MarkUserMigratedModel { UserEmail = &quot;&quot; })" time="0.1552592" result="Fail">
        <failure>
          <message>System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests+WhenMarkingUserAsMigrated+WhenNoValidUserEmailIsProvided+WhenUserEmailIsWhiteSpace.ReturnsBadRequest" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenMarkingUserAsMigrated+WhenNoValidUserEmailIsProvided+WhenUserEmailIsWhiteSpace.ReturnsBadRequest(model: MarkUserMigratedModel { UserEmail = &quot; &quot; })" time="0.1520195" result="Fail">
        <failure>
          <message>System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests+WhenMarkingUserAsMigrated+WhenNoValidUserEmailIsProvided+WhenUserEmailIsInvaild.ReturnsBadRequest" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenMarkingUserAsMigrated+WhenNoValidUserEmailIsProvided+WhenUserEmailIsInvaild.ReturnsBadRequest(model: MarkUserMigratedModel { UserEmail = &quot;UserEmail3357989e-67c3-482e-9c82-8442ecc73c55&quot; })" time="0.1497332" result="Fail">
        <failure>
          <message>System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests+WhenMarkingUserAsMigrated+WhenSignatureIsValid+WhenTheUserDoesNotExist.AnHttpBadRequestStatusCodeIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenMarkingUserAsMigrated+WhenSignatureIsValid+WhenTheUserDoesNotExist.AnHttpBadRequestStatusCodeIsReturned(model: MarkUserMigratedModel { UserEmail = &quot;bdf71bbb-7cd3-46a9-81b9-0c76fb74ff34@example.net&quot; })" time="0.1538393" result="Fail">
        <failure>
          <message>System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests+WhenMarkingUserAsMigrated+WhenSignatureIsValid+WhenTheUserExists.AnHttpOkStatusCodeIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenMarkingUserAsMigrated+WhenSignatureIsValid+WhenTheUserExists.AnHttpOkStatusCodeIsReturned(model: MarkUserMigratedModel { UserEmail = &quot;ffbea918-d5d6-4714-95cf-b97a708db418@example.com&quot; })" time="0.1767272" result="Fail">
        <failure>
          <message>System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests+WhenMarkingUserAsMigrated+WhenSignatureIsValid+WhenAMigrationErrorExceptionIsRaised.AnHttpInternalServerErrorStatusCodeIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenMarkingUserAsMigrated+WhenSignatureIsValid+WhenAMigrationErrorExceptionIsRaised.AnHttpInternalServerErrorStatusCodeIsReturned(model: MarkUserMigratedModel { UserEmail = &quot;ab6c54f0-1268-48b9-8534-383ef2d2d76c@example.com&quot; })" time="0.1485395" result="Fail">
        <failure>
          <message>System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests+WhenGettingUserAccessibleSubscriptions+WhenNoValidUserEmailIsProvided+WhenUserEmailIsNull.ReturnsBadRequest" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenGettingUserAccessibleSubscriptions+WhenNoValidUserEmailIsProvided+WhenUserEmailIsNull.ReturnsBadRequest(model: UserAccessibleSubscriptionsModel { UserEmail = null })" time="0.2394225" result="Fail">
        <failure>
          <message>System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests+WhenGettingUserAccessibleSubscriptions+WhenNoValidUserEmailIsProvided+WhenUserEmailIsEmpty.ReturnsBadRequest" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenGettingUserAccessibleSubscriptions+WhenNoValidUserEmailIsProvided+WhenUserEmailIsEmpty.ReturnsBadRequest(model: UserAccessibleSubscriptionsModel { UserEmail = &quot;&quot; })" time="0.2161408" result="Fail">
        <failure>
          <message>System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests+WhenGettingUserAccessibleSubscriptions+WhenNoValidUserEmailIsProvided+WhenUserEmailIsWhiteSpace.ReturnsBadRequest" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenGettingUserAccessibleSubscriptions+WhenNoValidUserEmailIsProvided+WhenUserEmailIsWhiteSpace.ReturnsBadRequest(model: UserAccessibleSubscriptionsModel { UserEmail = &quot; &quot; })" time="0.1497624" result="Fail">
        <failure>
          <message>System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests+WhenGettingUserAccessibleSubscriptions+WhenNoValidUserEmailIsProvided+WhenUserEmailIsInvalid.ReturnsBadRequest" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenGettingUserAccessibleSubscriptions+WhenNoValidUserEmailIsProvided+WhenUserEmailIsInvalid.ReturnsBadRequest(model: UserAccessibleSubscriptionsModel { UserEmail = &quot;UserEmail423539c9-0266-46ac-8a43-114306039f78&quot; })" time="0.1531241" result="Fail">
        <failure>
          <message>System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests+WhenGettingUserAccessibleSubscriptions+WhenSignatureIsValid+WhenTheUserDoesNotExist.AnHttpBadRequestStatusCodeIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenGettingUserAccessibleSubscriptions+WhenSignatureIsValid+WhenTheUserDoesNotExist.AnHttpBadRequestStatusCodeIsReturned(model: UserAccessibleSubscriptionsModel { UserEmail = &quot;458ca7e4-b3d4-48f1-9d99-c33a8b968c53@example.org&quot; })" time="0.1802221" result="Fail">
        <failure>
          <message>System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests+WhenGettingUserAccessibleSubscriptions+WhenSignatureIsValid+WhenTheUserExists.AnHttpOkStatusCodeIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenGettingUserAccessibleSubscriptions+WhenSignatureIsValid+WhenTheUserExists.AnHttpOkStatusCodeIsReturned(model: UserAccessibleSubscriptionsModel { UserEmail = &quot;550d53c7-85b5-44b0-8c8d-3c10eca733e1@example.net&quot; })" time="0.1506362" result="Fail">
        <failure>
          <message>System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests+WhenGettingUserAccessibleSubscriptions+WhenSignatureIsValid+WhenAMigrationErrorExceptionIsRaised.AnHttpInternalServerErrorStatusCodeIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenGettingUserAccessibleSubscriptions+WhenSignatureIsValid+WhenAMigrationErrorExceptionIsRaised.AnHttpInternalServerErrorStatusCodeIsReturned(model: UserAccessibleSubscriptionsModel { UserEmail = &quot;9e5f25e0-898e-407e-abb2-4916d21aafc7@example.org&quot; })" time="0.1969025" result="Fail">
        <failure>
          <message>System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When the token has no permissions and user role is EU/TD/SU. Returns 403 Forbidden" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenInvitingUsers+WhenUserHasNoPermissions+WhenTokenIsLinkedToEUOrTDOrSU.AnHttpForbiddenStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MjE3LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMXxURCJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAxIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., model: InviteUsersModel { Environments = [EnvironmentRoleModel { ... }], SubscriptionIds = [00000000-0000-0000-0000-000000000001], UserEmails = [&quot;nice@mail.com&quot;] })" time="0.1456784" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenInvitingUsers.WhenUserHasNoPermissions.WhenTokenIsLinkedToEUOrTDOrSU.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 1611
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenInvitingUsers.WhenUserHasNoPermissions.WhenTokenIsLinkedToEUOrTDOrSU.AnHttpForbiddenStatusCodeIsReturned(Jwt jwt, InviteUsersModel model) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 1595
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When the token has no permissions and user role is EU/TD/SU. Returns 403 Forbidden" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenInvitingUsers+WhenUserHasNoPermissions+WhenTokenIsLinkedToEUOrTDOrSU.AnHttpForbiddenStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MjE3LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMXxTVSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAxIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., model: InviteUsersModel { Environments = [EnvironmentRoleModel { ... }], SubscriptionIds = [00000000-0000-0000-0000-000000000001], UserEmails = [&quot;nice@mail.com&quot;] })" time="0.1676499" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenInvitingUsers.WhenUserHasNoPermissions.WhenTokenIsLinkedToEUOrTDOrSU.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 1611
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenInvitingUsers.WhenUserHasNoPermissions.WhenTokenIsLinkedToEUOrTDOrSU.AnHttpForbiddenStatusCodeIsReturned(Jwt jwt, InviteUsersModel model) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 1595
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When the token has no permissions and user role is EU/TD/SU. Returns 403 Forbidden" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenInvitingUsers+WhenUserHasNoPermissions+WhenTokenIsLinkedToEUOrTDOrSU.AnHttpForbiddenStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MjE3LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMXxFVSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAxIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., model: InviteUsersModel { Environments = [EnvironmentRoleModel { ... }], SubscriptionIds = [00000000-0000-0000-0000-000000000001], UserEmails = [&quot;nice@mail.com&quot;] })" time="0.1315580" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenInvitingUsers.WhenUserHasNoPermissions.WhenTokenIsLinkedToEUOrTDOrSU.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 1611
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenInvitingUsers.WhenUserHasNoPermissions.WhenTokenIsLinkedToEUOrTDOrSU.AnHttpForbiddenStatusCodeIsReturned(Jwt jwt, InviteUsersModel model) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 1595
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When the user has SA/EA role but user does not have access to subscription. Returns 403 Forbidden" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenInvitingUsers+WhenUserHasNoPermissions+WhenUserDoesNotHaveAccessToSubscription.AnHttpForbiddenStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MjE4LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMXxTQSIsIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMnxFVSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAxIiwiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAyIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., model: InviteUsersModel { Environments = [EnvironmentRoleModel { ... }], SubscriptionIds = [00000000-0000-0000-0000-000000000001, 00000000-0000-0000-0000-000000000002], UserEmails = [&quot;nice@mail.com&quot;] })" time="0.1256320" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenInvitingUsers.WhenUserHasNoPermissions.WhenUserDoesNotHaveAccessToSubscription.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 1700
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenInvitingUsers.WhenUserHasNoPermissions.WhenUserDoesNotHaveAccessToSubscription.AnHttpForbiddenStatusCodeIsReturned(Jwt jwt, InviteUsersModel model) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 1684
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When the user has SA/EA role but user does not have access to subscription. Returns 403 Forbidden" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenInvitingUsers+WhenUserHasNoPermissions+WhenUserDoesNotHaveAccessToSubscription.AnHttpForbiddenStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MjE4LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMXxFQSIsIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMnxTVSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAxIiwiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAyIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., model: InviteUsersModel { Environments = [EnvironmentRoleModel { ... }], SubscriptionIds = [00000000-0000-0000-0000-000000000001, 00000000-0000-0000-0000-000000000002], UserEmails = [&quot;nice@mail.com&quot;] })" time="0.1678759" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenInvitingUsers.WhenUserHasNoPermissions.WhenUserDoesNotHaveAccessToSubscription.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 1700
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenInvitingUsers.WhenUserHasNoPermissions.WhenUserDoesNotHaveAccessToSubscription.AnHttpForbiddenStatusCodeIsReturned(Jwt jwt, InviteUsersModel model) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 1684
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When the user has SA/EA role but user does not have access to subscription. Returns 403 Forbidden" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenInvitingUsers+WhenUserHasNoPermissions+WhenUserDoesNotHaveAccessToSubscription.AnHttpForbiddenStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MjE4LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMXxFQSIsIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMnxTVSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAxIiwiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAyIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., model: InviteUsersModel { Environments = null, SubscriptionIds = [00000000-0000-0000-0000-000000000001, 00000000-0000-0000-0000-000000000002], UserEmails = [&quot;nice@mail.com&quot;] })" time="0.1974866" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenInvitingUsers.WhenUserHasNoPermissions.WhenUserDoesNotHaveAccessToSubscription.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 1700
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenInvitingUsers.WhenUserHasNoPermissions.WhenUserDoesNotHaveAccessToSubscription.AnHttpForbiddenStatusCodeIsReturned(Jwt jwt, InviteUsersModel model) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 1684
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When the user has SA/EA role but user does not have access to subscription. Returns 403 Forbidden" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenInvitingUsers+WhenUserHasNoPermissions+WhenUserDoesNotHaveAccessToSubscription.AnHttpForbiddenStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MjE4LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMXxTQSIsIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMHxTVSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAxIiwiMTAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., model: InviteUsersModel { Environments = null, SubscriptionIds = [00000000-0000-0000-0000-000000000001, 10000000-0000-0000-0000-000000000000], UserEmails = [&quot;nice@mail.com&quot;] })" time="0.1450956" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenInvitingUsers.WhenUserHasNoPermissions.WhenUserDoesNotHaveAccessToSubscription.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 1700
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenInvitingUsers.WhenUserHasNoPermissions.WhenUserDoesNotHaveAccessToSubscription.AnHttpForbiddenStatusCodeIsReturned(Jwt jwt, InviteUsersModel model) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 1684
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When the user has EA role but not in requested environment. Returns 403 Forbidden" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenInvitingUsers+WhenUserHasNoPermissions+WhenUserIsNotAllowedToAssignRoleInEnvironment.AnHttpForbiddenStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MjE4LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMXxFQSIsIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMnxTVSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAxIiwiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAyIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., model: InviteUsersModel { Environments = [EnvironmentRoleModel { ... }, EnvironmentRoleModel { ... }], SubscriptionIds = [00000000-0000-0000-0000-000000000001, 00000000-0000-0000-0000-000000000002], UserEmails = [&quot;nice@mail.com&quot;] })" time="0.1455904" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenInvitingUsers.WhenUserHasNoPermissions.WhenUserIsNotAllowedToAssignRoleInEnvironment.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 1770
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenInvitingUsers.WhenUserHasNoPermissions.WhenUserIsNotAllowedToAssignRoleInEnvironment.AnHttpForbiddenStatusCodeIsReturned(Jwt jwt, InviteUsersModel model) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 1754
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When the user has EA role but not in requested environment. Returns 403 Forbidden" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenInvitingUsers+WhenUserHasNoPermissions+WhenUserIsNotAllowedToAssignRoleInEnvironment.AnHttpForbiddenStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MjE4LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMXxTQSIsIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMnxTVSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAxIiwiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAyIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., model: InviteUsersModel { Environments = [EnvironmentRoleModel { ... }, EnvironmentRoleModel { ... }], SubscriptionIds = [00000000-0000-0000-0000-000000000001, 00000000-0000-0000-0000-000000000002], UserEmails = [&quot;nice@mail.com&quot;] })" time="0.1271902" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenInvitingUsers.WhenUserHasNoPermissions.WhenUserIsNotAllowedToAssignRoleInEnvironment.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 1770
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenInvitingUsers.WhenUserHasNoPermissions.WhenUserIsNotAllowedToAssignRoleInEnvironment.AnHttpForbiddenStatusCodeIsReturned(Jwt jwt, InviteUsersModel model) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 1754
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When users emails are valid, user has FA/SA/EA role. Return 200 OK" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenInvitingUsers+WhenTokenIsLinkedToFullAccessOrSAOrEA+WhenUserEmailsAreValid.AnHttpOkStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNzE1MjYwMDE5LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIkZBIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vc3Vic2NyaXB0aW9ucyI6W10sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., model: InviteUsersModel { Environments = [EnvironmentRoleModel { ... }], SubscriptionIds = [00000000-0000-0000-0000-000000000001], UserEmails = [&quot;1686e57c-609e-43ce-989e-29f868865b9c@example.com&quot;, &quot;3dc6c8af-5a08-44ee-b937-68bacb49156f@example.net&quot;, &quot;1cc8d578-143d-47d3-9cd6-fb281e7654a4@example.org&quot;] })" time="0.2019043" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenInvitingUsers.WhenTokenIsLinkedToFullAccessOrSAOrEA.WhenUserEmailsAreValid.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 1803
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenInvitingUsers.WhenTokenIsLinkedToFullAccessOrSAOrEA.WhenUserEmailsAreValid.AnHttpOkStatusCodeIsReturned(Jwt jwt, InviteUsersModel model) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 1787
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When users emails are valid, user has FA/SA/EA role. Return 200 OK" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenInvitingUsers+WhenTokenIsLinkedToFullAccessOrSAOrEA+WhenUserEmailsAreValid.AnHttpOkStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNzI5NDI5NjE5LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMXxTQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAxIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., model: InviteUsersModel { Environments = [EnvironmentRoleModel { ... }], SubscriptionIds = [00000000-0000-0000-0000-000000000001], UserEmails = [&quot;4db18d97-f097-4410-ac20-1e2b07d4fcd9@example.com&quot;, &quot;da733955-326c-449d-866d-99564ed8d70a@example.net&quot;, &quot;c9c5523c-6dba-4945-a843-e3d54e0ff41e@example.org&quot;] })" time="0.1494316" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenInvitingUsers.WhenTokenIsLinkedToFullAccessOrSAOrEA.WhenUserEmailsAreValid.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 1803
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenInvitingUsers.WhenTokenIsLinkedToFullAccessOrSAOrEA.WhenUserEmailsAreValid.AnHttpOkStatusCodeIsReturned(Jwt jwt, InviteUsersModel model) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 1787
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When users emails are valid, user has FA/SA/EA role. Return 200 OK" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenInvitingUsers+WhenTokenIsLinkedToFullAccessOrSAOrEA+WhenUserEmailsAreValid.AnHttpOkStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNzE3MjQ3MjE5LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMXxFQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAxIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., model: InviteUsersModel { Environments = [EnvironmentRoleModel { ... }], SubscriptionIds = [00000000-0000-0000-0000-000000000001], UserEmails = [&quot;8364fad7-824f-4cf5-bd98-43cf848fbbcc@example.org&quot;, &quot;0558ae25-d848-4388-88f4-ee4fff7b963d@example.com&quot;, &quot;d696554d-8eb1-42d4-ad07-ef52b10382c9@example.net&quot;] })" time="0.1977714" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenInvitingUsers.WhenTokenIsLinkedToFullAccessOrSAOrEA.WhenUserEmailsAreValid.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 1803
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenInvitingUsers.WhenTokenIsLinkedToFullAccessOrSAOrEA.WhenUserEmailsAreValid.AnHttpOkStatusCodeIsReturned(Jwt jwt, InviteUsersModel model) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 1787
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When user emails are not provided. Return 400 BadRequest" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenInvitingUsers+WhenTokenIsLinkedToFullAccessOrSAOrEA+WhenNoUserEmailsAreProvided.AnHttpBadRequestStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNzI4MjIwMDE5LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIkZBIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vc3Vic2NyaXB0aW9ucyI6W10sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., model: InviteUsersModel { Environments = [EnvironmentRoleModel { ... }, EnvironmentRoleModel { ... }, EnvironmentRoleModel { ... }], SubscriptionIds = [d7edb77b-aa80-4bf7-b85f-70e391d50526, c0e4335e-a5f1-43f6-984a-c4eb15813f0a, 3b2a04d5-1627-4337-8de2-944fd6496277], UserEmails = [&quot;&quot;] })" time="0.1537071" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenInvitingUsers.WhenTokenIsLinkedToFullAccessOrSAOrEA.WhenNoUserEmailsAreProvided.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 1867
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenInvitingUsers.WhenTokenIsLinkedToFullAccessOrSAOrEA.WhenNoUserEmailsAreProvided.AnHttpBadRequestStatusCodeIsReturned(Jwt jwt, InviteUsersModel model) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 1851
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests+WhenGettingUserAsync+WhenTokenIsProvided+WhenUserIsNotFound.AnHttpUnauthorizedStatusCodeIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenGettingUserAsync+WhenTokenIsProvided+WhenUserIsNotFound.AnHttpUnauthorizedStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNzIzMDM2MDE5LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIkZBIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vc3Vic2NyaXB0aW9ucyI6W10sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6Im5vbl9leGlzdGluZ191c2VyaWQiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.2630821" result="Fail">
        <failure>
          <message>System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests+WhenGettingUserAsync+WhenTokenIsProvided+WhenUserIsFound.AnHttpOkStatusCodeIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenGettingUserAsync+WhenTokenIsProvided+WhenUserIsFound.AnHttpOkStatusCodeIsReturned(resultModel: GetAuthenticatedUserModel { CreationDate = 1677110400, Email = &quot;example@mail.com&quot;, EnvironmentRoles = [[00000000-0000-0000-0000-000000000001] = [&quot;EU&quot;]], FirstName = &quot;Leeroy&quot;, HasFullAccess = False, ... }, jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MjIwLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMXxFVSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAyIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6ImF1dGgwfDYzMGY4YzJiNTI0OTM2ZmVhOTNjMGU3NSIsImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vZW52aXJvbm1lbnRJZCI6IiIsInNjb3BlIjoiIn0.)" time="0.2074215" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenGettingUserAsync.WhenTokenIsProvided.WhenUserIsFound.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 2809
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenGettingUserAsync.WhenTokenIsProvided.WhenUserIsFound.AnHttpOkStatusCodeIsReturned(GetAuthenticatedUserModel resultModel, Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 2786
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests+WhenGettingUserAsync+WhenTokenIsProvided+WhenUserIsFound.AnHttpOkStatusCodeIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenGettingUserAsync+WhenTokenIsProvided+WhenUserIsFound.AnHttpOkStatusCodeIsReturned(resultModel: GetAuthenticatedUserModel { CreationDate = null, Email = &quot;nice.example@mail.com&quot;, EnvironmentRoles = [], FirstName = &quot;Walter&quot;, HasFullAccess = True, ... }, jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MjIwLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIkZBIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vc3Vic2NyaXB0aW9ucyI6W10sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6ImF1dGgwfDIyOGY4YzJiNTI0OTM2ZmVhOTNjMGU3NSIsImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vZW52aXJvbm1lbnRJZCI6IiIsInNjb3BlIjoiIn0.)" time="0.2493172" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenGettingUserAsync.WhenTokenIsProvided.WhenUserIsFound.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 2809
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenGettingUserAsync.WhenTokenIsProvided.WhenUserIsFound.AnHttpOkStatusCodeIsReturned(GetAuthenticatedUserModel resultModel, Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 2786
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When user has TD role in requested subscription and has SA in other subscription. Returns 403Forbidden." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenUpdatingUserEnvironments+WhenTokenHasNoPermissions+WhenUserIsTDInRequestedSubscription.AnHttpForbiddenStatusCodeIsReturned(jwtCustomization: UserRoleJwtCustomization { }, model: UserEnvironmentsModel { EnvironmentRoles = [[00000000-0000-0000-0000-000000000001] = [EU]] })" time="6.5440834" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected result.StatusCode to be HttpStatusCode.Forbidden {value: 403}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected result.StatusCode to be HttpStatusCode.Forbidden {value: 403}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.EnumAssertions`2.Be(TEnum expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenUpdatingUserEnvironments.WhenTokenHasNoPermissions.WhenUserIsTDInRequestedSubscription.AnHttpForbiddenStatusCodeIsReturned(ICustomization jwtCustomization, UserEnvironmentsModel model) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 2961
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When user has EU/CA/SU/WA role in requested environment and has EA in other environment. Returns 403Forbidden." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenUpdatingUserEnvironments+WhenTokenHasNoPermissions+WhenUserIsEUOrCAOrSUOrWAInRequestedEnvironment.AnHttpForbiddenStatusCodeIsReturned(jwtCustomization: UserRoleJwtCustomization { }, model: UserEnvironmentsModel { EnvironmentRoles = [[00000000-0000-0000-0000-000000000001] = [EU]] })" time="2.4979748" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected result.StatusCode to be HttpStatusCode.Forbidden {value: 403}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected result.StatusCode to be HttpStatusCode.Forbidden {value: 403}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.EnumAssertions`2.Be(TEnum expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenUpdatingUserEnvironments.WhenTokenHasNoPermissions.WhenUserIsEUOrCAOrSUOrWAInRequestedEnvironment.AnHttpForbiddenStatusCodeIsReturned(ICustomization jwtCustomization, UserEnvironmentsModel model) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 3003
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When user has EU/CA/SU/WA role in requested environment and has EA in other environment. Returns 403Forbidden." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenUpdatingUserEnvironments+WhenTokenHasNoPermissions+WhenUserIsEUOrCAOrSUOrWAInRequestedEnvironment.AnHttpForbiddenStatusCodeIsReturned(jwtCustomization: UserRoleJwtCustomization { }, model: UserEnvironmentsModel { EnvironmentRoles = [[00000000-0000-0000-0000-000000000001] = [EU]] })" time="0.2849678" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected result.StatusCode to be HttpStatusCode.Forbidden {value: 403}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected result.StatusCode to be HttpStatusCode.Forbidden {value: 403}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.EnumAssertions`2.Be(TEnum expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenUpdatingUserEnvironments.WhenTokenHasNoPermissions.WhenUserIsEUOrCAOrSUOrWAInRequestedEnvironment.AnHttpForbiddenStatusCodeIsReturned(ICustomization jwtCustomization, UserEnvironmentsModel model) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 3003
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When user has EU/CA/SU/WA role in requested environment and has EA in other environment. Returns 403Forbidden." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenUpdatingUserEnvironments+WhenTokenHasNoPermissions+WhenUserIsEUOrCAOrSUOrWAInRequestedEnvironment.AnHttpForbiddenStatusCodeIsReturned(jwtCustomization: UserRoleJwtCustomization { }, model: UserEnvironmentsModel { EnvironmentRoles = [[00000000-0000-0000-0000-000000000001] = [EU]] })" time="0.3475658" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected result.StatusCode to be HttpStatusCode.Forbidden {value: 403}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected result.StatusCode to be HttpStatusCode.Forbidden {value: 403}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.EnumAssertions`2.Be(TEnum expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenUpdatingUserEnvironments.WhenTokenHasNoPermissions.WhenUserIsEUOrCAOrSUOrWAInRequestedEnvironment.AnHttpForbiddenStatusCodeIsReturned(ICustomization jwtCustomization, UserEnvironmentsModel model) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 3003
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When user has EU/CA/SU/WA role in requested environment and has EA in other environment. Returns 403Forbidden." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenUpdatingUserEnvironments+WhenTokenHasNoPermissions+WhenUserIsEUOrCAOrSUOrWAInRequestedEnvironment.AnHttpForbiddenStatusCodeIsReturned(jwtCustomization: UserRoleJwtCustomization { }, model: UserEnvironmentsModel { EnvironmentRoles = [[00000000-0000-0000-0000-000000000001] = [EU]] })" time="10.2280144" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected result.StatusCode to be HttpStatusCode.Forbidden {value: 403}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected result.StatusCode to be HttpStatusCode.Forbidden {value: 403}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.EnumAssertions`2.Be(TEnum expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenUpdatingUserEnvironments.WhenTokenHasNoPermissions.WhenUserIsEUOrCAOrSUOrWAInRequestedEnvironment.AnHttpForbiddenStatusCodeIsReturned(ICustomization jwtCustomization, UserEnvironmentsModel model) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 3003
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When user has EA role in first environment but doesn't have EA in second environment. Returns 403Forbidden." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenUpdatingUserEnvironments+WhenTokenHasNoPermissions+WhenUserIsEAInOnlyOneOfTwoRequestedEnvironments.AnHttpForbiddenStatusCodeIsReturned(jwtCustomization: UserRoleJwtCustomization { }, model: UserEnvironmentsModel { EnvironmentRoles = [[00000000-0000-0000-0000-000000000001] = [EU], [00000000-0000-0000-0000-000000000002] = [EU]] })" time="86.5546489" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected result.StatusCode to be HttpStatusCode.Forbidden {value: 403}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected result.StatusCode to be HttpStatusCode.Forbidden {value: 403}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.EnumAssertions`2.Be(TEnum expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenUpdatingUserEnvironments.WhenTokenHasNoPermissions.WhenUserIsEAInOnlyOneOfTwoRequestedEnvironments.AnHttpForbiddenStatusCodeIsReturned(ICustomization jwtCustomization, UserEnvironmentsModel model) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 3033
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When user is invited in subscription but doesn't have roles in it. Returns 403Forbidden." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenUpdatingUserEnvironments+WhenTokenHasNoPermissions+WhenUserIsInvitedInSubscriptionButDoesNotHaveAnyRoles.AnHttpForbiddenStatusCodeIsReturned(jwtCustomization: UserRoleJwtCustomization { }, model: UserEnvironmentsModel { EnvironmentRoles = [[00000000-0000-0000-0000-000000000002] = [EA]] })" time="0.4051618" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected result.StatusCode to be HttpStatusCode.Forbidden {value: 403}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected result.StatusCode to be HttpStatusCode.Forbidden {value: 403}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.EnumAssertions`2.Be(TEnum expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenUpdatingUserEnvironments.WhenTokenHasNoPermissions.WhenUserIsInvitedInSubscriptionButDoesNotHaveAnyRoles.AnHttpForbiddenStatusCodeIsReturned(ICustomization jwtCustomization, UserEnvironmentsModel model) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 3063
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When token has SA/EA/FA roles but requested user is not invited to subscription. Returns 400BadRequest." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenUpdatingUserEnvironments+WhenTokenIsLinkedToFullAccessOrSAOrEA+WhenUserIsNotInvitedInRequestedSubscription.AnHttpBadRequestIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNzIzNzI3MzI3LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIkZBIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vc3Vic2NyaXB0aW9ucyI6W10sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., model: UserEnvironmentsModel { EnvironmentRoles = [[00000000-0000-0000-0000-000000000003] = [EU]] })" time="0.1835012" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenUpdatingUserEnvironments.WhenTokenIsLinkedToFullAccessOrSAOrEA.WhenUserIsNotInvitedInRequestedSubscription.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 3187
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenUpdatingUserEnvironments.WhenTokenIsLinkedToFullAccessOrSAOrEA.WhenUserIsNotInvitedInRequestedSubscription.AnHttpBadRequestIsReturned(Jwt jwt, UserEnvironmentsModel model) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 3171
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When token has SA/EA/FA roles but requested user is not invited to subscription. Returns 400BadRequest." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenUpdatingUserEnvironments+WhenTokenIsLinkedToFullAccessOrSAOrEA+WhenUserIsNotInvitedInRequestedSubscription.AnHttpBadRequestIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MzI3LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMXxTQSIsIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMnxTQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAxIiwiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAyIiwiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAzIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., model: UserEnvironmentsModel { EnvironmentRoles = [[00000000-0000-0000-0000-000000000003] = [EU]] })" time="0.2172096" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenUpdatingUserEnvironments.WhenTokenIsLinkedToFullAccessOrSAOrEA.WhenUserIsNotInvitedInRequestedSubscription.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 3187
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenUpdatingUserEnvironments.WhenTokenIsLinkedToFullAccessOrSAOrEA.WhenUserIsNotInvitedInRequestedSubscription.AnHttpBadRequestIsReturned(Jwt jwt, UserEnvironmentsModel model) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 3171
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When token has SA/EA/FA roles but requested user is not invited to subscription. Returns 400BadRequest." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenUpdatingUserEnvironments+WhenTokenIsLinkedToFullAccessOrSAOrEA+WhenUserIsNotInvitedInRequestedSubscription.AnHttpBadRequestIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MzI3LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMXxFQSIsIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMXxFQSIsIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwM3xFQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAxIiwiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAyIiwiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAzIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., model: UserEnvironmentsModel { EnvironmentRoles = [[00000000-0000-0000-0000-000000000003] = [EU]] })" time="0.1957539" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenUpdatingUserEnvironments.WhenTokenIsLinkedToFullAccessOrSAOrEA.WhenUserIsNotInvitedInRequestedSubscription.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 3187
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenUpdatingUserEnvironments.WhenTokenIsLinkedToFullAccessOrSAOrEA.WhenUserIsNotInvitedInRequestedSubscription.AnHttpBadRequestIsReturned(Jwt jwt, UserEnvironmentsModel model) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 3171
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When token has SA/EA/FA roles but requested user is not found. Returns 404NotFound." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenUpdatingUserEnvironments+WhenTokenIsLinkedToFullAccessOrSAOrEA+WhenUserIsNotFound.AnHttpNotFoundIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNzAyMTI3MzI4LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIkZBIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vc3Vic2NyaXB0aW9ucyI6W10sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., model: UserEnvironmentsModel { EnvironmentRoles = [[00000000-0000-0000-0000-000000000001] = [EU]] })" time="0.2149467" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenUpdatingUserEnvironments.WhenTokenIsLinkedToFullAccessOrSAOrEA.WhenUserIsNotFound.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 3227
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenUpdatingUserEnvironments.WhenTokenIsLinkedToFullAccessOrSAOrEA.WhenUserIsNotFound.AnHttpNotFoundIsReturned(Jwt jwt, UserEnvironmentsModel model) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 3211
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When token has SA/EA/FA roles but requested user is not found. Returns 404NotFound." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenUpdatingUserEnvironments+WhenTokenIsLinkedToFullAccessOrSAOrEA+WhenUserIsNotFound.AnHttpNotFoundIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MzI4LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMXxTQSIsIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMnxTQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAxIiwiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAyIiwiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAzIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., model: UserEnvironmentsModel { EnvironmentRoles = [[00000000-0000-0000-0000-000000000001] = [EU]] })" time="0.1805868" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenUpdatingUserEnvironments.WhenTokenIsLinkedToFullAccessOrSAOrEA.WhenUserIsNotFound.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 3227
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenUpdatingUserEnvironments.WhenTokenIsLinkedToFullAccessOrSAOrEA.WhenUserIsNotFound.AnHttpNotFoundIsReturned(Jwt jwt, UserEnvironmentsModel model) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 3211
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When token has SA/EA/FA roles but requested user is not found. Returns 404NotFound." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenUpdatingUserEnvironments+WhenTokenIsLinkedToFullAccessOrSAOrEA+WhenUserIsNotFound.AnHttpNotFoundIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MzI4LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMXxFQSIsIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMXxFQSIsIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwM3xFQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAxIiwiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAyIiwiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAzIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., model: UserEnvironmentsModel { EnvironmentRoles = [[00000000-0000-0000-0000-000000000001] = [EU]] })" time="0.2167853" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenUpdatingUserEnvironments.WhenTokenIsLinkedToFullAccessOrSAOrEA.WhenUserIsNotFound.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 3227
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenUpdatingUserEnvironments.WhenTokenIsLinkedToFullAccessOrSAOrEA.WhenUserIsNotFound.AnHttpNotFoundIsReturned(Jwt jwt, UserEnvironmentsModel model) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 3211
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When token has SA/EA/FA roles but requested subscription is not found. Returns 404NotFound." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenUpdatingUserEnvironments+WhenTokenIsLinkedToFullAccessOrSAOrEA+WhenSubscriptionIsNotFound.AnHttpNotFoundIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNzI4NzM4NTI4LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIkZBIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vc3Vic2NyaXB0aW9ucyI6W10sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.2115573" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenUpdatingUserEnvironments.WhenTokenIsLinkedToFullAccessOrSAOrEA.WhenSubscriptionIsNotFound.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 3280
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenUpdatingUserEnvironments.WhenTokenIsLinkedToFullAccessOrSAOrEA.WhenSubscriptionIsNotFound.AnHttpNotFoundIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 3251
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When token has SA/EA/FA roles but requested subscription is not found. Returns 404NotFound." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenUpdatingUserEnvironments+WhenTokenIsLinkedToFullAccessOrSAOrEA+WhenSubscriptionIsNotFound.AnHttpNotFoundIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MzI4LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMXxTQSIsIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMnxTQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAxIiwiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAyIiwiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAzIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.2092655" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenUpdatingUserEnvironments.WhenTokenIsLinkedToFullAccessOrSAOrEA.WhenSubscriptionIsNotFound.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 3280
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenUpdatingUserEnvironments.WhenTokenIsLinkedToFullAccessOrSAOrEA.WhenSubscriptionIsNotFound.AnHttpNotFoundIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 3251
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When token has SA/EA/FA roles but requested subscription is not found. Returns 404NotFound." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenUpdatingUserEnvironments+WhenTokenIsLinkedToFullAccessOrSAOrEA+WhenSubscriptionIsNotFound.AnHttpNotFoundIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MzI4LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMXxFQSIsIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMXxFQSIsIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwM3xFQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAxIiwiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAyIiwiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAzIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.2359597" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenUpdatingUserEnvironments.WhenTokenIsLinkedToFullAccessOrSAOrEA.WhenSubscriptionIsNotFound.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 3280
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenUpdatingUserEnvironments.WhenTokenIsLinkedToFullAccessOrSAOrEA.WhenSubscriptionIsNotFound.AnHttpNotFoundIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 3251
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When token has SA/EA/FA roles but user is trying to assign both EA and EU role the same environment. Returns 400BadRequest.." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenUpdatingUserEnvironments+WhenTokenIsLinkedToFullAccessOrSAOrEA+WhenModelHaveBothEUAndEARolesForTheSameEnvironment.AnHttpBadRequestIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjk5NjIxNzI5LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIkZBIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vc3Vic2NyaXB0aW9ucyI6W10sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.1752906" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenUpdatingUserEnvironments.WhenTokenIsLinkedToFullAccessOrSAOrEA.WhenModelHaveBothEUAndEARolesForTheSameEnvironment.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 3334
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenUpdatingUserEnvironments.WhenTokenIsLinkedToFullAccessOrSAOrEA.WhenModelHaveBothEUAndEARolesForTheSameEnvironment.AnHttpBadRequestIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 3304
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When token has SA/EA/FA roles but user is trying to assign both EA and EU role the same environment. Returns 400BadRequest.." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenUpdatingUserEnvironments+WhenTokenIsLinkedToFullAccessOrSAOrEA+WhenModelHaveBothEUAndEARolesForTheSameEnvironment.AnHttpBadRequestIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MzI5LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMXxTQSIsIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMnxTQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAxIiwiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAyIiwiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAzIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="1.7581480" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenUpdatingUserEnvironments.WhenTokenIsLinkedToFullAccessOrSAOrEA.WhenModelHaveBothEUAndEARolesForTheSameEnvironment.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 3334
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenUpdatingUserEnvironments.WhenTokenIsLinkedToFullAccessOrSAOrEA.WhenModelHaveBothEUAndEARolesForTheSameEnvironment.AnHttpBadRequestIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 3304
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When token has SA/EA/FA roles but user is trying to assign both EA and EU role the same environment. Returns 400BadRequest.." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenUpdatingUserEnvironments+WhenTokenIsLinkedToFullAccessOrSAOrEA+WhenModelHaveBothEUAndEARolesForTheSameEnvironment.AnHttpBadRequestIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MzI5LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMXxFQSIsIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMXxFQSIsIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwM3xFQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAxIiwiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAyIiwiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAzIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.4450011" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenUpdatingUserEnvironments.WhenTokenIsLinkedToFullAccessOrSAOrEA.WhenModelHaveBothEUAndEARolesForTheSameEnvironment.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 3334
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenUpdatingUserEnvironments.WhenTokenIsLinkedToFullAccessOrSAOrEA.WhenModelHaveBothEUAndEARolesForTheSameEnvironment.AnHttpBadRequestIsReturned(Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 3304
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When token has SA/EA/FA roles but requested environment does not belong to requested subscription. Returns 400BadRequest." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenUpdatingUserEnvironments+WhenTokenIsLinkedToFullAccessOrSAOrEA+WhenEnvironmentDoesNotBelongToRequestedSubscription.AnHttpBadRequestIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNzAxMDkwNTMxLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIkZBIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vc3Vic2NyaXB0aW9ucyI6W10sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., model: UserEnvironmentsModel { EnvironmentRoles = [[00000000-0000-0000-0000-000000000003] = [EU]] })" time="0.5271131" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenUpdatingUserEnvironments.WhenTokenIsLinkedToFullAccessOrSAOrEA.WhenEnvironmentDoesNotBelongToRequestedSubscription.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 3374
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenUpdatingUserEnvironments.WhenTokenIsLinkedToFullAccessOrSAOrEA.WhenEnvironmentDoesNotBelongToRequestedSubscription.AnHttpBadRequestIsReturned(Jwt jwt, UserEnvironmentsModel model) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 3358
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When token has SA/EA/FA roles but requested environment does not belong to requested subscription. Returns 400BadRequest." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenUpdatingUserEnvironments+WhenTokenIsLinkedToFullAccessOrSAOrEA+WhenEnvironmentDoesNotBelongToRequestedSubscription.AnHttpBadRequestIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MzMxLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMXxTQSIsIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMnxTQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAxIiwiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAyIiwiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAzIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., model: UserEnvironmentsModel { EnvironmentRoles = [[00000000-0000-0000-0000-000000000003] = [EU]] })" time="0.2287722" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenUpdatingUserEnvironments.WhenTokenIsLinkedToFullAccessOrSAOrEA.WhenEnvironmentDoesNotBelongToRequestedSubscription.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 3374
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenUpdatingUserEnvironments.WhenTokenIsLinkedToFullAccessOrSAOrEA.WhenEnvironmentDoesNotBelongToRequestedSubscription.AnHttpBadRequestIsReturned(Jwt jwt, UserEnvironmentsModel model) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 3358
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When token has SA/EA/FA roles but requested environment does not belong to requested subscription. Returns 400BadRequest." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenUpdatingUserEnvironments+WhenTokenIsLinkedToFullAccessOrSAOrEA+WhenEnvironmentDoesNotBelongToRequestedSubscription.AnHttpBadRequestIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MzMxLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMXxFQSIsIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMXxFQSIsIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwM3xFQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAxIiwiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAyIiwiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAzIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., model: UserEnvironmentsModel { EnvironmentRoles = [[00000000-0000-0000-0000-000000000003] = [EU]] })" time="0.2056797" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenUpdatingUserEnvironments.WhenTokenIsLinkedToFullAccessOrSAOrEA.WhenEnvironmentDoesNotBelongToRequestedSubscription.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 3374
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenUpdatingUserEnvironments.WhenTokenIsLinkedToFullAccessOrSAOrEA.WhenEnvironmentDoesNotBelongToRequestedSubscription.AnHttpBadRequestIsReturned(Jwt jwt, UserEnvironmentsModel model) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 3358
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When token has SA/EA/FA roles but service fails to update user. Returns 500InternalServerError." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenUpdatingUserEnvironments+WhenTokenIsLinkedToFullAccessOrSAOrEA+WhenServiceFailsToUpdateUser.AnHttpInternalServerErrorIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNzI0NzY0MTMyLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIkZBIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vc3Vic2NyaXB0aW9ucyI6W10sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., model: UserEnvironmentsModel { EnvironmentRoles = [[00000000-0000-0000-0000-000000000001] = [EU]] })" time="0.2168097" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenUpdatingUserEnvironments.WhenTokenIsLinkedToFullAccessOrSAOrEA.WhenServiceFailsToUpdateUser.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 3414
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenUpdatingUserEnvironments.WhenTokenIsLinkedToFullAccessOrSAOrEA.WhenServiceFailsToUpdateUser.AnHttpInternalServerErrorIsReturned(Jwt jwt, UserEnvironmentsModel model) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 3398
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When token has SA/EA/FA roles but service fails to update user. Returns 500InternalServerError." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenUpdatingUserEnvironments+WhenTokenIsLinkedToFullAccessOrSAOrEA+WhenServiceFailsToUpdateUser.AnHttpInternalServerErrorIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MzMyLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMXxTQSIsIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMnxTQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAxIiwiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAyIiwiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAzIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., model: UserEnvironmentsModel { EnvironmentRoles = [[00000000-0000-0000-0000-000000000001] = [EU]] })" time="0.2846077" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenUpdatingUserEnvironments.WhenTokenIsLinkedToFullAccessOrSAOrEA.WhenServiceFailsToUpdateUser.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 3414
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenUpdatingUserEnvironments.WhenTokenIsLinkedToFullAccessOrSAOrEA.WhenServiceFailsToUpdateUser.AnHttpInternalServerErrorIsReturned(Jwt jwt, UserEnvironmentsModel model) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 3398
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When token has SA/EA/FA roles but service fails to update user. Returns 500InternalServerError." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenUpdatingUserEnvironments+WhenTokenIsLinkedToFullAccessOrSAOrEA+WhenServiceFailsToUpdateUser.AnHttpInternalServerErrorIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5MTY3MzMyLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMXxFQSIsIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMXxFQSIsIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwM3xFQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAxIiwiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAyIiwiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAzIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., model: UserEnvironmentsModel { EnvironmentRoles = [[00000000-0000-0000-0000-000000000001] = [EU]] })" time="0.1906716" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenUpdatingUserEnvironments.WhenTokenIsLinkedToFullAccessOrSAOrEA.WhenServiceFailsToUpdateUser.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 3414
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenUpdatingUserEnvironments.WhenTokenIsLinkedToFullAccessOrSAOrEA.WhenServiceFailsToUpdateUser.AnHttpInternalServerErrorIsReturned(Jwt jwt, UserEnvironmentsModel model) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 3398
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When token has SA/EA/FA roles and roles are successfully added/updated/removed. Returns 200OK." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenUpdatingUserEnvironments+WhenTokenIsLinkedToFullAccessOrSAOrEA+WhenEnvironmentRoleIsSuccessfullyAddedOrRemovedOrUpdated.AnHttpOkStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjk5NDQ4OTMzLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIkZBIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vc3Vic2NyaXB0aW9ucyI6W10sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., model: UserEnvironmentsModel { EnvironmentRoles = [[00000000-0000-0000-0000-000000000002] = [EA, CA]] })" time="1.4192511" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenUpdatingUserEnvironments.WhenTokenIsLinkedToFullAccessOrSAOrEA.WhenEnvironmentRoleIsSuccessfullyAddedOrRemovedOrUpdated.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 3463
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenUpdatingUserEnvironments.WhenTokenIsLinkedToFullAccessOrSAOrEA.WhenEnvironmentRoleIsSuccessfullyAddedOrRemovedOrUpdated.AnHttpOkStatusCodeIsReturned(Jwt jwt, UserEnvironmentsModel model) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 3447
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When token has SA/EA/FA roles and roles are successfully added/updated/removed. Returns 200OK." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenUpdatingUserEnvironments+WhenTokenIsLinkedToFullAccessOrSAOrEA+WhenEnvironmentRoleIsSuccessfullyAddedOrRemovedOrUpdated.AnHttpOkStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNzA1NDk2OTMzLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIkZBIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vc3Vic2NyaXB0aW9ucyI6W10sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., model: UserEnvironmentsModel { EnvironmentRoles = [[00000000-0000-0000-0000-000000000002] = [EA, CA]] })" time="1.6301425" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenUpdatingUserEnvironments.WhenTokenIsLinkedToFullAccessOrSAOrEA.WhenEnvironmentRoleIsSuccessfullyAddedOrRemovedOrUpdated.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 3463
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenUpdatingUserEnvironments.WhenTokenIsLinkedToFullAccessOrSAOrEA.WhenEnvironmentRoleIsSuccessfullyAddedOrRemovedOrUpdated.AnHttpOkStatusCodeIsReturned(Jwt jwt, UserEnvironmentsModel model) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 3447
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When token has SA/EA/FA roles and roles are successfully added/updated/removed. Returns 200OK." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenUpdatingUserEnvironments+WhenTokenIsLinkedToFullAccessOrSAOrEA+WhenEnvironmentRoleIsSuccessfullyAddedOrRemovedOrUpdated.AnHttpOkStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjkwOTgxNzMzLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIkZBIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vc3Vic2NyaXB0aW9ucyI6W10sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., model: UserEnvironmentsModel { EnvironmentRoles = [[00000000-0000-0000-0000-000000000002] = [EA, CA]] })" time="1.2987605" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenUpdatingUserEnvironments.WhenTokenIsLinkedToFullAccessOrSAOrEA.WhenEnvironmentRoleIsSuccessfullyAddedOrRemovedOrUpdated.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 3463
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenUpdatingUserEnvironments.WhenTokenIsLinkedToFullAccessOrSAOrEA.WhenEnvironmentRoleIsSuccessfullyAddedOrRemovedOrUpdated.AnHttpOkStatusCodeIsReturned(Jwt jwt, UserEnvironmentsModel model) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 3447
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When token has SA/EA/FA roles and roles are successfully added/updated/removed. Returns 200OK." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenUpdatingUserEnvironments+WhenTokenIsLinkedToFullAccessOrSAOrEA+WhenEnvironmentRoleIsSuccessfullyAddedOrRemovedOrUpdated.AnHttpOkStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjk1NjQ3MzMzLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIkZBIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vc3Vic2NyaXB0aW9ucyI6W10sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., model: UserEnvironmentsModel { EnvironmentRoles = [[00000000-0000-0000-0000-000000000001] = [EU]] })" time="0.7310267" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenUpdatingUserEnvironments.WhenTokenIsLinkedToFullAccessOrSAOrEA.WhenEnvironmentRoleIsSuccessfullyAddedOrRemovedOrUpdated.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 3463
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenUpdatingUserEnvironments.WhenTokenIsLinkedToFullAccessOrSAOrEA.WhenEnvironmentRoleIsSuccessfullyAddedOrRemovedOrUpdated.AnHttpOkStatusCodeIsReturned(Jwt jwt, UserEnvironmentsModel model) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 3447
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When token has SA/EA/FA roles and roles are successfully added/updated/removed. Returns 200OK." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenUpdatingUserEnvironments+WhenTokenIsLinkedToFullAccessOrSAOrEA+WhenEnvironmentRoleIsSuccessfullyAddedOrRemovedOrUpdated.AnHttpOkStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNzEwMzM1MzMzLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIkZBIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vc3Vic2NyaXB0aW9ucyI6W10sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., model: UserEnvironmentsModel { EnvironmentRoles = [[00000000-0000-0000-0000-000000000001] = [EU]] })" time="1.4353905" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenUpdatingUserEnvironments.WhenTokenIsLinkedToFullAccessOrSAOrEA.WhenEnvironmentRoleIsSuccessfullyAddedOrRemovedOrUpdated.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 3463
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenUpdatingUserEnvironments.WhenTokenIsLinkedToFullAccessOrSAOrEA.WhenEnvironmentRoleIsSuccessfullyAddedOrRemovedOrUpdated.AnHttpOkStatusCodeIsReturned(Jwt jwt, UserEnvironmentsModel model) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 3447
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When token has SA/EA/FA roles and roles are successfully added/updated/removed. Returns 200OK." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenUpdatingUserEnvironments+WhenTokenIsLinkedToFullAccessOrSAOrEA+WhenEnvironmentRoleIsSuccessfullyAddedOrRemovedOrUpdated.AnHttpOkStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNzA5OTAzMzMzLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIkZBIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vc3Vic2NyaXB0aW9ucyI6W10sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., model: UserEnvironmentsModel { EnvironmentRoles = [[00000000-0000-0000-0000-000000000001] = [EU]] })" time="0.2463133" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenUpdatingUserEnvironments.WhenTokenIsLinkedToFullAccessOrSAOrEA.WhenEnvironmentRoleIsSuccessfullyAddedOrRemovedOrUpdated.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 3463
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenUpdatingUserEnvironments.WhenTokenIsLinkedToFullAccessOrSAOrEA.WhenEnvironmentRoleIsSuccessfullyAddedOrRemovedOrUpdated.AnHttpOkStatusCodeIsReturned(Jwt jwt, UserEnvironmentsModel model) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 3447
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When token has SA/EA/FA roles and roles are successfully added/updated/removed. Returns 200OK." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenUpdatingUserEnvironments+WhenTokenIsLinkedToFullAccessOrSAOrEA+WhenEnvironmentRoleIsSuccessfullyAddedOrRemovedOrUpdated.AnHttpOkStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNzE1NTE5MzMzLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIkZBIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vc3Vic2NyaXB0aW9ucyI6W10sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., model: UserEnvironmentsModel { EnvironmentRoles = [[00000000-0000-0000-0000-000000000001] = []] })" time="0.2684684" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenUpdatingUserEnvironments.WhenTokenIsLinkedToFullAccessOrSAOrEA.WhenEnvironmentRoleIsSuccessfullyAddedOrRemovedOrUpdated.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 3463
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenUpdatingUserEnvironments.WhenTokenIsLinkedToFullAccessOrSAOrEA.WhenEnvironmentRoleIsSuccessfullyAddedOrRemovedOrUpdated.AnHttpOkStatusCodeIsReturned(Jwt jwt, UserEnvironmentsModel model) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 3447
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When token has SA/EA/FA roles and roles are successfully added/updated/removed. Returns 200OK." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenUpdatingUserEnvironments+WhenTokenIsLinkedToFullAccessOrSAOrEA+WhenEnvironmentRoleIsSuccessfullyAddedOrRemovedOrUpdated.AnHttpOkStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNzE5ODM5MzMzLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIkZBIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vc3Vic2NyaXB0aW9ucyI6W10sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., model: UserEnvironmentsModel { EnvironmentRoles = [[00000000-0000-0000-0000-000000000001] = []] })" time="0.2621472" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenUpdatingUserEnvironments.WhenTokenIsLinkedToFullAccessOrSAOrEA.WhenEnvironmentRoleIsSuccessfullyAddedOrRemovedOrUpdated.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 3463
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenUpdatingUserEnvironments.WhenTokenIsLinkedToFullAccessOrSAOrEA.WhenEnvironmentRoleIsSuccessfullyAddedOrRemovedOrUpdated.AnHttpOkStatusCodeIsReturned(Jwt jwt, UserEnvironmentsModel model) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 3447
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When token has SA/EA/FA roles and roles are successfully added/updated/removed. Returns 200OK." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenUpdatingUserEnvironments+WhenTokenIsLinkedToFullAccessOrSAOrEA+WhenEnvironmentRoleIsSuccessfullyAddedOrRemovedOrUpdated.AnHttpOkStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNzExMDI2NTMzLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIkZBIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vc3Vic2NyaXB0aW9ucyI6W10sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., model: UserEnvironmentsModel { EnvironmentRoles = [[00000000-0000-0000-0000-000000000001] = []] })" time="0.2569271" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenUpdatingUserEnvironments.WhenTokenIsLinkedToFullAccessOrSAOrEA.WhenEnvironmentRoleIsSuccessfullyAddedOrRemovedOrUpdated.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 3463
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenUpdatingUserEnvironments.WhenTokenIsLinkedToFullAccessOrSAOrEA.WhenEnvironmentRoleIsSuccessfullyAddedOrRemovedOrUpdated.AnHttpOkStatusCodeIsReturned(Jwt jwt, UserEnvironmentsModel model) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 3447
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When user has TD role in requested subscription and has SA in other subscription. Returns 403Forbidden." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenGrantingSubscriptionLevelRoles+WhenTokenHasNoPermissions+WhenUserIsTDInRequestedSubscription.AnHttpForbiddenStatusCodeIsReturned(jwtCustomization: UserRoleJwtCustomization { }, model: UserSubscriptionRolesModel { SubscriptionRoles = [SA, TD] })" time="0.3259716" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected result.StatusCode to be HttpStatusCode.Forbidden {value: 403}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected result.StatusCode to be HttpStatusCode.Forbidden {value: 403}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.EnumAssertions`2.Be(TEnum expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenGrantingSubscriptionLevelRoles.WhenTokenHasNoPermissions.WhenUserIsTDInRequestedSubscription.AnHttpForbiddenStatusCodeIsReturned(ICustomization jwtCustomization, UserSubscriptionRolesModel model) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 3759
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When user has EA/EU/CA/SU/WA role and has access to subscription. Returns 403Forbidden." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenGrantingSubscriptionLevelRoles+WhenTokenHasNoPermissions+WhenUserIsEAOrEUOrCAOrSUOrWA.AnHttpForbiddenStatusCodeIsReturned(jwtCustomization: UserRoleJwtCustomization { }, model: UserSubscriptionRolesModel { SubscriptionRoles = [SA, TD] })" time="1.1708545" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected result.StatusCode to be HttpStatusCode.Forbidden {value: 403}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected result.StatusCode to be HttpStatusCode.Forbidden {value: 403}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.EnumAssertions`2.Be(TEnum expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenGrantingSubscriptionLevelRoles.WhenTokenHasNoPermissions.WhenUserIsEAOrEUOrCAOrSUOrWA.AnHttpForbiddenStatusCodeIsReturned(ICustomization jwtCustomization, UserSubscriptionRolesModel model) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 3793
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When user has EA/EU/CA/SU/WA role and has access to subscription. Returns 403Forbidden." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenGrantingSubscriptionLevelRoles+WhenTokenHasNoPermissions+WhenUserIsEAOrEUOrCAOrSUOrWA.AnHttpForbiddenStatusCodeIsReturned(jwtCustomization: UserRoleJwtCustomization { }, model: UserSubscriptionRolesModel { SubscriptionRoles = [SA, TD] })" time="0.4949642" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected result.StatusCode to be HttpStatusCode.Forbidden {value: 403}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected result.StatusCode to be HttpStatusCode.Forbidden {value: 403}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.EnumAssertions`2.Be(TEnum expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenGrantingSubscriptionLevelRoles.WhenTokenHasNoPermissions.WhenUserIsEAOrEUOrCAOrSUOrWA.AnHttpForbiddenStatusCodeIsReturned(ICustomization jwtCustomization, UserSubscriptionRolesModel model) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 3793
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When user has EA/EU/CA/SU/WA role and has access to subscription. Returns 403Forbidden." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenGrantingSubscriptionLevelRoles+WhenTokenHasNoPermissions+WhenUserIsEAOrEUOrCAOrSUOrWA.AnHttpForbiddenStatusCodeIsReturned(jwtCustomization: UserRoleJwtCustomization { }, model: UserSubscriptionRolesModel { SubscriptionRoles = [SA, TD] })" time="0.3731160" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected result.StatusCode to be HttpStatusCode.Forbidden {value: 403}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected result.StatusCode to be HttpStatusCode.Forbidden {value: 403}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.EnumAssertions`2.Be(TEnum expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenGrantingSubscriptionLevelRoles.WhenTokenHasNoPermissions.WhenUserIsEAOrEUOrCAOrSUOrWA.AnHttpForbiddenStatusCodeIsReturned(ICustomization jwtCustomization, UserSubscriptionRolesModel model) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 3793
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When user has EA/EU/CA/SU/WA role and has access to subscription. Returns 403Forbidden." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenGrantingSubscriptionLevelRoles+WhenTokenHasNoPermissions+WhenUserIsEAOrEUOrCAOrSUOrWA.AnHttpForbiddenStatusCodeIsReturned(jwtCustomization: UserRoleJwtCustomization { }, model: UserSubscriptionRolesModel { SubscriptionRoles = [SA, TD] })" time="0.5020488" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected result.StatusCode to be HttpStatusCode.Forbidden {value: 403}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected result.StatusCode to be HttpStatusCode.Forbidden {value: 403}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.EnumAssertions`2.Be(TEnum expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenGrantingSubscriptionLevelRoles.WhenTokenHasNoPermissions.WhenUserIsEAOrEUOrCAOrSUOrWA.AnHttpForbiddenStatusCodeIsReturned(ICustomization jwtCustomization, UserSubscriptionRolesModel model) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 3793
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When user has EA/EU/CA/SU/WA role and has access to subscription. Returns 403Forbidden." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenGrantingSubscriptionLevelRoles+WhenTokenHasNoPermissions+WhenUserIsEAOrEUOrCAOrSUOrWA.AnHttpForbiddenStatusCodeIsReturned(jwtCustomization: UserRoleJwtCustomization { }, model: UserSubscriptionRolesModel { SubscriptionRoles = [SA, TD] })" time="0.3154254" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected result.StatusCode to be HttpStatusCode.Forbidden {value: 403}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected result.StatusCode to be HttpStatusCode.Forbidden {value: 403}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.EnumAssertions`2.Be(TEnum expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenGrantingSubscriptionLevelRoles.WhenTokenHasNoPermissions.WhenUserIsEAOrEUOrCAOrSUOrWA.AnHttpForbiddenStatusCodeIsReturned(ICustomization jwtCustomization, UserSubscriptionRolesModel model) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 3793
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When user is invited in subscription but doesn't have roles in it. Returns 403Forbidden." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenGrantingSubscriptionLevelRoles+WhenTokenHasNoPermissions+WhenUserIsInvitedInSubscriptionButDoesNotHaveAnyRoles.AnHttpForbiddenStatusCodeIsReturned(jwtCustomization: UserRoleJwtCustomization { }, model: UserSubscriptionRolesModel { SubscriptionRoles = [SA, TD] })" time="0.3340657" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Expected result.StatusCode to be HttpStatusCode.Forbidden {value: 403}, but found HttpStatusCode.Unauthorized {value: 401}.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- Expected result.StatusCode to be HttpStatusCode.Forbidden {value: 403}, but found HttpStatusCode.Unauthorized {value: 401}.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (Xunit.Sdk.XunitException) -----
   at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Primitives.EnumAssertions`2.Be(TEnum expected, String because, Object[] becauseArgs)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenGrantingSubscriptionLevelRoles.WhenTokenHasNoPermissions.WhenUserIsInvitedInSubscriptionButDoesNotHaveAnyRoles.AnHttpForbiddenStatusCodeIsReturned(ICustomization jwtCustomization, UserSubscriptionRolesModel model) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 3823
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When token has SA/FA roles but requested user is not found. Returns 404NotFound." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenGrantingSubscriptionLevelRoles+WhenTokenIsLinkedToFullAccessOrSA+WhenUserIsNotFound.AnHttpNotFoundIsReturned(jwtCustomization: FullAccessRoleJwtCustomization { }, model: UserSubscriptionRolesModel { SubscriptionRoles = [SA, TD] })" time="0.2279714" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenGrantingSubscriptionLevelRoles.WhenTokenIsLinkedToFullAccessOrSA.WhenUserIsNotFound.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 4187
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenGrantingSubscriptionLevelRoles.WhenTokenIsLinkedToFullAccessOrSA.WhenUserIsNotFound.AnHttpNotFoundIsReturned(ICustomization jwtCustomization, UserSubscriptionRolesModel model) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 4171
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When token has SA/FA roles but requested user is not found. Returns 404NotFound." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenGrantingSubscriptionLevelRoles+WhenTokenIsLinkedToFullAccessOrSA+WhenUserIsNotFound.AnHttpNotFoundIsReturned(jwtCustomization: SubscriptionAdministratorRoleJwtCustomization { }, model: UserSubscriptionRolesModel { SubscriptionRoles = [SA, TD] })" time="0.1737426" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenGrantingSubscriptionLevelRoles.WhenTokenIsLinkedToFullAccessOrSA.WhenUserIsNotFound.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 4187
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenGrantingSubscriptionLevelRoles.WhenTokenIsLinkedToFullAccessOrSA.WhenUserIsNotFound.AnHttpNotFoundIsReturned(ICustomization jwtCustomization, UserSubscriptionRolesModel model) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 4171
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When user is not found. Returns 404NotFound" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenDeleteSubscriptionRole+WhenTokenLinkedToFAOrSA+WhenUserIsNotFound.ReturnNotFound(subscriptionRole: SA, jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjk0NjEwNTQ1LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMXxTQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAxIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6Im5vbl9leGlzdGluZ191c2VyaWQiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.2041953" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenDeleteSubscriptionRole.WhenTokenLinkedToFAOrSA.WhenUserIsNotFound.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 4669
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenDeleteSubscriptionRole.WhenTokenLinkedToFAOrSA.WhenUserIsNotFound.ReturnNotFound(SubscriptionRoleIdentifier subscriptionRole, Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 4653
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When user is not found. Returns 404NotFound" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenDeleteSubscriptionRole+WhenTokenLinkedToFAOrSA+WhenUserIsNotFound.ReturnNotFound(subscriptionRole: SA, jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNzIyMzQ0OTQ1LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIkZBIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vc3Vic2NyaXB0aW9ucyI6W10sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.2154963" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenDeleteSubscriptionRole.WhenTokenLinkedToFAOrSA.WhenUserIsNotFound.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 4669
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenDeleteSubscriptionRole.WhenTokenLinkedToFAOrSA.WhenUserIsNotFound.ReturnNotFound(SubscriptionRoleIdentifier subscriptionRole, Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 4653
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests+WhenRequestingTheUserEmailVerificationStatus+WhenTheUserIsFound+WhenTheSignatureIsValid+WhenTheEmailIsVerified.TrueIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenRequestingTheUserEmailVerificationStatus+WhenTheUserIsFound+WhenTheSignatureIsValid+WhenTheEmailIsVerified.TrueIsReturned" time="0.2338656" result="Fail">
        <failure>
          <message>System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests+WhenRequestingTheUserEmailVerificationStatus+WhenTheUserIsFound+WhenTheSignatureIsValid+WhenTheEmailIsVerified.AnHttpOkStatusCodeIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenRequestingTheUserEmailVerificationStatus+WhenTheUserIsFound+WhenTheSignatureIsValid+WhenTheEmailIsVerified.AnHttpOkStatusCodeIsReturned" time="0.2275518" result="Fail">
        <failure>
          <message>System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests+WhenRequestingTheUserEmailVerificationStatus+WhenTheUserIsFound+WhenTheSignatureIsValid+WhenTheEmailIsNotVerified.FalseIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenRequestingTheUserEmailVerificationStatus+WhenTheUserIsFound+WhenTheSignatureIsValid+WhenTheEmailIsNotVerified.FalseIsReturned" time="0.2512009" result="Fail">
        <failure>
          <message>System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests+WhenRequestingTheUserEmailVerificationStatus+WhenTheUserIsFound+WhenTheSignatureIsValid+WhenTheEmailIsNotVerified.AnHttpOkStatusCodeIsReturned" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenRequestingTheUserEmailVerificationStatus+WhenTheUserIsFound+WhenTheSignatureIsValid+WhenTheEmailIsNotVerified.AnHttpOkStatusCodeIsReturned" time="0.2371002" result="Fail">
        <failure>
          <message>System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When the user is SA/EA/FA and sending UserResetEmail succeeded. Return 200 OK" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenInvitingUsers+WhenTokenIsLinkedToFullAccessOrSAOrEA+WhenTheUserWasCreated+WhenTheUserResetEmailSendSuccessfully.AnHttpOkStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNzExNjMxMzY3LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIkZBIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vc3Vic2NyaXB0aW9ucyI6W10sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., model: InviteUsersModel { Environments = [EnvironmentRoleModel { ... }], SubscriptionIds = [00000000-0000-0000-0000-000000000001], UserEmails = [&quot;e12f221c-bea8-4dd4-afc7-6e0a3c64f4f0@example.net&quot;, &quot;673be9c1-77d9-45a4-9103-b1a6e7c93a76@example.org&quot;, &quot;626ac2a3-f6b0-400a-8fb8-b73a00166ddc@example.com&quot;] })" time="0.2847624" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenInvitingUsers.WhenTokenIsLinkedToFullAccessOrSAOrEA.WhenTheUserWasCreated.WhenTheUserResetEmailSendSuccessfully.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 2399
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenInvitingUsers.WhenTokenIsLinkedToFullAccessOrSAOrEA.WhenTheUserWasCreated.WhenTheUserResetEmailSendSuccessfully.AnHttpOkStatusCodeIsReturned(Jwt jwt, InviteUsersModel model) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 2338
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When the user is SA/EA/FA and sending UserResetEmail succeeded. Return 200 OK" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenInvitingUsers+WhenTokenIsLinkedToFullAccessOrSAOrEA+WhenTheUserWasCreated+WhenTheUserResetEmailSendSuccessfully.AnHttpOkStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNzI2NDA1NzY3LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMXxTQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAxIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., model: InviteUsersModel { Environments = [EnvironmentRoleModel { ... }], SubscriptionIds = [00000000-0000-0000-0000-000000000001], UserEmails = [&quot;cd327f6a-9dbe-498b-b18c-1619870ea38a@example.net&quot;, &quot;f42ada65-4a6a-4969-a6ee-d62856345d3c@example.com&quot;, &quot;ff86a122-c819-4d36-b86e-65d3dceb196a@example.org&quot;] })" time="0.2298238" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenInvitingUsers.WhenTokenIsLinkedToFullAccessOrSAOrEA.WhenTheUserWasCreated.WhenTheUserResetEmailSendSuccessfully.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 2399
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenInvitingUsers.WhenTokenIsLinkedToFullAccessOrSAOrEA.WhenTheUserWasCreated.WhenTheUserResetEmailSendSuccessfully.AnHttpOkStatusCodeIsReturned(Jwt jwt, InviteUsersModel model) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 2338
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When the user is SA/EA/FA and sending UserResetEmail succeeded. Return 200 OK" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenInvitingUsers+WhenTokenIsLinkedToFullAccessOrSAOrEA+WhenTheUserWasCreated+WhenTheUserResetEmailSendSuccessfully.AnHttpOkStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNzA5NTU3NzY3LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMXxFQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAxIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., model: InviteUsersModel { Environments = [EnvironmentRoleModel { ... }], SubscriptionIds = [00000000-0000-0000-0000-000000000001], UserEmails = [&quot;06f50a72-fbb5-4b9e-97ec-d93e1e01abc7@example.com&quot;, &quot;b4d0fb24-6b71-48cf-851b-1954afb10623@example.net&quot;, &quot;0b63e284-7830-4861-984e-96faa2969aff@example.org&quot;] })" time="0.2231693" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenInvitingUsers.WhenTokenIsLinkedToFullAccessOrSAOrEA.WhenTheUserWasCreated.WhenTheUserResetEmailSendSuccessfully.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 2399
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenInvitingUsers.WhenTokenIsLinkedToFullAccessOrSAOrEA.WhenTheUserWasCreated.WhenTheUserResetEmailSendSuccessfully.AnHttpOkStatusCodeIsReturned(Jwt jwt, InviteUsersModel model) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 2338
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When the user is SA/EA/FA and sending UserResetEmail failed. Return 200 OK" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenInvitingUsers+WhenTokenIsLinkedToFullAccessOrSAOrEA+WhenTheUserWasCreated+WhenTheUserResetEmailSendFailed.AnHttpOkStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNzA1MTUxMzY4LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIkZBIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vc3Vic2NyaXB0aW9ucyI6W10sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., model: InviteUsersModel { Environments = [EnvironmentRoleModel { ... }], SubscriptionIds = [00000000-0000-0000-0000-000000000001], UserEmails = [&quot;fcc4cbb1-17eb-4237-843b-8f6f8a95ce44@example.com&quot;, &quot;73eacdee-c7ae-49ef-aaf2-085f07b9add2@example.org&quot;, &quot;12d9e923-565b-40a5-aed6-b87a89598e93@example.net&quot;] })" time="0.2287317" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenInvitingUsers.WhenTokenIsLinkedToFullAccessOrSAOrEA.WhenTheUserWasCreated.WhenTheUserResetEmailSendFailed.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 2471
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenInvitingUsers.WhenTokenIsLinkedToFullAccessOrSAOrEA.WhenTheUserWasCreated.WhenTheUserResetEmailSendFailed.AnHttpOkStatusCodeIsReturned(Jwt jwt, InviteUsersModel model) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 2413
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When the user is SA/EA/FA and sending UserResetEmail failed. Return 200 OK" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenInvitingUsers+WhenTokenIsLinkedToFullAccessOrSAOrEA+WhenTheUserWasCreated+WhenTheUserResetEmailSendFailed.AnHttpOkStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNzIxNDgwOTY4LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMXxTQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAxIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., model: InviteUsersModel { Environments = [EnvironmentRoleModel { ... }], SubscriptionIds = [00000000-0000-0000-0000-000000000001], UserEmails = [&quot;29c48728-4c61-4a6b-8587-fb64ab944eec@example.net&quot;, &quot;0e0a294d-efe2-4eb7-902d-e9f318f3daaa@example.org&quot;, &quot;cb0a1ede-aa1d-4b14-9efa-54877fba0bc1@example.com&quot;] })" time="0.2020887" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenInvitingUsers.WhenTokenIsLinkedToFullAccessOrSAOrEA.WhenTheUserWasCreated.WhenTheUserResetEmailSendFailed.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 2471
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenInvitingUsers.WhenTokenIsLinkedToFullAccessOrSAOrEA.WhenTheUserWasCreated.WhenTheUserResetEmailSendFailed.AnHttpOkStatusCodeIsReturned(Jwt jwt, InviteUsersModel model) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 2413
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When the user is SA/EA/FA and sending UserResetEmail failed. Return 200 OK" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenInvitingUsers+WhenTokenIsLinkedToFullAccessOrSAOrEA+WhenTheUserWasCreated+WhenTheUserResetEmailSendFailed.AnHttpOkStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNzA0ODA1NzY4LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMXxFQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAxIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., model: InviteUsersModel { Environments = [EnvironmentRoleModel { ... }], SubscriptionIds = [00000000-0000-0000-0000-000000000001], UserEmails = [&quot;2614a1cc-1f8f-420f-8fd9-5d713644fa16@example.com&quot;, &quot;e283539d-7245-4ff5-8448-5657ebf7787e@example.org&quot;, &quot;8caaa014-c30f-4389-a184-a3c72fdcd5dd@example.net&quot;] })" time="0.2722780" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenInvitingUsers.WhenTokenIsLinkedToFullAccessOrSAOrEA.WhenTheUserWasCreated.WhenTheUserResetEmailSendFailed.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 2471
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenInvitingUsers.WhenTokenIsLinkedToFullAccessOrSAOrEA.WhenTheUserWasCreated.WhenTheUserResetEmailSendFailed.AnHttpOkStatusCodeIsReturned(Jwt jwt, InviteUsersModel model) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 2413
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When token has SA/FA roles but requested user is not invited to subscription. Returns 400BadRequest." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenGrantingSubscriptionLevelRoles+WhenTokenIsLinkedToFullAccessOrSA+WhenUserIsFound+WhenUserIsNotInvitedInRequestedSubscription.AnHttpBadRequestIsReturned(jwtCustomization: FullAccessRoleJwtCustomization { }, model: UserSubscriptionRolesModel { SubscriptionRoles = [SA, TD] })" time="0.1680182" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenGrantingSubscriptionLevelRoles.WhenTokenIsLinkedToFullAccessOrSA.WhenUserIsFound.WhenUserIsNotInvitedInRequestedSubscription.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 3910
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenGrantingSubscriptionLevelRoles.WhenTokenIsLinkedToFullAccessOrSA.WhenUserIsFound.WhenUserIsNotInvitedInRequestedSubscription.AnHttpBadRequestIsReturned(ICustomization jwtCustomization, UserSubscriptionRolesModel model) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 3894
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When token has SA/FA roles but requested user is not invited to subscription. Returns 400BadRequest." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenGrantingSubscriptionLevelRoles+WhenTokenIsLinkedToFullAccessOrSA+WhenUserIsFound+WhenUserIsNotInvitedInRequestedSubscription.AnHttpBadRequestIsReturned(jwtCustomization: SubscriptionAdministratorRoleJwtCustomization { }, model: UserSubscriptionRolesModel { SubscriptionRoles = [SA, TD] })" time="0.1614845" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenGrantingSubscriptionLevelRoles.WhenTokenIsLinkedToFullAccessOrSA.WhenUserIsFound.WhenUserIsNotInvitedInRequestedSubscription.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 3910
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenGrantingSubscriptionLevelRoles.WhenTokenIsLinkedToFullAccessOrSA.WhenUserIsFound.WhenUserIsNotInvitedInRequestedSubscription.AnHttpBadRequestIsReturned(ICustomization jwtCustomization, UserSubscriptionRolesModel model) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 3894
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When token has SA/EA/FA roles but requested subscription is not found. Returns 404NotFound." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenGrantingSubscriptionLevelRoles+WhenTokenIsLinkedToFullAccessOrSA+WhenUserIsFound+WhenSubscriptionIsNotFound.AnHttpNotFoundIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjk3NjM0NTY5LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIkZBIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vc3Vic2NyaXB0aW9ucyI6W10sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., model: UserSubscriptionRolesModel { SubscriptionRoles = [SA, TD] })" time="0.2103161" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenGrantingSubscriptionLevelRoles.WhenTokenIsLinkedToFullAccessOrSA.WhenUserIsFound.WhenSubscriptionIsNotFound.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 3949
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenGrantingSubscriptionLevelRoles.WhenTokenIsLinkedToFullAccessOrSA.WhenUserIsFound.WhenSubscriptionIsNotFound.AnHttpNotFoundIsReturned(Jwt jwt, UserSubscriptionRolesModel model) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 3933
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When token has SA/EA/FA roles but requested subscription is not found. Returns 404NotFound." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenGrantingSubscriptionLevelRoles+WhenTokenIsLinkedToFullAccessOrSA+WhenUserIsFound+WhenSubscriptionIsNotFound.AnHttpNotFoundIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNzA0NTQ2NTY5LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMHxTQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., model: UserSubscriptionRolesModel { SubscriptionRoles = [SA, TD] })" time="0.1619240" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenGrantingSubscriptionLevelRoles.WhenTokenIsLinkedToFullAccessOrSA.WhenUserIsFound.WhenSubscriptionIsNotFound.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 3949
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenGrantingSubscriptionLevelRoles.WhenTokenIsLinkedToFullAccessOrSA.WhenUserIsFound.WhenSubscriptionIsNotFound.AnHttpNotFoundIsReturned(Jwt jwt, UserSubscriptionRolesModel model) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 3933
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When user update is failed. Returns 500InternalServerError" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenDeleteSubscriptionRole+WhenTokenLinkedToFAOrSA+WhenUserIsFound+WhenUserUpdatedFailed.ReturnInternalServerError(subscriptionRole: SA, jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNzMxODQ4OTY5LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMXxTQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAxIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6Im5vbl9leGlzdGluZ191c2VyaWQiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.2007918" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenDeleteSubscriptionRole.WhenTokenLinkedToFAOrSA.WhenUserIsFound.WhenUserUpdatedFailed.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 4437
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenDeleteSubscriptionRole.WhenTokenLinkedToFAOrSA.WhenUserIsFound.WhenUserUpdatedFailed.ReturnInternalServerError(SubscriptionRoleIdentifier subscriptionRole, Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 4414
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When user update is failed. Returns 500InternalServerError" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenDeleteSubscriptionRole+WhenTokenLinkedToFAOrSA+WhenUserIsFound+WhenUserUpdatedFailed.ReturnInternalServerError(subscriptionRole: SA, jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjk0MjY0OTY5LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIkZBIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vc3Vic2NyaXB0aW9ucyI6W10sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="1.6925523" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenDeleteSubscriptionRole.WhenTokenLinkedToFAOrSA.WhenUserIsFound.WhenUserUpdatedFailed.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 4437
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenDeleteSubscriptionRole.WhenTokenLinkedToFAOrSA.WhenUserIsFound.WhenUserUpdatedFailed.ReturnInternalServerError(SubscriptionRoleIdentifier subscriptionRole, Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 4414
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When user update is finished successfully. Returns 200Ok" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenDeleteSubscriptionRole+WhenTokenLinkedToFAOrSA+WhenUserIsFound+WhenUserUpdatedSuccessfully.ReturnOk(subscriptionRole: SA, jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNzMwNzI1NzcxLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMXxTQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAxIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6Im5vbl9leGlzdGluZ191c2VyaWQiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.1979053" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenDeleteSubscriptionRole.WhenTokenLinkedToFAOrSA.WhenUserIsFound.WhenUserUpdatedSuccessfully.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 4492
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenDeleteSubscriptionRole.WhenTokenLinkedToFAOrSA.WhenUserIsFound.WhenUserUpdatedSuccessfully.ReturnOk(SubscriptionRoleIdentifier subscriptionRole, Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 4476
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When user update is finished successfully. Returns 200Ok" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenDeleteSubscriptionRole+WhenTokenLinkedToFAOrSA+WhenUserIsFound+WhenUserUpdatedSuccessfully.ReturnOk(subscriptionRole: SA, jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjk1OTkyOTcxLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIkZBIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vc3Vic2NyaXB0aW9ucyI6W10sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.1925638" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenDeleteSubscriptionRole.WhenTokenLinkedToFAOrSA.WhenUserIsFound.WhenUserUpdatedSuccessfully.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 4492
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenDeleteSubscriptionRole.WhenTokenLinkedToFAOrSA.WhenUserIsFound.WhenUserUpdatedSuccessfully.ReturnOk(SubscriptionRoleIdentifier subscriptionRole, Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 4476
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When user is not found while updating. Returns 404NotFound" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenDeleteSubscriptionRole+WhenTokenLinkedToFAOrSA+WhenUserIsFound+WhenUserNotFoundWhileUpdating.ReturnNotFound(subscriptionRole: SA, jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNzIyNjA0MTcyLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMXxTQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAxIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6Im5vbl9leGlzdGluZ191c2VyaWQiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.2290190" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenDeleteSubscriptionRole.WhenTokenLinkedToFAOrSA.WhenUserIsFound.WhenUserNotFoundWhileUpdating.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 4547
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenDeleteSubscriptionRole.WhenTokenLinkedToFAOrSA.WhenUserIsFound.WhenUserNotFoundWhileUpdating.ReturnNotFound(SubscriptionRoleIdentifier subscriptionRole, Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 4531
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When user is not found while updating. Returns 404NotFound" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenDeleteSubscriptionRole+WhenTokenLinkedToFAOrSA+WhenUserIsFound+WhenUserNotFoundWhileUpdating.ReturnNotFound(subscriptionRole: SA, jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNzA2MTg4MTcyLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIkZBIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vc3Vic2NyaXB0aW9ucyI6W10sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.2703427" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenDeleteSubscriptionRole.WhenTokenLinkedToFAOrSA.WhenUserIsFound.WhenUserNotFoundWhileUpdating.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 4547
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenDeleteSubscriptionRole.WhenTokenLinkedToFAOrSA.WhenUserIsFound.WhenUserNotFoundWhileUpdating.ReturnNotFound(SubscriptionRoleIdentifier subscriptionRole, Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 4531
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When user update is failed. Returns 500InternalServerError" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenActivateUserInSubscription+WhenTokenLinkedToFAOrSA+WhenUserIsFound+WhenUserUpdatedFailed.ReturnInternalServerError(subscriptionRole: SA, jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjkxMzI3MzcyLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMXxTQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAxIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6Im5vbl9leGlzdGluZ191c2VyaWQiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.2387671" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenActivateUserInSubscription.WhenTokenLinkedToFAOrSA.WhenUserIsFound.WhenUserUpdatedFailed.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 4781
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenActivateUserInSubscription.WhenTokenLinkedToFAOrSA.WhenUserIsFound.WhenUserUpdatedFailed.ReturnInternalServerError(SubscriptionRoleIdentifier subscriptionRole, Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 4758
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When user update is failed. Returns 500InternalServerError" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenActivateUserInSubscription+WhenTokenLinkedToFAOrSA+WhenUserIsFound+WhenUserUpdatedFailed.ReturnInternalServerError(subscriptionRole: SA, jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjk4MDY2NTcyLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIkZBIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vc3Vic2NyaXB0aW9ucyI6W10sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.2121836" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenActivateUserInSubscription.WhenTokenLinkedToFAOrSA.WhenUserIsFound.WhenUserUpdatedFailed.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 4781
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenActivateUserInSubscription.WhenTokenLinkedToFAOrSA.WhenUserIsFound.WhenUserUpdatedFailed.ReturnInternalServerError(SubscriptionRoleIdentifier subscriptionRole, Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 4758
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When user update is finished successfully. Returns 200Ok" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenActivateUserInSubscription+WhenTokenLinkedToFAOrSA+WhenUserIsFound+WhenUserUpdatedSuccessfully.ReturnOk(subscriptionRole: SA, jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNzMxNzYyNTczLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMXxTQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAxIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6Im5vbl9leGlzdGluZ191c2VyaWQiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.2336726" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenActivateUserInSubscription.WhenTokenLinkedToFAOrSA.WhenUserIsFound.WhenUserUpdatedSuccessfully.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 4837
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenActivateUserInSubscription.WhenTokenLinkedToFAOrSA.WhenUserIsFound.WhenUserUpdatedSuccessfully.ReturnOk(SubscriptionRoleIdentifier subscriptionRole, Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 4821
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When user update is finished successfully. Returns 200Ok" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenActivateUserInSubscription+WhenTokenLinkedToFAOrSA+WhenUserIsFound+WhenUserUpdatedSuccessfully.ReturnOk(subscriptionRole: SA, jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNzIwNzAzMzczLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIkZBIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vc3Vic2NyaXB0aW9ucyI6W10sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.2806083" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenActivateUserInSubscription.WhenTokenLinkedToFAOrSA.WhenUserIsFound.WhenUserUpdatedSuccessfully.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 4837
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenActivateUserInSubscription.WhenTokenLinkedToFAOrSA.WhenUserIsFound.WhenUserUpdatedSuccessfully.ReturnOk(SubscriptionRoleIdentifier subscriptionRole, Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 4821
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When user is not found while updating. Returns 404NotFound" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenActivateUserInSubscription+WhenTokenLinkedToFAOrSA+WhenUserIsFound+WhenUserNotFoundWhileUpdating.ReturnNotFound(subscriptionRole: SA, jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNzAyMzAwMTczLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMXxTQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAxIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6Im5vbl9leGlzdGluZ191c2VyaWQiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.2268461" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenActivateUserInSubscription.WhenTokenLinkedToFAOrSA.WhenUserIsFound.WhenUserNotFoundWhileUpdating.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 4893
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenActivateUserInSubscription.WhenTokenLinkedToFAOrSA.WhenUserIsFound.WhenUserNotFoundWhileUpdating.ReturnNotFound(SubscriptionRoleIdentifier subscriptionRole, Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 4877
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When user is not found while updating. Returns 404NotFound" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenActivateUserInSubscription+WhenTokenLinkedToFAOrSA+WhenUserIsFound+WhenUserNotFoundWhileUpdating.ReturnNotFound(subscriptionRole: SA, jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNzEzODc3NzczLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIkZBIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vc3Vic2NyaXB0aW9ucyI6W10sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.2325890" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenActivateUserInSubscription.WhenTokenLinkedToFAOrSA.WhenUserIsFound.WhenUserNotFoundWhileUpdating.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 4893
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenActivateUserInSubscription.WhenTokenLinkedToFAOrSA.WhenUserIsFound.WhenUserNotFoundWhileUpdating.ReturnNotFound(SubscriptionRoleIdentifier subscriptionRole, Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 4877
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When try to activate not deactivated subscription. Returns 400BadRequest" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenActivateUserInSubscription+WhenTokenLinkedToFAOrSA+WhenUserIsFound+WhenTryToActivateNotDeactivatedSubscription.ReturnInternalServerError(subscriptionRole: SA, jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjk3ODkzNzc0LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMXxTQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAxIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6Im5vbl9leGlzdGluZ191c2VyaWQiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.2092120" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenActivateUserInSubscription.WhenTokenLinkedToFAOrSA.WhenUserIsFound.WhenTryToActivateNotDeactivatedSubscription.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 4956
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenActivateUserInSubscription.WhenTokenLinkedToFAOrSA.WhenUserIsFound.WhenTryToActivateNotDeactivatedSubscription.ReturnInternalServerError(SubscriptionRoleIdentifier subscriptionRole, Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 4933
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When try to activate not deactivated subscription. Returns 400BadRequest" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenActivateUserInSubscription+WhenTokenLinkedToFAOrSA+WhenUserIsFound+WhenTryToActivateNotDeactivatedSubscription.ReturnInternalServerError(subscriptionRole: SA, jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNzE4MTExMzc0LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIkZBIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vc3Vic2NyaXB0aW9ucyI6W10sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.2828648" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenActivateUserInSubscription.WhenTokenLinkedToFAOrSA.WhenUserIsFound.WhenTryToActivateNotDeactivatedSubscription.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 4956
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenActivateUserInSubscription.WhenTokenLinkedToFAOrSA.WhenUserIsFound.WhenTryToActivateNotDeactivatedSubscription.ReturnInternalServerError(SubscriptionRoleIdentifier subscriptionRole, Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 4933
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When user update is failed. Returns 500InternalServerError" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenDeactivateUserInSubscription+WhenTokenLinkedToFAOrSA+WhenUserIsFound+WhenUserUpdatedFailed.ReturnInternalServerError(subscriptionRole: SA, jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjk4MDY2NTc0LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMXxTQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAxIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6Im5vbl9leGlzdGluZ191c2VyaWQiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.2293442" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenDeactivateUserInSubscription.WhenTokenLinkedToFAOrSA.WhenUserIsFound.WhenUserUpdatedFailed.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 5069
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenDeactivateUserInSubscription.WhenTokenLinkedToFAOrSA.WhenUserIsFound.WhenUserUpdatedFailed.ReturnInternalServerError(SubscriptionRoleIdentifier subscriptionRole, Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 5046
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When user update is failed. Returns 500InternalServerError" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenDeactivateUserInSubscription+WhenTokenLinkedToFAOrSA+WhenUserIsFound+WhenUserUpdatedFailed.ReturnInternalServerError(subscriptionRole: SA, jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjkyODgyNTc0LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIkZBIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vc3Vic2NyaXB0aW9ucyI6W10sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.2772355" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenDeactivateUserInSubscription.WhenTokenLinkedToFAOrSA.WhenUserIsFound.WhenUserUpdatedFailed.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 5069
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenDeactivateUserInSubscription.WhenTokenLinkedToFAOrSA.WhenUserIsFound.WhenUserUpdatedFailed.ReturnInternalServerError(SubscriptionRoleIdentifier subscriptionRole, Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 5046
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When user update is finished successfully. Returns 200Ok" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenDeactivateUserInSubscription+WhenTokenLinkedToFAOrSA+WhenUserIsFound+WhenUserUpdatedSuccessfully.ReturnOk(subscriptionRole: SA, jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNzEwNTk0NTc1LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMXxTQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAxIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6Im5vbl9leGlzdGluZ191c2VyaWQiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.1773600" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenDeactivateUserInSubscription.WhenTokenLinkedToFAOrSA.WhenUserIsFound.WhenUserUpdatedSuccessfully.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 5125
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenDeactivateUserInSubscription.WhenTokenLinkedToFAOrSA.WhenUserIsFound.WhenUserUpdatedSuccessfully.ReturnOk(SubscriptionRoleIdentifier subscriptionRole, Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 5109
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When user update is finished successfully. Returns 200Ok" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenDeactivateUserInSubscription+WhenTokenLinkedToFAOrSA+WhenUserIsFound+WhenUserUpdatedSuccessfully.ReturnOk(subscriptionRole: SA, jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjkyNjIzMzc1LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIkZBIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vc3Vic2NyaXB0aW9ucyI6W10sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.2274723" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenDeactivateUserInSubscription.WhenTokenLinkedToFAOrSA.WhenUserIsFound.WhenUserUpdatedSuccessfully.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 5125
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenDeactivateUserInSubscription.WhenTokenLinkedToFAOrSA.WhenUserIsFound.WhenUserUpdatedSuccessfully.ReturnOk(SubscriptionRoleIdentifier subscriptionRole, Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 5109
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When user is not found while updating. Returns 404NotFound" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenDeactivateUserInSubscription+WhenTokenLinkedToFAOrSA+WhenUserIsFound+WhenUserNotFoundWhileUpdating.ReturnNotFound(subscriptionRole: SA, jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNzA5OTg5Nzc1LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMXxTQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAxIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6Im5vbl9leGlzdGluZ191c2VyaWQiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.3261552" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenDeactivateUserInSubscription.WhenTokenLinkedToFAOrSA.WhenUserIsFound.WhenUserNotFoundWhileUpdating.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 5181
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenDeactivateUserInSubscription.WhenTokenLinkedToFAOrSA.WhenUserIsFound.WhenUserNotFoundWhileUpdating.ReturnNotFound(SubscriptionRoleIdentifier subscriptionRole, Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 5165
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When user is not found while updating. Returns 404NotFound" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenDeactivateUserInSubscription+WhenTokenLinkedToFAOrSA+WhenUserIsFound+WhenUserNotFoundWhileUpdating.ReturnNotFound(subscriptionRole: SA, jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjk4NjcxMzc1LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIkZBIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vc3Vic2NyaXB0aW9ucyI6W10sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.2737218" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenDeactivateUserInSubscription.WhenTokenLinkedToFAOrSA.WhenUserIsFound.WhenUserNotFoundWhileUpdating.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 5181
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenDeactivateUserInSubscription.WhenTokenLinkedToFAOrSA.WhenUserIsFound.WhenUserNotFoundWhileUpdating.ReturnNotFound(SubscriptionRoleIdentifier subscriptionRole, Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 5165
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When try to activate not deactivated subscription. Returns 400BadRequest" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenDeactivateUserInSubscription+WhenTokenLinkedToFAOrSA+WhenUserIsFound+WhenTryToActivateNotDeactivatedSubscription.ReturnInternalServerError(subscriptionRole: SA, jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNzE4NzE2MTc2LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMXxTQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAxIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6Im5vbl9leGlzdGluZ191c2VyaWQiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.2641591" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenDeactivateUserInSubscription.WhenTokenLinkedToFAOrSA.WhenUserIsFound.WhenTryToActivateNotDeactivatedSubscription.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 5244
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenDeactivateUserInSubscription.WhenTokenLinkedToFAOrSA.WhenUserIsFound.WhenTryToActivateNotDeactivatedSubscription.ReturnInternalServerError(SubscriptionRoleIdentifier subscriptionRole, Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 5221
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When try to activate not deactivated subscription. Returns 400BadRequest" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenDeactivateUserInSubscription+WhenTokenLinkedToFAOrSA+WhenUserIsFound+WhenTryToActivateNotDeactivatedSubscription.ReturnInternalServerError(subscriptionRole: SA, jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjk1NDc0NTc2LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIkZBIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vc3Vic2NyaXB0aW9ucyI6W10sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9.)" time="0.3001866" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenDeactivateUserInSubscription.WhenTokenLinkedToFAOrSA.WhenUserIsFound.WhenTryToActivateNotDeactivatedSubscription.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 5244
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenDeactivateUserInSubscription.WhenTokenLinkedToFAOrSA.WhenUserIsFound.WhenTryToActivateNotDeactivatedSubscription.ReturnInternalServerError(SubscriptionRoleIdentifier subscriptionRole, Jwt jwt) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 5221
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When the user has full access, the inviting subscriptions has not the same customerGuid. Return 400 BadRequest" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenInvitingUsers+WhenTokenIsLinkedToFullAccessOrSAOrEA+WhenTheUserAlreadyExists+WhenTheUserHasFullAccess+WhenTheInvitingSubscriptionsCustomerGuidNotEquals.AnHttpBadRequestStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNzE1NjA1ODA2LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIkZBIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vc3Vic2NyaXB0aW9ucyI6W10sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., model: InviteUsersModel { Environments = [EnvironmentRoleModel { ... }], SubscriptionIds = [00000000-0000-0000-0000-000000000001, 00000000-0000-0000-0000-000000000002], UserEmails = [&quot;168bf614-9c1a-4bfa-929f-fa66767a1f44@example.org&quot;, &quot;c2b37472-ff05-428b-ad12-76eec8c0cde9@example.net&quot;, &quot;4f946dfa-c220-490a-b7fd-b182fdc17b61@example.com&quot;] })" time="0.3888085" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenInvitingUsers.WhenTokenIsLinkedToFullAccessOrSAOrEA.WhenTheUserAlreadyExists.WhenTheUserHasFullAccess.WhenTheInvitingSubscriptionsCustomerGuidNotEquals.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 2106
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenInvitingUsers.WhenTokenIsLinkedToFullAccessOrSAOrEA.WhenTheUserAlreadyExists.WhenTheUserHasFullAccess.WhenTheInvitingSubscriptionsCustomerGuidNotEquals.AnHttpBadRequestStatusCodeIsReturned(Jwt jwt, InviteUsersModel model) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 2058
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When the user is SA or EA and invites to the associated subscription, the invited user exists and has not the same customerGuid. Return 200 OK" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenInvitingUsers+WhenTokenIsLinkedToFullAccessOrSAOrEA+WhenTheUserAlreadyExists+WhenTheUserIsSAOrEA+WhenTheInvitingAndInvitedUserCustomerGuidsNotEqual.AnHttpOkStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjg5NzcyMjA2LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMXxTQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAxIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., model: InviteUsersModel { Environments = [EnvironmentRoleModel { ... }], SubscriptionIds = [00000000-0000-0000-0000-000000000001], UserEmails = [&quot;96a6778d-2979-459d-9254-6f405a86ac66@example.org&quot;, &quot;22d58ba7-0c6b-4642-82f2-1799bf1002b0@example.net&quot;, &quot;276fc147-7d35-4cdc-b34a-92d6d6273046@example.com&quot;] })" time="1.9174209" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenInvitingUsers.WhenTokenIsLinkedToFullAccessOrSAOrEA.WhenTheUserAlreadyExists.WhenTheUserIsSAOrEA.WhenTheInvitingAndInvitedUserCustomerGuidsNotEqual.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 2176
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenInvitingUsers.WhenTokenIsLinkedToFullAccessOrSAOrEA.WhenTheUserAlreadyExists.WhenTheUserIsSAOrEA.WhenTheInvitingAndInvitedUserCustomerGuidsNotEqual.AnHttpOkStatusCodeIsReturned(Jwt jwt, InviteUsersModel model) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 2122
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When the user is SA or EA and invites to the associated subscription, the invited user exists and has not the same customerGuid. Return 200 OK" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenInvitingUsers+WhenTokenIsLinkedToFullAccessOrSAOrEA+WhenTheUserAlreadyExists+WhenTheUserIsSAOrEA+WhenTheInvitingAndInvitedUserCustomerGuidsNotEqual.AnHttpOkStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjkzOTE5NDA2LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMXxFQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAxIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., model: InviteUsersModel { Environments = [EnvironmentRoleModel { ... }], SubscriptionIds = [00000000-0000-0000-0000-000000000001], UserEmails = [&quot;972d0496-04f9-4b6c-818c-7816480dbd43@example.com&quot;, &quot;9513c111-b4e9-4a81-8397-538db65726aa@example.org&quot;, &quot;79ac5ac3-a314-4100-81b5-3918ba50b7da@example.net&quot;] })" time="4.0529142" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenInvitingUsers.WhenTokenIsLinkedToFullAccessOrSAOrEA.WhenTheUserAlreadyExists.WhenTheUserIsSAOrEA.WhenTheInvitingAndInvitedUserCustomerGuidsNotEqual.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 2176
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenInvitingUsers.WhenTokenIsLinkedToFullAccessOrSAOrEA.WhenTheUserAlreadyExists.WhenTheUserIsSAOrEA.WhenTheInvitingAndInvitedUserCustomerGuidsNotEqual.AnHttpOkStatusCodeIsReturned(Jwt jwt, InviteUsersModel model) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 2122
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When the user is SA or EA and invites to the associated subscription, the invited user exists and has the same customerGuid. Return 200 OK" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenInvitingUsers+WhenTokenIsLinkedToFullAccessOrSAOrEA+WhenTheUserAlreadyExists+WhenTheUserIsSAOrEA+WhenTheInvitingAndInvitedUserCustomerGuidsEqual.AnHttpOkStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNzMxMjQ0MjEyLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMXxTQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAxIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., model: InviteUsersModel { Environments = [EnvironmentRoleModel { ... }], SubscriptionIds = [00000000-0000-0000-0000-000000000001], UserEmails = [&quot;32ef2bc5-db4e-465b-805d-05231ed1194b@example.org&quot;, &quot;705b726d-8676-4518-8658-4742035c6e0c@example.com&quot;, &quot;50cb7a0d-a5c3-4a0b-b3f1-e5bcb38c9d48@example.net&quot;] })" time="17.2624934" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenInvitingUsers.WhenTokenIsLinkedToFullAccessOrSAOrEA.WhenTheUserAlreadyExists.WhenTheUserIsSAOrEA.WhenTheInvitingAndInvitedUserCustomerGuidsEqual.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 2243
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenInvitingUsers.WhenTokenIsLinkedToFullAccessOrSAOrEA.WhenTheUserAlreadyExists.WhenTheUserIsSAOrEA.WhenTheInvitingAndInvitedUserCustomerGuidsEqual.AnHttpOkStatusCodeIsReturned(Jwt jwt, InviteUsersModel model) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 2189
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When the user is SA or EA and invites to the associated subscription, the invited user exists and has the same customerGuid. Return 200 OK" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenInvitingUsers+WhenTokenIsLinkedToFullAccessOrSAOrEA+WhenTheUserAlreadyExists+WhenTheUserIsSAOrEA+WhenTheInvitingAndInvitedUserCustomerGuidsEqual.AnHttpOkStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjk2MzM4NjEyLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMXxFQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAxIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., model: InviteUsersModel { Environments = [EnvironmentRoleModel { ... }], SubscriptionIds = [00000000-0000-0000-0000-000000000001], UserEmails = [&quot;09c3a8c9-e833-4e56-9c45-2b182070168a@example.com&quot;, &quot;577b5c96-d381-4256-896e-c3df41bb7907@example.net&quot;, &quot;97e433c9-159a-4ce1-8226-e84ede87831b@example.org&quot;] })" time="15.7435065" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenInvitingUsers.WhenTokenIsLinkedToFullAccessOrSAOrEA.WhenTheUserAlreadyExists.WhenTheUserIsSAOrEA.WhenTheInvitingAndInvitedUserCustomerGuidsEqual.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 2243
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenInvitingUsers.WhenTokenIsLinkedToFullAccessOrSAOrEA.WhenTheUserAlreadyExists.WhenTheUserIsSAOrEA.WhenTheInvitingAndInvitedUserCustomerGuidsEqual.AnHttpOkStatusCodeIsReturned(Jwt jwt, InviteUsersModel model) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 2189
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When the user is SA or EA, invites to the associated subscription and has null customerGuid. Return 400 BadRequest" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenInvitingUsers+WhenTokenIsLinkedToFullAccessOrSAOrEA+WhenTheUserAlreadyExists+WhenTheUserIsSAOrEA+WhenInvitingUserCustomerGuidIsNull.AnHttpBadRequestStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNzAwMDUzODQ1LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMXxTQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAxIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., model: InviteUsersModel { Environments = [EnvironmentRoleModel { ... }], SubscriptionIds = [00000000-0000-0000-0000-000000000001], UserEmails = [&quot;7735ba87-be2e-474c-ac80-e6b524c4c4c7@example.com&quot;, &quot;27f054b3-a51d-4b66-a3d6-b04f914cb7fb@example.net&quot;, &quot;39a990c0-51e3-45ce-b6e9-b75a2117300a@example.org&quot;] })" time="26.4692601" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenInvitingUsers.WhenTokenIsLinkedToFullAccessOrSAOrEA.WhenTheUserAlreadyExists.WhenTheUserIsSAOrEA.WhenInvitingUserCustomerGuidIsNull.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 2291
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenInvitingUsers.WhenTokenIsLinkedToFullAccessOrSAOrEA.WhenTheUserAlreadyExists.WhenTheUserIsSAOrEA.WhenInvitingUserCustomerGuidIsNull.AnHttpBadRequestStatusCodeIsReturned(Jwt jwt, InviteUsersModel model) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 2256
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When the user is SA or EA, invites to the associated subscription and has null customerGuid. Return 400 BadRequest" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenInvitingUsers+WhenTokenIsLinkedToFullAccessOrSAOrEA+WhenTheUserAlreadyExists+WhenTheUserIsSAOrEA+WhenInvitingUserCustomerGuidIsNull.AnHttpBadRequestStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNzAxNzgxODQ1LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMXxFQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAxIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., model: InviteUsersModel { Environments = [EnvironmentRoleModel { ... }], SubscriptionIds = [00000000-0000-0000-0000-000000000001], UserEmails = [&quot;10ff00be-a30c-4b0e-8cf4-e0264cfdc1dd@example.org&quot;, &quot;45539d7b-ac0c-4cad-a9d4-767a650195c4@example.com&quot;, &quot;4b1abaa3-742e-4409-9b75-2ccc517ef88c@example.net&quot;] })" time="29.3994007" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenInvitingUsers.WhenTokenIsLinkedToFullAccessOrSAOrEA.WhenTheUserAlreadyExists.WhenTheUserIsSAOrEA.WhenInvitingUserCustomerGuidIsNull.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 2291
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenInvitingUsers.WhenTokenIsLinkedToFullAccessOrSAOrEA.WhenTheUserAlreadyExists.WhenTheUserIsSAOrEA.WhenInvitingUserCustomerGuidIsNull.AnHttpBadRequestStatusCodeIsReturned(Jwt jwt, InviteUsersModel model) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 2256
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When the user is SA or EA and invites to unrelated subscription. Return 403Forbid" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenInvitingUsers+WhenTokenIsLinkedToFullAccessOrSAOrEA+WhenTheUserAlreadyExists+WhenTheUserIsSAOrEA+WhenInvitedSubscriptionIsNotInUserSubscriptionIds.AnHttpNotFoundStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNzA0NzE5NTAxLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMHxTQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., model: InviteUsersModel { Environments = [EnvironmentRoleModel { ... }], SubscriptionIds = [00000000-0000-0000-0000-000000000001], UserEmails = [&quot;151edac6-9d59-4fe6-817f-3363d814acc3@example.com&quot;, &quot;4bd23cfa-d441-47b2-bc6b-4033ac8f7293@example.org&quot;, &quot;4a8181da-f899-4166-8247-1801b5bd7c15@example.net&quot;] })" time="24.7353107" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenInvitingUsers.WhenTokenIsLinkedToFullAccessOrSAOrEA.WhenTheUserAlreadyExists.WhenTheUserIsSAOrEA.WhenInvitedSubscriptionIsNotInUserSubscriptionIds.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 2320
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenInvitingUsers.WhenTokenIsLinkedToFullAccessOrSAOrEA.WhenTheUserAlreadyExists.WhenTheUserIsSAOrEA.WhenInvitedSubscriptionIsNotInUserSubscriptionIds.AnHttpNotFoundStatusCodeIsReturned(Jwt jwt, InviteUsersModel model) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 2304
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When the user is SA or EA and invites to unrelated subscription. Return 403Forbid" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenInvitingUsers+WhenTokenIsLinkedToFullAccessOrSAOrEA+WhenTheUserAlreadyExists+WhenTheUserIsSAOrEA+WhenInvitedSubscriptionIsNotInUserSubscriptionIds.AnHttpNotFoundStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNzE3MDc0NzAxLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIjRlYWFlYzgwLTkxZGUtNDlmNS04M2RjLWZmZmVhOTc0YmY4YnxFQSJdLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3N1YnNjcmlwdGlvbnMiOlsiNThjODJmNjEtNzg0NC00M2ZlLTgyYjAtZjYwZTRiY2YxNjQ5Il0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., model: InviteUsersModel { Environments = [EnvironmentRoleModel { ... }], SubscriptionIds = [00000000-0000-0000-0000-000000000001], UserEmails = [&quot;b9939acc-3ffa-46be-ba56-6904af29c3d9@example.com&quot;, &quot;f08bf0ac-af4d-40d8-9c5d-51d551e475d5@example.org&quot;, &quot;0f5c052c-3ce8-490d-a136-ebd0d41f22f5@example.net&quot;] })" time="14.4126810" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenInvitingUsers.WhenTokenIsLinkedToFullAccessOrSAOrEA.WhenTheUserAlreadyExists.WhenTheUserIsSAOrEA.WhenInvitedSubscriptionIsNotInUserSubscriptionIds.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 2320
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenInvitingUsers.WhenTokenIsLinkedToFullAccessOrSAOrEA.WhenTheUserAlreadyExists.WhenTheUserIsSAOrEA.WhenInvitedSubscriptionIsNotInUserSubscriptionIds.AnHttpNotFoundStatusCodeIsReturned(Jwt jwt, InviteUsersModel model) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 2304
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When token has SA/FA roles and roles are successfully added/updated. Returns 200OK." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenGrantingSubscriptionLevelRoles+WhenTokenIsLinkedToFullAccessOrSA+WhenUserIsFound+WhenSubscriptionIsFound+WhenSubscriptionLevelRolesAreSuccessfullyAddedOrUpdated.AnHttpOkStatusCodeIsReturned(jwtCustomization: FullAccessRoleJwtCustomization { }, model: UserSubscriptionRolesModel { SubscriptionRoles = [SA, TD] })" time="7.4817779" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenGrantingSubscriptionLevelRoles.WhenTokenIsLinkedToFullAccessOrSA.WhenUserIsFound.WhenSubscriptionIsFound.WhenSubscriptionLevelRolesAreSuccessfullyAddedOrUpdated.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 3998
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenGrantingSubscriptionLevelRoles.WhenTokenIsLinkedToFullAccessOrSA.WhenUserIsFound.WhenSubscriptionIsFound.WhenSubscriptionLevelRolesAreSuccessfullyAddedOrUpdated.AnHttpOkStatusCodeIsReturned(ICustomization jwtCustomization, UserSubscriptionRolesModel model) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 3982
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When token has SA/FA roles and roles are successfully added/updated. Returns 200OK." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenGrantingSubscriptionLevelRoles+WhenTokenIsLinkedToFullAccessOrSA+WhenUserIsFound+WhenSubscriptionIsFound+WhenSubscriptionLevelRolesAreSuccessfullyAddedOrUpdated.AnHttpOkStatusCodeIsReturned(jwtCustomization: SubscriptionAdministratorRoleJwtCustomization { }, model: UserSubscriptionRolesModel { SubscriptionRoles = [SA, TD] })" time="7.6568120" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenGrantingSubscriptionLevelRoles.WhenTokenIsLinkedToFullAccessOrSA.WhenUserIsFound.WhenSubscriptionIsFound.WhenSubscriptionLevelRolesAreSuccessfullyAddedOrUpdated.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 3998
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenGrantingSubscriptionLevelRoles.WhenTokenIsLinkedToFullAccessOrSA.WhenUserIsFound.WhenSubscriptionIsFound.WhenSubscriptionLevelRolesAreSuccessfullyAddedOrUpdated.AnHttpOkStatusCodeIsReturned(ICustomization jwtCustomization, UserSubscriptionRolesModel model) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 3982
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When token has SA/FA roles and try to delete the last SA. Returns 400BadRequest." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenGrantingSubscriptionLevelRoles+WhenTokenIsLinkedToFullAccessOrSA+WhenUserIsFound+WhenSubscriptionIsFound+WhenTryToDeleteTheLastSubscriptionAdministrator.AnBadRequestIsReturned(jwtCustomization: FullAccessRoleJwtCustomization { }, model: UserSubscriptionRolesModel { SubscriptionRoles = [TD] })" time="11.8365155" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenGrantingSubscriptionLevelRoles.WhenTokenIsLinkedToFullAccessOrSA.WhenUserIsFound.WhenSubscriptionIsFound.WhenTryToDeleteTheLastSubscriptionAdministrator.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 4048
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenGrantingSubscriptionLevelRoles.WhenTokenIsLinkedToFullAccessOrSA.WhenUserIsFound.WhenSubscriptionIsFound.WhenTryToDeleteTheLastSubscriptionAdministrator.AnBadRequestIsReturned(ICustomization jwtCustomization, UserSubscriptionRolesModel model) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 4032
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When token has SA/FA roles and try to delete the last SA. Returns 400BadRequest." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenGrantingSubscriptionLevelRoles+WhenTokenIsLinkedToFullAccessOrSA+WhenUserIsFound+WhenSubscriptionIsFound+WhenTryToDeleteTheLastSubscriptionAdministrator.AnBadRequestIsReturned(jwtCustomization: SubscriptionAdministratorRoleJwtCustomization { }, model: UserSubscriptionRolesModel { SubscriptionRoles = [TD] })" time="11.5557813" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenGrantingSubscriptionLevelRoles.WhenTokenIsLinkedToFullAccessOrSA.WhenUserIsFound.WhenSubscriptionIsFound.WhenTryToDeleteTheLastSubscriptionAdministrator.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 4048
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenGrantingSubscriptionLevelRoles.WhenTokenIsLinkedToFullAccessOrSA.WhenUserIsFound.WhenSubscriptionIsFound.WhenTryToDeleteTheLastSubscriptionAdministrator.AnBadRequestIsReturned(ICustomization jwtCustomization, UserSubscriptionRolesModel model) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 4032
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When token has SA/FA roles and try to delete not the last SA. Returns 200Ok." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenGrantingSubscriptionLevelRoles+WhenTokenIsLinkedToFullAccessOrSA+WhenUserIsFound+WhenSubscriptionIsFound+WhenTryToDeleteNotTheLastSubscriptionAdministrator.AnOkIsReturned(userId: &quot;auth0|testUserId1&quot;, jwtCustomization: FullAccessRoleJwtCustomization { }, model: UserSubscriptionRolesModel { SubscriptionRoles = [TD] })" time="13.4394060" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenGrantingSubscriptionLevelRoles.WhenTokenIsLinkedToFullAccessOrSA.WhenUserIsFound.WhenSubscriptionIsFound.WhenTryToDeleteNotTheLastSubscriptionAdministrator.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 4116
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenGrantingSubscriptionLevelRoles.WhenTokenIsLinkedToFullAccessOrSA.WhenUserIsFound.WhenSubscriptionIsFound.WhenTryToDeleteNotTheLastSubscriptionAdministrator.AnOkIsReturned(String userId, ICustomization jwtCustomization, UserSubscriptionRolesModel model) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 4100
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When token has SA/FA roles and try to delete not the last SA. Returns 200Ok." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenGrantingSubscriptionLevelRoles+WhenTokenIsLinkedToFullAccessOrSA+WhenUserIsFound+WhenSubscriptionIsFound+WhenTryToDeleteNotTheLastSubscriptionAdministrator.AnOkIsReturned(userId: &quot;auth0|testUserId1&quot;, jwtCustomization: SubscriptionAdministratorRoleJwtCustomization { }, model: UserSubscriptionRolesModel { SubscriptionRoles = [TD] })" time="17.3708287" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenGrantingSubscriptionLevelRoles.WhenTokenIsLinkedToFullAccessOrSA.WhenUserIsFound.WhenSubscriptionIsFound.WhenTryToDeleteNotTheLastSubscriptionAdministrator.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 4116
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenGrantingSubscriptionLevelRoles.WhenTokenIsLinkedToFullAccessOrSA.WhenUserIsFound.WhenSubscriptionIsFound.WhenTryToDeleteNotTheLastSubscriptionAdministrator.AnOkIsReturned(String userId, ICustomization jwtCustomization, UserSubscriptionRolesModel model) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 4100
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When token has SA/FA roles and try to delete not the last SA. Returns 200Ok." type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenGrantingSubscriptionLevelRoles+WhenTokenIsLinkedToFullAccessOrSA+WhenUserIsFound+WhenSubscriptionIsFound+WhenTryToDeleteNotTheLastSubscriptionAdministrator.AnOkIsReturned(userId: &quot;1&quot;, jwtCustomization: SubscriptionAdministratorRoleJwtCustomization { }, model: UserSubscriptionRolesModel { SubscriptionRoles = [TD] })" time="35.3596134" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenGrantingSubscriptionLevelRoles.WhenTokenIsLinkedToFullAccessOrSA.WhenUserIsFound.WhenSubscriptionIsFound.WhenTryToDeleteNotTheLastSubscriptionAdministrator.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 4116
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenGrantingSubscriptionLevelRoles.WhenTokenIsLinkedToFullAccessOrSA.WhenUserIsFound.WhenSubscriptionIsFound.WhenTryToDeleteNotTheLastSubscriptionAdministrator.AnOkIsReturned(String userId, ICustomization jwtCustomization, UserSubscriptionRolesModel model) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 4100
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When user is FA or SA and remove role for another user, and there are no more subscription administrators. Returns 400BadRequest" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenDeleteSubscriptionRole+WhenTokenLinkedToFAOrSA+WhenUserIsFound+WhenUserIsNotSubscriptionAdministratorOrUpdatedUserIsNotCurrent+WhenThereAreNoMoreSA.ReturnBadRequest(customizationType: FullAccessRoleJwtCustomization { })" time="34.9850304" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenDeleteSubscriptionRole.WhenTokenLinkedToFAOrSA.WhenUserIsFound.WhenUserIsNotSubscriptionAdministratorOrUpdatedUserIsNotCurrent.WhenThereAreNoMoreSA.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 4612
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenDeleteSubscriptionRole.WhenTokenLinkedToFAOrSA.WhenUserIsFound.WhenUserIsNotSubscriptionAdministratorOrUpdatedUserIsNotCurrent.WhenThereAreNoMoreSA.ReturnBadRequest(ICustomization customizationType) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 4596
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When user is FA or SA and remove role for another user, and there are no more subscription administrators. Returns 400BadRequest" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenDeleteSubscriptionRole+WhenTokenLinkedToFAOrSA+WhenUserIsFound+WhenUserIsNotSubscriptionAdministratorOrUpdatedUserIsNotCurrent+WhenThereAreNoMoreSA.ReturnBadRequest(customizationType: SubscriptionAdministratorRoleJwtCustomization { })" time="26.0404587" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenDeleteSubscriptionRole.WhenTokenLinkedToFAOrSA.WhenUserIsFound.WhenUserIsNotSubscriptionAdministratorOrUpdatedUserIsNotCurrent.WhenThereAreNoMoreSA.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 4612
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenDeleteSubscriptionRole.WhenTokenLinkedToFAOrSA.WhenUserIsFound.WhenUserIsNotSubscriptionAdministratorOrUpdatedUserIsNotCurrent.WhenThereAreNoMoreSA.ReturnBadRequest(ICustomization customizationType) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 4596
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When the user has Full access, the inviting subscriptions has the same customerGuid and invited user exists and has another customerGuid. Return 200 OK" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenInvitingUsers+WhenTokenIsLinkedToFullAccessOrSAOrEA+WhenTheUserAlreadyExists+WhenTheUserHasFullAccess+WhenTheInvitingSubscriptionsCustomerGuidEquals+WhenTheInvitedSubscriptionAndInvitedUserCustomerGuidsNotEqual.AnHttpOkStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNjkxNDE0MzYzLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIkZBIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vc3Vic2NyaXB0aW9ucyI6W10sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., model: InviteUsersModel { Environments = [EnvironmentRoleModel { ... }], SubscriptionIds = [00000000-0000-0000-0000-000000000001], UserEmails = [&quot;d089725e-8c0a-47f1-9bac-1b5b6f198f6b@example.net&quot;, &quot;d5437809-6d5b-41a2-8878-c646e54d74d4@example.com&quot;, &quot;88b6ad87-62cd-42e7-a9b7-c9cbe3dd5c11@example.org&quot;] })" time="3.6445504" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenInvitingUsers.WhenTokenIsLinkedToFullAccessOrSAOrEA.WhenTheUserAlreadyExists.WhenTheUserHasFullAccess.WhenTheInvitingSubscriptionsCustomerGuidEquals.WhenTheInvitedSubscriptionAndInvitedUserCustomerGuidsNotEqual.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 1979
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenInvitingUsers.WhenTokenIsLinkedToFullAccessOrSAOrEA.WhenTheUserAlreadyExists.WhenTheUserHasFullAccess.WhenTheInvitingSubscriptionsCustomerGuidEquals.WhenTheInvitedSubscriptionAndInvitedUserCustomerGuidsNotEqual.AnHttpOkStatusCodeIsReturned(Jwt jwt, InviteUsersModel model) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 1925
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
      <test name="When the user has full access, the inviting subscriptions has the same customerGuid and the invited user exists and has the same customerGuid. Return 200 OK" type="CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement" method="UserManagementIntegrationTests+WhenInvitingUsers+WhenTokenIsLinkedToFullAccessOrSAOrEA+WhenTheUserAlreadyExists+WhenTheUserHasFullAccess+WhenTheInvitingSubscriptionsCustomerGuidEquals+WhenTheInvitedSubscriptionAndInvitedUserCustomerGuidsEqual.AnHttpOkStatusCodeIsReturned(jwt: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2xvZ2luLmNoaWxpZ3JhZngtZGV2LmNvbS8iLCJhdWQiOiJodHRwczovL2NoaWxpZ3JhZnguY29tIiwiYXpwIjoiIiwiZXhwIjoxNzMxODQ5NTY2LCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL3JvbGVzIjpbIkZBIl0sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vc3Vic2NyaXB0aW9ucyI6W10sImh0dHBzOi8vY2hpbGktcHVibGlzaC5jb20vY3VzdG9tZXJfZ3VpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInN1YiI6IjEiLCJodHRwczovL2NoaWxpLXB1Ymxpc2guY29tL2Vudmlyb25tZW50SWQiOiIiLCJzY29wZSI6IiJ9., model: InviteUsersModel { Environments = [EnvironmentRoleModel { ... }], SubscriptionIds = [00000000-0000-0000-0000-000000000001], UserEmails = [&quot;2e62d025-0f59-425e-8171-d7b533bd3d31@example.com&quot;, &quot;c79f0d28-bce2-421e-816d-7221738071c1@example.net&quot;, &quot;9cfd8e30-7ec0-4889-a9df-cc0c811e51be@example.org&quot;] })" time="1.9385082" result="Fail">
        <failure>
          <message>System.AggregateException : One or more errors occurred. (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.) (Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.)
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.
---- System.InvalidOperationException : Cannot resolve scoped service 'CHILI.GraFx.Platform.DB.Context.ChiliGraFxDbContext' from root provider.</message>
          <stack-trace>
----- Inner Stack Trace #1 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenInvitingUsers.WhenTokenIsLinkedToFullAccessOrSAOrEA.WhenTheUserAlreadyExists.WhenTheUserHasFullAccess.WhenTheInvitingSubscriptionsCustomerGuidEquals.WhenTheInvitedSubscriptionAndInvitedUserCustomerGuidsEqual.OnBeforeRun(IServiceProvider serviceProvider) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 2045
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.GetClient() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 38
   at CHILI.GraFx.Platform.API.Integration.Tests.Modules.UserManagement.UserManagementIntegrationTests.WhenInvitingUsers.WhenTokenIsLinkedToFullAccessOrSAOrEA.WhenTheUserAlreadyExists.WhenTheUserHasFullAccess.WhenTheInvitingSubscriptionsCustomerGuidEquals.WhenTheInvitedSubscriptionAndInvitedUserCustomerGuidsEqual.AnHttpOkStatusCodeIsReturned(Jwt jwt, InviteUsersModel model) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Modules\UserManagement\UserManagement.Integration.Tests.cs:line 1991
--- End of stack trace from previous location ---
----- Inner Stack Trace #2 (System.InvalidOperationException) -----
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, IServiceScope scope, IServiceScope rootScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CHILI.GraFx.Platform.API.Integration.Tests.Internals.TestablePlatformApi.Dispose(Boolean disposing) in D:\Development\grafx\Source\Platform\Platform.API\Tests\CHILI.GraFx.Platform.API.Integration.Tests\Internals\TestablePlatformApi.cs:line 40
   at CHILI.GraFx.Testing.Applications.TestableApplication`1.Dispose() in D:\Development\grafx\Source\Shared\CHILI.GraFx.Testing\Applications\TestableApplication.cs:line 24
   at ReflectionAbstractionExtensions.DisposeTestClass(ITest test, Object testClass, IMessageBus messageBus, ExecutionTimer timer, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Extensions/ReflectionAbstractionExtensions.cs:line 87</stack-trace>
        </failure>
        <traits />
      </test>
    </collection>
  </assembly>
</assemblies>
